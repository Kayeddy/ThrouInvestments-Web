import{a_ as Et,a$ as vm,b0 as Fr,b1 as mm,b2 as Ci,b3 as bm,b4 as wm,b5 as cu,b6 as jl,aR as Em}from"./index-b371a77d.js";var Fa={},pd={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(i){var t,r,s,o,g,w,v,S,U,R,F,K,q,H,Q,J,ce,x,C,O,T,b,c;(function(_){var Z=typeof Et=="object"?Et:typeof self=="object"?self:typeof this=="object"?this:{};_(u(Z,u(i.exports)));function u(f,d){return f!==Z&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(E,y){return f[E]=d?d(E,y):y}}})(function(_){var Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var d in f)f.hasOwnProperty(d)&&(u[d]=f[d])};t=function(u,f){Z(u,f);function d(){this.constructor=u}u.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(u){for(var f,d=1,E=arguments.length;d<E;d++){f=arguments[d];for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(u[y]=f[y])}return u},s=function(u,f){var d={};for(var E in u)Object.prototype.hasOwnProperty.call(u,E)&&f.indexOf(E)<0&&(d[E]=u[E]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,E=Object.getOwnPropertySymbols(u);y<E.length;y++)f.indexOf(E[y])<0&&Object.prototype.propertyIsEnumerable.call(u,E[y])&&(d[E[y]]=u[E[y]]);return d},o=function(u,f,d,E){var y=arguments.length,p=y<3?f:E===null?E=Object.getOwnPropertyDescriptor(f,d):E,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(u,f,d,E);else for(var L=u.length-1;L>=0;L--)(D=u[L])&&(p=(y<3?D(p):y>3?D(f,d,p):D(f,d))||p);return y>3&&p&&Object.defineProperty(f,d,p),p},g=function(u,f){return function(d,E){f(d,E,u)}},w=function(u,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,f)},v=function(u,f,d,E){function y(p){return p instanceof d?p:new d(function(D){D(p)})}return new(d||(d=Promise))(function(p,D){function L(z){try{A(E.next(z))}catch(te){D(te)}}function W(z){try{A(E.throw(z))}catch(te){D(te)}}function A(z){z.done?p(z.value):y(z.value).then(L,W)}A((E=E.apply(u,f||[])).next())})},S=function(u,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},E,y,p,D;return D={next:L(0),throw:L(1),return:L(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function L(A){return function(z){return W([A,z])}}function W(A){if(E)throw new TypeError("Generator is already executing.");for(;d;)try{if(E=1,y&&(p=A[0]&2?y.return:A[0]?y.throw||((p=y.return)&&p.call(y),0):y.next)&&!(p=p.call(y,A[1])).done)return p;switch(y=0,p&&(A=[A[0]&2,p.value]),A[0]){case 0:case 1:p=A;break;case 4:return d.label++,{value:A[1],done:!1};case 5:d.label++,y=A[1],A=[0];continue;case 7:A=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(A[0]===6||A[0]===2)){d=0;continue}if(A[0]===3&&(!p||A[1]>p[0]&&A[1]<p[3])){d.label=A[1];break}if(A[0]===6&&d.label<p[1]){d.label=p[1],p=A;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(A);break}p[2]&&d.ops.pop(),d.trys.pop();continue}A=f.call(u,d)}catch(z){A=[6,z],y=0}finally{E=p=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},c=function(u,f,d,E){E===void 0&&(E=d),u[E]=f[d]},U=function(u,f){for(var d in u)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=u[d])},R=function(u){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&u[f],E=0;if(d)return d.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&E>=u.length&&(u=void 0),{value:u&&u[E++],done:!u}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},F=function(u,f){var d=typeof Symbol=="function"&&u[Symbol.iterator];if(!d)return u;var E=d.call(u),y,p=[],D;try{for(;(f===void 0||f-- >0)&&!(y=E.next()).done;)p.push(y.value)}catch(L){D={error:L}}finally{try{y&&!y.done&&(d=E.return)&&d.call(E)}finally{if(D)throw D.error}}return p},K=function(){for(var u=[],f=0;f<arguments.length;f++)u=u.concat(F(arguments[f]));return u},q=function(){for(var u=0,f=0,d=arguments.length;f<d;f++)u+=arguments[f].length;for(var E=Array(u),y=0,f=0;f<d;f++)for(var p=arguments[f],D=0,L=p.length;D<L;D++,y++)E[y]=p[D];return E},H=function(u){return this instanceof H?(this.v=u,this):new H(u)},Q=function(u,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var E=d.apply(u,f||[]),y,p=[];return y={},D("next"),D("throw"),D("return"),y[Symbol.asyncIterator]=function(){return this},y;function D(re){E[re]&&(y[re]=function(ne){return new Promise(function(ge,le){p.push([re,ne,ge,le])>1||L(re,ne)})})}function L(re,ne){try{W(E[re](ne))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(A,z):te(p[0][2],re)}function A(re){L("next",re)}function z(re){L("throw",re)}function te(re,ne){re(ne),p.shift(),p.length&&L(p[0][0],p[0][1])}},J=function(u){var f,d;return f={},E("next"),E("throw",function(y){throw y}),E("return"),f[Symbol.iterator]=function(){return this},f;function E(y,p){f[y]=u[y]?function(D){return(d=!d)?{value:H(u[y](D)),done:y==="return"}:p?p(D):D}:p}},ce=function(u){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=u[Symbol.asyncIterator],d;return f?f.call(u):(u=typeof R=="function"?R(u):u[Symbol.iterator](),d={},E("next"),E("throw"),E("return"),d[Symbol.asyncIterator]=function(){return this},d);function E(p){d[p]=u[p]&&function(D){return new Promise(function(L,W){D=u[p](D),y(L,W,D.done,D.value)})}}function y(p,D,L,W){Promise.resolve(W).then(function(A){p({value:A,done:L})},D)}},x=function(u,f){return Object.defineProperty?Object.defineProperty(u,"raw",{value:f}):u.raw=f,u},C=function(u){if(u&&u.__esModule)return u;var f={};if(u!=null)for(var d in u)Object.hasOwnProperty.call(u,d)&&(f[d]=u[d]);return f.default=u,f},O=function(u){return u&&u.__esModule?u:{default:u}},T=function(u,f){if(!f.has(u))throw new TypeError("attempted to get private field on non-instance");return f.get(u)},b=function(u,f,d){if(!f.has(u))throw new TypeError("attempted to set private field on non-instance");return f.set(u,d),d},_("__extends",t),_("__assign",r),_("__rest",s),_("__decorate",o),_("__param",g),_("__metadata",w),_("__awaiter",v),_("__generator",S),_("__exportStar",U),_("__createBinding",c),_("__values",R),_("__read",F),_("__spread",K),_("__spreadArrays",q),_("__await",H),_("__asyncGenerator",Q),_("__asyncDelegator",J),_("__asyncValues",ce),_("__makeTemplateObject",x),_("__importStar",C),_("__importDefault",O),_("__classPrivateFieldGet",T),_("__classPrivateFieldSet",b)})})(pd);var gd=pd.exports,_s={};Object.defineProperty(_s,"__esModule",{value:!0});function Sm(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return JSON.parse(i)}catch{return i}}_s.safeJsonParse=Sm;function Im(i){return typeof i=="string"?i:JSON.stringify(i,(t,r)=>typeof r>"u"?null:r)}_s.safeJsonStringify=Im;var ts={exports:{}},$l;function Om(){return $l||($l=1,function(){let i;function t(){}i=t,i.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},i.prototype.setItem=function(r,s){this[r]=String(s)},i.prototype.removeItem=function(r){delete this[r]},i.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},i.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Et<"u"&&Et.localStorage?ts.exports=Et.localStorage:typeof window<"u"&&window.localStorage?ts.exports=window.localStorage:ts.exports=new t}()),ts.exports}var wc={},rs={},Fl;function Pm(){if(Fl)return rs;Fl=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.IKeyValueStorage=void 0;class i{}return rs.IKeyValueStorage=i,rs}var ns={},Ll;function xm(){if(Ll)return ns;Ll=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.parseEntry=void 0;const i=_s;function t(r){var s;return[r[0],i.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return ns.parseEntry=t,ns}var Ml;function Tm(){return Ml||(Ml=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=gd;t.__exportStar(Pm(),i),t.__exportStar(xm(),i)}(wc)),wc}Object.defineProperty(Fa,"__esModule",{value:!0});Fa.KeyValueStorage=void 0;const Pi=gd,ql=_s,Am=Pi.__importDefault(Om()),Cm=Tm();class _d{constructor(){this.localStorage=Am.default}getKeys(){return Pi.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Pi.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Cm.parseEntry)})}getItem(t){return Pi.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return ql.safeJsonParse(r)})}setItem(t,r){return Pi.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,ql.safeJsonStringify(r))})}removeItem(t){return Pi.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Fa.KeyValueStorage=_d;var Nm=Fa.default=_d,ys={},yd={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(i){var t,r,s,o,g,w,v,S,U,R,F,K,q,H,Q,J,ce,x,C,O,T,b,c;(function(_){var Z=typeof Et=="object"?Et:typeof self=="object"?self:typeof this=="object"?this:{};_(u(Z,u(i.exports)));function u(f,d){return f!==Z&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(E,y){return f[E]=d?d(E,y):y}}})(function(_){var Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var d in f)f.hasOwnProperty(d)&&(u[d]=f[d])};t=function(u,f){Z(u,f);function d(){this.constructor=u}u.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(u){for(var f,d=1,E=arguments.length;d<E;d++){f=arguments[d];for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(u[y]=f[y])}return u},s=function(u,f){var d={};for(var E in u)Object.prototype.hasOwnProperty.call(u,E)&&f.indexOf(E)<0&&(d[E]=u[E]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,E=Object.getOwnPropertySymbols(u);y<E.length;y++)f.indexOf(E[y])<0&&Object.prototype.propertyIsEnumerable.call(u,E[y])&&(d[E[y]]=u[E[y]]);return d},o=function(u,f,d,E){var y=arguments.length,p=y<3?f:E===null?E=Object.getOwnPropertyDescriptor(f,d):E,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(u,f,d,E);else for(var L=u.length-1;L>=0;L--)(D=u[L])&&(p=(y<3?D(p):y>3?D(f,d,p):D(f,d))||p);return y>3&&p&&Object.defineProperty(f,d,p),p},g=function(u,f){return function(d,E){f(d,E,u)}},w=function(u,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,f)},v=function(u,f,d,E){function y(p){return p instanceof d?p:new d(function(D){D(p)})}return new(d||(d=Promise))(function(p,D){function L(z){try{A(E.next(z))}catch(te){D(te)}}function W(z){try{A(E.throw(z))}catch(te){D(te)}}function A(z){z.done?p(z.value):y(z.value).then(L,W)}A((E=E.apply(u,f||[])).next())})},S=function(u,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},E,y,p,D;return D={next:L(0),throw:L(1),return:L(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function L(A){return function(z){return W([A,z])}}function W(A){if(E)throw new TypeError("Generator is already executing.");for(;d;)try{if(E=1,y&&(p=A[0]&2?y.return:A[0]?y.throw||((p=y.return)&&p.call(y),0):y.next)&&!(p=p.call(y,A[1])).done)return p;switch(y=0,p&&(A=[A[0]&2,p.value]),A[0]){case 0:case 1:p=A;break;case 4:return d.label++,{value:A[1],done:!1};case 5:d.label++,y=A[1],A=[0];continue;case 7:A=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(A[0]===6||A[0]===2)){d=0;continue}if(A[0]===3&&(!p||A[1]>p[0]&&A[1]<p[3])){d.label=A[1];break}if(A[0]===6&&d.label<p[1]){d.label=p[1],p=A;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(A);break}p[2]&&d.ops.pop(),d.trys.pop();continue}A=f.call(u,d)}catch(z){A=[6,z],y=0}finally{E=p=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},c=function(u,f,d,E){E===void 0&&(E=d),u[E]=f[d]},U=function(u,f){for(var d in u)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=u[d])},R=function(u){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&u[f],E=0;if(d)return d.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&E>=u.length&&(u=void 0),{value:u&&u[E++],done:!u}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},F=function(u,f){var d=typeof Symbol=="function"&&u[Symbol.iterator];if(!d)return u;var E=d.call(u),y,p=[],D;try{for(;(f===void 0||f-- >0)&&!(y=E.next()).done;)p.push(y.value)}catch(L){D={error:L}}finally{try{y&&!y.done&&(d=E.return)&&d.call(E)}finally{if(D)throw D.error}}return p},K=function(){for(var u=[],f=0;f<arguments.length;f++)u=u.concat(F(arguments[f]));return u},q=function(){for(var u=0,f=0,d=arguments.length;f<d;f++)u+=arguments[f].length;for(var E=Array(u),y=0,f=0;f<d;f++)for(var p=arguments[f],D=0,L=p.length;D<L;D++,y++)E[y]=p[D];return E},H=function(u){return this instanceof H?(this.v=u,this):new H(u)},Q=function(u,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var E=d.apply(u,f||[]),y,p=[];return y={},D("next"),D("throw"),D("return"),y[Symbol.asyncIterator]=function(){return this},y;function D(re){E[re]&&(y[re]=function(ne){return new Promise(function(ge,le){p.push([re,ne,ge,le])>1||L(re,ne)})})}function L(re,ne){try{W(E[re](ne))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(A,z):te(p[0][2],re)}function A(re){L("next",re)}function z(re){L("throw",re)}function te(re,ne){re(ne),p.shift(),p.length&&L(p[0][0],p[0][1])}},J=function(u){var f,d;return f={},E("next"),E("throw",function(y){throw y}),E("return"),f[Symbol.iterator]=function(){return this},f;function E(y,p){f[y]=u[y]?function(D){return(d=!d)?{value:H(u[y](D)),done:y==="return"}:p?p(D):D}:p}},ce=function(u){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=u[Symbol.asyncIterator],d;return f?f.call(u):(u=typeof R=="function"?R(u):u[Symbol.iterator](),d={},E("next"),E("throw"),E("return"),d[Symbol.asyncIterator]=function(){return this},d);function E(p){d[p]=u[p]&&function(D){return new Promise(function(L,W){D=u[p](D),y(L,W,D.done,D.value)})}}function y(p,D,L,W){Promise.resolve(W).then(function(A){p({value:A,done:L})},D)}},x=function(u,f){return Object.defineProperty?Object.defineProperty(u,"raw",{value:f}):u.raw=f,u},C=function(u){if(u&&u.__esModule)return u;var f={};if(u!=null)for(var d in u)Object.hasOwnProperty.call(u,d)&&(f[d]=u[d]);return f.default=u,f},O=function(u){return u&&u.__esModule?u:{default:u}},T=function(u,f){if(!f.has(u))throw new TypeError("attempted to get private field on non-instance");return f.get(u)},b=function(u,f,d){if(!f.has(u))throw new TypeError("attempted to set private field on non-instance");return f.set(u,d),d},_("__extends",t),_("__assign",r),_("__rest",s),_("__decorate",o),_("__param",g),_("__metadata",w),_("__awaiter",v),_("__generator",S),_("__exportStar",U),_("__createBinding",c),_("__values",R),_("__read",F),_("__spread",K),_("__spreadArrays",q),_("__await",H),_("__asyncGenerator",Q),_("__asyncDelegator",J),_("__asyncValues",ce),_("__makeTemplateObject",x),_("__importStar",C),_("__importDefault",O),_("__classPrivateFieldGet",T),_("__classPrivateFieldSet",b)})})(yd);var La=yd.exports,is={},me={},vd={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(i){var t,r,s,o,g,w,v,S,U,R,F,K,q,H,Q,J,ce,x,C,O,T,b,c;(function(_){var Z=typeof Et=="object"?Et:typeof self=="object"?self:typeof this=="object"?this:{};_(u(Z,u(i.exports)));function u(f,d){return f!==Z&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(E,y){return f[E]=d?d(E,y):y}}})(function(_){var Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var d in f)f.hasOwnProperty(d)&&(u[d]=f[d])};t=function(u,f){Z(u,f);function d(){this.constructor=u}u.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(u){for(var f,d=1,E=arguments.length;d<E;d++){f=arguments[d];for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(u[y]=f[y])}return u},s=function(u,f){var d={};for(var E in u)Object.prototype.hasOwnProperty.call(u,E)&&f.indexOf(E)<0&&(d[E]=u[E]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,E=Object.getOwnPropertySymbols(u);y<E.length;y++)f.indexOf(E[y])<0&&Object.prototype.propertyIsEnumerable.call(u,E[y])&&(d[E[y]]=u[E[y]]);return d},o=function(u,f,d,E){var y=arguments.length,p=y<3?f:E===null?E=Object.getOwnPropertyDescriptor(f,d):E,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(u,f,d,E);else for(var L=u.length-1;L>=0;L--)(D=u[L])&&(p=(y<3?D(p):y>3?D(f,d,p):D(f,d))||p);return y>3&&p&&Object.defineProperty(f,d,p),p},g=function(u,f){return function(d,E){f(d,E,u)}},w=function(u,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,f)},v=function(u,f,d,E){function y(p){return p instanceof d?p:new d(function(D){D(p)})}return new(d||(d=Promise))(function(p,D){function L(z){try{A(E.next(z))}catch(te){D(te)}}function W(z){try{A(E.throw(z))}catch(te){D(te)}}function A(z){z.done?p(z.value):y(z.value).then(L,W)}A((E=E.apply(u,f||[])).next())})},S=function(u,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},E,y,p,D;return D={next:L(0),throw:L(1),return:L(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function L(A){return function(z){return W([A,z])}}function W(A){if(E)throw new TypeError("Generator is already executing.");for(;d;)try{if(E=1,y&&(p=A[0]&2?y.return:A[0]?y.throw||((p=y.return)&&p.call(y),0):y.next)&&!(p=p.call(y,A[1])).done)return p;switch(y=0,p&&(A=[A[0]&2,p.value]),A[0]){case 0:case 1:p=A;break;case 4:return d.label++,{value:A[1],done:!1};case 5:d.label++,y=A[1],A=[0];continue;case 7:A=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(A[0]===6||A[0]===2)){d=0;continue}if(A[0]===3&&(!p||A[1]>p[0]&&A[1]<p[3])){d.label=A[1];break}if(A[0]===6&&d.label<p[1]){d.label=p[1],p=A;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(A);break}p[2]&&d.ops.pop(),d.trys.pop();continue}A=f.call(u,d)}catch(z){A=[6,z],y=0}finally{E=p=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},c=function(u,f,d,E){E===void 0&&(E=d),u[E]=f[d]},U=function(u,f){for(var d in u)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=u[d])},R=function(u){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&u[f],E=0;if(d)return d.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&E>=u.length&&(u=void 0),{value:u&&u[E++],done:!u}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},F=function(u,f){var d=typeof Symbol=="function"&&u[Symbol.iterator];if(!d)return u;var E=d.call(u),y,p=[],D;try{for(;(f===void 0||f-- >0)&&!(y=E.next()).done;)p.push(y.value)}catch(L){D={error:L}}finally{try{y&&!y.done&&(d=E.return)&&d.call(E)}finally{if(D)throw D.error}}return p},K=function(){for(var u=[],f=0;f<arguments.length;f++)u=u.concat(F(arguments[f]));return u},q=function(){for(var u=0,f=0,d=arguments.length;f<d;f++)u+=arguments[f].length;for(var E=Array(u),y=0,f=0;f<d;f++)for(var p=arguments[f],D=0,L=p.length;D<L;D++,y++)E[y]=p[D];return E},H=function(u){return this instanceof H?(this.v=u,this):new H(u)},Q=function(u,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var E=d.apply(u,f||[]),y,p=[];return y={},D("next"),D("throw"),D("return"),y[Symbol.asyncIterator]=function(){return this},y;function D(re){E[re]&&(y[re]=function(ne){return new Promise(function(ge,le){p.push([re,ne,ge,le])>1||L(re,ne)})})}function L(re,ne){try{W(E[re](ne))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(A,z):te(p[0][2],re)}function A(re){L("next",re)}function z(re){L("throw",re)}function te(re,ne){re(ne),p.shift(),p.length&&L(p[0][0],p[0][1])}},J=function(u){var f,d;return f={},E("next"),E("throw",function(y){throw y}),E("return"),f[Symbol.iterator]=function(){return this},f;function E(y,p){f[y]=u[y]?function(D){return(d=!d)?{value:H(u[y](D)),done:y==="return"}:p?p(D):D}:p}},ce=function(u){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=u[Symbol.asyncIterator],d;return f?f.call(u):(u=typeof R=="function"?R(u):u[Symbol.iterator](),d={},E("next"),E("throw"),E("return"),d[Symbol.asyncIterator]=function(){return this},d);function E(p){d[p]=u[p]&&function(D){return new Promise(function(L,W){D=u[p](D),y(L,W,D.done,D.value)})}}function y(p,D,L,W){Promise.resolve(W).then(function(A){p({value:A,done:L})},D)}},x=function(u,f){return Object.defineProperty?Object.defineProperty(u,"raw",{value:f}):u.raw=f,u},C=function(u){if(u&&u.__esModule)return u;var f={};if(u!=null)for(var d in u)Object.hasOwnProperty.call(u,d)&&(f[d]=u[d]);return f.default=u,f},O=function(u){return u&&u.__esModule?u:{default:u}},T=function(u,f){if(!f.has(u))throw new TypeError("attempted to get private field on non-instance");return f.get(u)},b=function(u,f,d){if(!f.has(u))throw new TypeError("attempted to set private field on non-instance");return f.set(u,d),d},_("__extends",t),_("__assign",r),_("__rest",s),_("__decorate",o),_("__param",g),_("__metadata",w),_("__awaiter",v),_("__generator",S),_("__exportStar",U),_("__createBinding",c),_("__values",R),_("__read",F),_("__spread",K),_("__spreadArrays",q),_("__await",H),_("__asyncGenerator",Q),_("__asyncDelegator",J),_("__asyncValues",ce),_("__makeTemplateObject",x),_("__importStar",C),_("__importDefault",O),_("__classPrivateFieldGet",T),_("__classPrivateFieldSet",b)})})(vd);var Ma=vd.exports,Ec={},ss={},Hl;function Rm(){if(Hl)return ss;Hl=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.delay=void 0;function i(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return ss.delay=i,ss}var Wn={},Sc={},Yn={},zl;function Um(){return zl||(zl=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.ONE_THOUSAND=Yn.ONE_HUNDRED=void 0,Yn.ONE_HUNDRED=100,Yn.ONE_THOUSAND=1e3),Yn}var Ic={},Bl;function Dm(){return Bl||(Bl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(Ic)),Ic}var Kl;function md(){return Kl||(Kl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=Ma;t.__exportStar(Um(),i),t.__exportStar(Dm(),i)}(Sc)),Sc}var Vl;function jm(){if(Vl)return Wn;Vl=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.fromMiliseconds=Wn.toMiliseconds=void 0;const i=md();function t(s){return s*i.ONE_THOUSAND}Wn.toMiliseconds=t;function r(s){return Math.floor(s/i.ONE_THOUSAND)}return Wn.fromMiliseconds=r,Wn}var Gl;function $m(){return Gl||(Gl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=Ma;t.__exportStar(Rm(),i),t.__exportStar(jm(),i)}(Ec)),Ec}var Oi={},kl;function Fm(){if(kl)return Oi;kl=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const o=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:o})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return Oi.Watch=i,Oi.default=i,Oi}var Oc={},as={},Wl;function Lm(){if(Wl)return as;Wl=1,Object.defineProperty(as,"__esModule",{value:!0}),as.IWatch=void 0;class i{}return as.IWatch=i,as}var Yl;function Mm(){return Yl||(Yl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ma.__exportStar(Lm(),i)}(Oc)),Oc}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=Ma;t.__exportStar($m(),i),t.__exportStar(Fm(),i),t.__exportStar(Mm(),i),t.__exportStar(md(),i)})(me);var Pc={},os={};let ei=class{};const qm=Object.freeze(Object.defineProperty({__proto__:null,IEvents:ei},Symbol.toStringTag,{value:"Module"})),Hm=vm(qm);var Jl;function zm(){if(Jl)return os;Jl=1,Object.defineProperty(os,"__esModule",{value:!0}),os.IHeartBeat=void 0;const i=Hm;class t extends i.IEvents{constructor(s){super()}}return os.IHeartBeat=t,os}var Xl;function bd(){return Xl||(Xl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),La.__exportStar(zm(),i)}(Pc)),Pc}var xc={},Jn={},Zl;function Bm(){if(Zl)return Jn;Zl=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.HEARTBEAT_EVENTS=Jn.HEARTBEAT_INTERVAL=void 0;const i=me;return Jn.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,Jn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Jn}var Ql;function wd(){return Ql||(Ql=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),La.__exportStar(Bm(),i)}(xc)),xc}var ef;function Km(){if(ef)return is;ef=1,Object.defineProperty(is,"__esModule",{value:!0}),is.HeartBeat=void 0;const i=La,t=Fr,r=me,s=bd(),o=wd();class g extends s.IHeartBeat{constructor(v){super(v),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(v==null?void 0:v.interval)||o.HEARTBEAT_INTERVAL}static init(v){return i.__awaiter(this,void 0,void 0,function*(){const S=new g(v);return yield S.init(),S})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(v,S){this.events.on(v,S)}once(v,S){this.events.once(v,S)}off(v,S){this.events.off(v,S)}removeListener(v,S){this.events.removeListener(v,S)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return is.HeartBeat=g,is}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=La;t.__exportStar(Km(),i),t.__exportStar(bd(),i),t.__exportStar(wd(),i)})(ys);var Qe={},Ed={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(i){var t,r,s,o,g,w,v,S,U,R,F,K,q,H,Q,J,ce,x,C,O,T,b,c;(function(_){var Z=typeof Et=="object"?Et:typeof self=="object"?self:typeof this=="object"?this:{};_(u(Z,u(i.exports)));function u(f,d){return f!==Z&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(E,y){return f[E]=d?d(E,y):y}}})(function(_){var Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var d in f)f.hasOwnProperty(d)&&(u[d]=f[d])};t=function(u,f){Z(u,f);function d(){this.constructor=u}u.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(u){for(var f,d=1,E=arguments.length;d<E;d++){f=arguments[d];for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(u[y]=f[y])}return u},s=function(u,f){var d={};for(var E in u)Object.prototype.hasOwnProperty.call(u,E)&&f.indexOf(E)<0&&(d[E]=u[E]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,E=Object.getOwnPropertySymbols(u);y<E.length;y++)f.indexOf(E[y])<0&&Object.prototype.propertyIsEnumerable.call(u,E[y])&&(d[E[y]]=u[E[y]]);return d},o=function(u,f,d,E){var y=arguments.length,p=y<3?f:E===null?E=Object.getOwnPropertyDescriptor(f,d):E,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(u,f,d,E);else for(var L=u.length-1;L>=0;L--)(D=u[L])&&(p=(y<3?D(p):y>3?D(f,d,p):D(f,d))||p);return y>3&&p&&Object.defineProperty(f,d,p),p},g=function(u,f){return function(d,E){f(d,E,u)}},w=function(u,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,f)},v=function(u,f,d,E){function y(p){return p instanceof d?p:new d(function(D){D(p)})}return new(d||(d=Promise))(function(p,D){function L(z){try{A(E.next(z))}catch(te){D(te)}}function W(z){try{A(E.throw(z))}catch(te){D(te)}}function A(z){z.done?p(z.value):y(z.value).then(L,W)}A((E=E.apply(u,f||[])).next())})},S=function(u,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},E,y,p,D;return D={next:L(0),throw:L(1),return:L(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function L(A){return function(z){return W([A,z])}}function W(A){if(E)throw new TypeError("Generator is already executing.");for(;d;)try{if(E=1,y&&(p=A[0]&2?y.return:A[0]?y.throw||((p=y.return)&&p.call(y),0):y.next)&&!(p=p.call(y,A[1])).done)return p;switch(y=0,p&&(A=[A[0]&2,p.value]),A[0]){case 0:case 1:p=A;break;case 4:return d.label++,{value:A[1],done:!1};case 5:d.label++,y=A[1],A=[0];continue;case 7:A=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(A[0]===6||A[0]===2)){d=0;continue}if(A[0]===3&&(!p||A[1]>p[0]&&A[1]<p[3])){d.label=A[1];break}if(A[0]===6&&d.label<p[1]){d.label=p[1],p=A;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(A);break}p[2]&&d.ops.pop(),d.trys.pop();continue}A=f.call(u,d)}catch(z){A=[6,z],y=0}finally{E=p=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},c=function(u,f,d,E){E===void 0&&(E=d),u[E]=f[d]},U=function(u,f){for(var d in u)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=u[d])},R=function(u){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&u[f],E=0;if(d)return d.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&E>=u.length&&(u=void 0),{value:u&&u[E++],done:!u}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},F=function(u,f){var d=typeof Symbol=="function"&&u[Symbol.iterator];if(!d)return u;var E=d.call(u),y,p=[],D;try{for(;(f===void 0||f-- >0)&&!(y=E.next()).done;)p.push(y.value)}catch(L){D={error:L}}finally{try{y&&!y.done&&(d=E.return)&&d.call(E)}finally{if(D)throw D.error}}return p},K=function(){for(var u=[],f=0;f<arguments.length;f++)u=u.concat(F(arguments[f]));return u},q=function(){for(var u=0,f=0,d=arguments.length;f<d;f++)u+=arguments[f].length;for(var E=Array(u),y=0,f=0;f<d;f++)for(var p=arguments[f],D=0,L=p.length;D<L;D++,y++)E[y]=p[D];return E},H=function(u){return this instanceof H?(this.v=u,this):new H(u)},Q=function(u,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var E=d.apply(u,f||[]),y,p=[];return y={},D("next"),D("throw"),D("return"),y[Symbol.asyncIterator]=function(){return this},y;function D(re){E[re]&&(y[re]=function(ne){return new Promise(function(ge,le){p.push([re,ne,ge,le])>1||L(re,ne)})})}function L(re,ne){try{W(E[re](ne))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(A,z):te(p[0][2],re)}function A(re){L("next",re)}function z(re){L("throw",re)}function te(re,ne){re(ne),p.shift(),p.length&&L(p[0][0],p[0][1])}},J=function(u){var f,d;return f={},E("next"),E("throw",function(y){throw y}),E("return"),f[Symbol.iterator]=function(){return this},f;function E(y,p){f[y]=u[y]?function(D){return(d=!d)?{value:H(u[y](D)),done:y==="return"}:p?p(D):D}:p}},ce=function(u){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=u[Symbol.asyncIterator],d;return f?f.call(u):(u=typeof R=="function"?R(u):u[Symbol.iterator](),d={},E("next"),E("throw"),E("return"),d[Symbol.asyncIterator]=function(){return this},d);function E(p){d[p]=u[p]&&function(D){return new Promise(function(L,W){D=u[p](D),y(L,W,D.done,D.value)})}}function y(p,D,L,W){Promise.resolve(W).then(function(A){p({value:A,done:L})},D)}},x=function(u,f){return Object.defineProperty?Object.defineProperty(u,"raw",{value:f}):u.raw=f,u},C=function(u){if(u&&u.__esModule)return u;var f={};if(u!=null)for(var d in u)Object.hasOwnProperty.call(u,d)&&(f[d]=u[d]);return f.default=u,f},O=function(u){return u&&u.__esModule?u:{default:u}},T=function(u,f){if(!f.has(u))throw new TypeError("attempted to get private field on non-instance");return f.get(u)},b=function(u,f,d){if(!f.has(u))throw new TypeError("attempted to set private field on non-instance");return f.set(u,d),d},_("__extends",t),_("__assign",r),_("__rest",s),_("__decorate",o),_("__param",g),_("__metadata",w),_("__awaiter",v),_("__generator",S),_("__exportStar",U),_("__createBinding",c),_("__values",R),_("__read",F),_("__spread",K),_("__spreadArrays",q),_("__await",H),_("__asyncGenerator",Q),_("__asyncDelegator",J),_("__asyncValues",ce),_("__makeTemplateObject",x),_("__importStar",C),_("__importDefault",O),_("__classPrivateFieldGet",T),_("__classPrivateFieldSet",b)})})(Ed);var Vm=Ed.exports,Tc,tf;function Gm(){if(tf)return Tc;tf=1;function i(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Tc=t;function t(r,s,o){var g=o&&o.stringify||i,w=1;if(typeof r=="object"&&r!==null){var v=s.length+w;if(v===1)return r;var S=new Array(v);S[0]=g(r);for(var U=1;U<v;U++)S[U]=g(s[U]);return S.join(" ")}if(typeof r!="string")return r;var R=s.length;if(R===0)return r;for(var F="",K=1-w,q=-1,H=r&&r.length||0,Q=0;Q<H;){if(r.charCodeAt(Q)===37&&Q+1<H){switch(q=q>-1?q:0,r.charCodeAt(Q+1)){case 100:case 102:if(K>=R||s[K]==null)break;q<Q&&(F+=r.slice(q,Q)),F+=Number(s[K]),q=Q+2,Q++;break;case 105:if(K>=R||s[K]==null)break;q<Q&&(F+=r.slice(q,Q)),F+=Math.floor(Number(s[K])),q=Q+2,Q++;break;case 79:case 111:case 106:if(K>=R||s[K]===void 0)break;q<Q&&(F+=r.slice(q,Q));var J=typeof s[K];if(J==="string"){F+="'"+s[K]+"'",q=Q+2,Q++;break}if(J==="function"){F+=s[K].name||"<anonymous>",q=Q+2,Q++;break}F+=g(s[K]),q=Q+2,Q++;break;case 115:if(K>=R)break;q<Q&&(F+=r.slice(q,Q)),F+=String(s[K]),q=Q+2,Q++;break;case 37:q<Q&&(F+=r.slice(q,Q)),F+="%",q=Q+2,Q++,K--;break}++K}++Q}return q===-1?r:(q<H&&(F+=r.slice(q)),F)}return Tc}var Ac,rf;function km(){if(rf)return Ac;rf=1;const i=Gm();Ac=o;const t=T().console||{},r={mapHttpRequest:H,mapHttpResponse:H,wrapRequestSerializer:Q,wrapResponseSerializer:Q,wrapErrorSerializer:Q,req:H,res:H,err:K};function s(b,c){return Array.isArray(b)?b.filter(function(Z){return Z!=="!stdSerializers.err"}):b===!0?Object.keys(c):!1}function o(b){b=b||{},b.browser=b.browser||{};const c=b.browser.transmit;if(c&&typeof c.send!="function")throw Error("pino: transmit option must have a send function");const _=b.browser.write||t;b.browser.write&&(b.browser.asObject=!0);const Z=b.serializers||{},u=s(b.browser.serialize,Z);let f=b.browser.serialize;Array.isArray(b.browser.serialize)&&b.browser.serialize.indexOf("!stdSerializers.err")>-1&&(f=!1);const d=["error","fatal","warn","info","debug","trace"];typeof _=="function"&&(_.error=_.fatal=_.warn=_.info=_.debug=_.trace=_),b.enabled===!1&&(b.level="silent");const E=b.level||"info",y=Object.create(_);y.log||(y.log=J),Object.defineProperty(y,"levelVal",{get:D}),Object.defineProperty(y,"level",{get:L,set:W});const p={transmit:c,serialize:u,asObject:b.browser.asObject,levels:d,timestamp:q(b)};y.levels=o.levels,y.level=E,y.setMaxListeners=y.getMaxListeners=y.emit=y.addListener=y.on=y.prependListener=y.once=y.prependOnceListener=y.removeListener=y.removeAllListeners=y.listeners=y.listenerCount=y.eventNames=y.write=y.flush=J,y.serializers=Z,y._serialize=u,y._stdErrSerialize=f,y.child=A,c&&(y._logEvent=F());function D(){return this.level==="silent"?1/0:this.levels.values[this.level]}function L(){return this._level}function W(z){if(z!=="silent"&&!this.levels.values[z])throw Error("unknown level "+z);this._level=z,g(p,y,"error","log"),g(p,y,"fatal","error"),g(p,y,"warn","error"),g(p,y,"info","log"),g(p,y,"debug","log"),g(p,y,"trace","log")}function A(z,te){if(!z)throw new Error("missing bindings for child Pino");te=te||{},u&&z.serializers&&(te.serializers=z.serializers);const re=te.serializers;if(u&&re){var ne=Object.assign({},Z,re),ge=b.browser.serialize===!0?Object.keys(ne):u;delete z.serializers,S([z],ge,ne,this._stdErrSerialize)}function le(be){this._childLevel=(be._childLevel|0)+1,this.error=U(be,z,"error"),this.fatal=U(be,z,"fatal"),this.warn=U(be,z,"warn"),this.info=U(be,z,"info"),this.debug=U(be,z,"debug"),this.trace=U(be,z,"trace"),ne&&(this.serializers=ne,this._serialize=ge),c&&(this._logEvent=F([].concat(be._logEvent.bindings,z)))}return le.prototype=this,new le(this)}return y}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:ce,epochTime:x,unixTime:C,isoTime:O});function g(b,c,_,Z){const u=Object.getPrototypeOf(c);c[_]=c.levelVal>c.levels.values[_]?J:u[_]?u[_]:t[_]||t[Z]||J,w(b,c,_)}function w(b,c,_){!b.transmit&&c[_]===J||(c[_]=function(Z){return function(){const f=b.timestamp(),d=new Array(arguments.length),E=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var y=0;y<d.length;y++)d[y]=arguments[y];if(b.serialize&&!b.asObject&&S(d,this._serialize,this.serializers,this._stdErrSerialize),b.asObject?Z.call(E,v(this,_,d,f)):Z.apply(E,d),b.transmit){const p=b.transmit.level||c.level,D=o.levels.values[p],L=o.levels.values[_];if(L<D)return;R(this,{ts:f,methodLevel:_,methodValue:L,transmitLevel:p,transmitValue:o.levels.values[b.transmit.level||c.level],send:b.transmit.send,val:c.levelVal},d)}}}(c[_]))}function v(b,c,_,Z){b._serialize&&S(_,b._serialize,b.serializers,b._stdErrSerialize);const u=_.slice();let f=u[0];const d={};Z&&(d.time=Z),d.level=o.levels.values[c];let E=(b._childLevel|0)+1;if(E<1&&(E=1),f!==null&&typeof f=="object"){for(;E--&&typeof u[0]=="object";)Object.assign(d,u.shift());f=u.length?i(u.shift(),u):void 0}else typeof f=="string"&&(f=i(u.shift(),u));return f!==void 0&&(d.msg=f),d}function S(b,c,_,Z){for(const u in b)if(Z&&b[u]instanceof Error)b[u]=o.stdSerializers.err(b[u]);else if(typeof b[u]=="object"&&!Array.isArray(b[u]))for(const f in b[u])c&&c.indexOf(f)>-1&&f in _&&(b[u][f]=_[f](b[u][f]))}function U(b,c,_){return function(){const Z=new Array(1+arguments.length);Z[0]=c;for(var u=1;u<Z.length;u++)Z[u]=arguments[u-1];return b[_].apply(this,Z)}}function R(b,c,_){const Z=c.send,u=c.ts,f=c.methodLevel,d=c.methodValue,E=c.val,y=b._logEvent.bindings;S(_,b._serialize||Object.keys(b.serializers),b.serializers,b._stdErrSerialize===void 0?!0:b._stdErrSerialize),b._logEvent.ts=u,b._logEvent.messages=_.filter(function(p){return y.indexOf(p)===-1}),b._logEvent.level.label=f,b._logEvent.level.value=d,Z(f,b._logEvent,E),b._logEvent=F(y)}function F(b){return{ts:0,messages:[],bindings:b||[],level:{label:"",value:0}}}function K(b){const c={type:b.constructor.name,msg:b.message,stack:b.stack};for(const _ in b)c[_]===void 0&&(c[_]=b[_]);return c}function q(b){return typeof b.timestamp=="function"?b.timestamp:b.timestamp===!1?ce:x}function H(){return{}}function Q(b){return b}function J(){}function ce(){return!1}function x(){return Date.now()}function C(){return Math.round(Date.now()/1e3)}function O(){return new Date(Date.now()).toISOString()}function T(){function b(c){return typeof c<"u"&&c}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return b(self)||b(window)||b(this)||{}}}return Ac}var Xn={},nf;function Sd(){return nf||(nf=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.PINO_CUSTOM_CONTEXT_KEY=Xn.PINO_LOGGER_DEFAULTS=void 0,Xn.PINO_LOGGER_DEFAULTS={level:"info"},Xn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Xn}var or={},sf;function Wm(){if(sf)return or;sf=1,Object.defineProperty(or,"__esModule",{value:!0}),or.generateChildLogger=or.formatChildLoggerContext=or.getLoggerContext=or.setBrowserLoggerContext=or.getBrowserLoggerContext=or.getDefaultLoggerOptions=void 0;const i=Sd();function t(v){return Object.assign(Object.assign({},v),{level:(v==null?void 0:v.level)||i.PINO_LOGGER_DEFAULTS.level})}or.getDefaultLoggerOptions=t;function r(v,S=i.PINO_CUSTOM_CONTEXT_KEY){return v[S]||""}or.getBrowserLoggerContext=r;function s(v,S,U=i.PINO_CUSTOM_CONTEXT_KEY){return v[U]=S,v}or.setBrowserLoggerContext=s;function o(v,S=i.PINO_CUSTOM_CONTEXT_KEY){let U="";return typeof v.bindings>"u"?U=r(v,S):U=v.bindings().context||"",U}or.getLoggerContext=o;function g(v,S,U=i.PINO_CUSTOM_CONTEXT_KEY){const R=o(v,U);return R.trim()?`${R}/${S}`:S}or.formatChildLoggerContext=g;function w(v,S,U=i.PINO_CUSTOM_CONTEXT_KEY){const R=g(v,S,U),F=v.child({context:R});return s(F,R,U)}return or.generateChildLogger=w,or}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const t=Vm,r=t.__importDefault(km());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(Sd(),i),t.__exportStar(Wm(),i)})(Qe);const Ym=i=>JSON.stringify(i,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Jm=i=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=i.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function uu(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return Jm(i)}catch{return i}}function ps(i){return typeof i=="string"?i:Ym(i)||""}var hu={},Ni={},qa={},Ha={};Object.defineProperty(Ha,"__esModule",{value:!0});Ha.BrowserRandomSource=void 0;const af=65536;class Xm{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let s=0;s<r.length;s+=af)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,af)));return r}}Ha.BrowserRandomSource=Xm;function Zm(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var za={},Sr={};Object.defineProperty(Sr,"__esModule",{value:!0});function Qm(i){for(var t=0;t<i.length;t++)i[t]=0;return i}Sr.wipe=Qm;Object.defineProperty(za,"__esModule",{value:!0});za.NodeRandomSource=void 0;const eb=Sr;class tb{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Zm<"u"){const t=mm;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(t);for(let o=0;o<s.length;o++)s[o]=r[o];return(0,eb.wipe)(r),s}}za.NodeRandomSource=tb;Object.defineProperty(qa,"__esModule",{value:!0});qa.SystemRandomSource=void 0;const rb=Ha,nb=za;class ib{constructor(){if(this.isAvailable=!1,this.name="",this._source=new rb.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new nb.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}qa.SystemRandomSource=ib;var $e={},Id={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function t(v,S){var U=v>>>16&65535,R=v&65535,F=S>>>16&65535,K=S&65535;return R*K+(U*K+R*F<<16>>>0)|0}i.mul=Math.imul||t;function r(v,S){return v+S|0}i.add=r;function s(v,S){return v-S|0}i.sub=s;function o(v,S){return v<<S|v>>>32-S}i.rotl=o;function g(v,S){return v<<32-S|v>>>S}i.rotr=g;function w(v){return typeof v=="number"&&isFinite(v)&&Math.floor(v)===v}i.isInteger=Number.isInteger||w,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(v){return i.isInteger(v)&&v>=-i.MAX_SAFE_INTEGER&&v<=i.MAX_SAFE_INTEGER}})(Id);Object.defineProperty($e,"__esModule",{value:!0});var Od=Id;function sb(i,t){return t===void 0&&(t=0),(i[t+0]<<8|i[t+1])<<16>>16}$e.readInt16BE=sb;function ab(i,t){return t===void 0&&(t=0),(i[t+0]<<8|i[t+1])>>>0}$e.readUint16BE=ab;function ob(i,t){return t===void 0&&(t=0),(i[t+1]<<8|i[t])<<16>>16}$e.readInt16LE=ob;function cb(i,t){return t===void 0&&(t=0),(i[t+1]<<8|i[t])>>>0}$e.readUint16LE=cb;function Pd(i,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=i>>>8,t[r+1]=i>>>0,t}$e.writeUint16BE=Pd;$e.writeInt16BE=Pd;function xd(i,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=i>>>0,t[r+1]=i>>>8,t}$e.writeUint16LE=xd;$e.writeInt16LE=xd;function Kc(i,t){return t===void 0&&(t=0),i[t]<<24|i[t+1]<<16|i[t+2]<<8|i[t+3]}$e.readInt32BE=Kc;function Vc(i,t){return t===void 0&&(t=0),(i[t]<<24|i[t+1]<<16|i[t+2]<<8|i[t+3])>>>0}$e.readUint32BE=Vc;function Gc(i,t){return t===void 0&&(t=0),i[t+3]<<24|i[t+2]<<16|i[t+1]<<8|i[t]}$e.readInt32LE=Gc;function kc(i,t){return t===void 0&&(t=0),(i[t+3]<<24|i[t+2]<<16|i[t+1]<<8|i[t])>>>0}$e.readUint32LE=kc;function Na(i,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=i>>>24,t[r+1]=i>>>16,t[r+2]=i>>>8,t[r+3]=i>>>0,t}$e.writeUint32BE=Na;$e.writeInt32BE=Na;function Ra(i,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=i>>>0,t[r+1]=i>>>8,t[r+2]=i>>>16,t[r+3]=i>>>24,t}$e.writeUint32LE=Ra;$e.writeInt32LE=Ra;function ub(i,t){t===void 0&&(t=0);var r=Kc(i,t),s=Kc(i,t+4);return r*4294967296+s-(s>>31)*4294967296}$e.readInt64BE=ub;function hb(i,t){t===void 0&&(t=0);var r=Vc(i,t),s=Vc(i,t+4);return r*4294967296+s}$e.readUint64BE=hb;function lb(i,t){t===void 0&&(t=0);var r=Gc(i,t),s=Gc(i,t+4);return s*4294967296+r-(r>>31)*4294967296}$e.readInt64LE=lb;function fb(i,t){t===void 0&&(t=0);var r=kc(i,t),s=kc(i,t+4);return s*4294967296+r}$e.readUint64LE=fb;function Td(i,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Na(i/4294967296>>>0,t,r),Na(i>>>0,t,r+4),t}$e.writeUint64BE=Td;$e.writeInt64BE=Td;function Ad(i,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Ra(i>>>0,t,r),Ra(i/4294967296>>>0,t,r+4),t}$e.writeUint64LE=Ad;$e.writeInt64LE=Ad;function db(i,t,r){if(r===void 0&&(r=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,g=i/8+r-1;g>=r;g--)s+=t[g]*o,o*=256;return s}$e.readUintBE=db;function pb(i,t,r){if(r===void 0&&(r=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,g=r;g<r+i/8;g++)s+=t[g]*o,o*=256;return s}$e.readUintLE=pb;function gb(i,t,r,s){if(r===void 0&&(r=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Od.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var o=1,g=i/8+s-1;g>=s;g--)r[g]=t/o&255,o*=256;return r}$e.writeUintBE=gb;function _b(i,t,r,s){if(r===void 0&&(r=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Od.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var o=1,g=s;g<s+i/8;g++)r[g]=t/o&255,o*=256;return r}$e.writeUintLE=_b;function yb(i,t){t===void 0&&(t=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat32(t)}$e.readFloat32BE=yb;function vb(i,t){t===void 0&&(t=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat32(t,!0)}$e.readFloat32LE=vb;function mb(i,t){t===void 0&&(t=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat64(t)}$e.readFloat64BE=mb;function bb(i,t){t===void 0&&(t=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat64(t,!0)}$e.readFloat64LE=bb;function wb(i,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,i),t}$e.writeFloat32BE=wb;function Eb(i,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,i,!0),t}$e.writeFloat32LE=Eb;function Sb(i,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,i),t}$e.writeFloat64BE=Sb;function Ib(i,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,i,!0),t}$e.writeFloat64LE=Ib;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const t=qa,r=$e,s=Sr;i.defaultRandomSource=new t.SystemRandomSource;function o(U,R=i.defaultRandomSource){return R.randomBytes(U)}i.randomBytes=o;function g(U=i.defaultRandomSource){const R=o(4,U),F=(0,r.readUint32LE)(R);return(0,s.wipe)(R),F}i.randomUint32=g;const w="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function v(U,R=w,F=i.defaultRandomSource){if(R.length<2)throw new Error("randomString charset is too short");if(R.length>256)throw new Error("randomString charset is too long");let K="";const q=R.length,H=256-256%q;for(;U>0;){const Q=o(Math.ceil(U*256/H),F);for(let J=0;J<Q.length&&U>0;J++){const ce=Q[J];ce<H&&(K+=R.charAt(ce%q),U--)}(0,s.wipe)(Q)}return K}i.randomString=v;function S(U,R=w,F=i.defaultRandomSource){const K=Math.ceil(U/(Math.log(R.length)/Math.LN2));return v(K,R,F)}i.randomStringForEntropy=S})(Ni);var Cd={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=$e,r=Sr;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function v(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return v.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},v.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},v.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},v.prototype.update=function(S,U){if(U===void 0&&(U=S.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var R=0;if(this._bytesHashed+=U,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&U>0;)this._buffer[this._bufferLength++]=S[R++],U--;this._bufferLength===this.blockSize&&(g(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(U>=this.blockSize&&(R=g(this._tempHi,this._tempLo,this._stateHi,this._stateLo,S,R,U),U%=this.blockSize);U>0;)this._buffer[this._bufferLength++]=S[R++],U--;return this},v.prototype.finish=function(S){if(!this._finished){var U=this._bytesHashed,R=this._bufferLength,F=U/536870912|0,K=U<<3,q=U%128<112?128:256;this._buffer[R]=128;for(var H=R+1;H<q-8;H++)this._buffer[H]=0;t.writeUint32BE(F,this._buffer,q-8),t.writeUint32BE(K,this._buffer,q-4),g(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,q),this._finished=!0}for(var H=0;H<this.digestLength/8;H++)t.writeUint32BE(this._stateHi[H],S,H*8),t.writeUint32BE(this._stateLo[H],S,H*8+4);return this},v.prototype.digest=function(){var S=new Uint8Array(this.digestLength);return this.finish(S),S},v.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},v.prototype.restoreState=function(S){return this._stateHi.set(S.stateHi),this._stateLo.set(S.stateLo),this._bufferLength=S.bufferLength,S.buffer&&this._buffer.set(S.buffer),this._bytesHashed=S.bytesHashed,this._finished=!1,this},v.prototype.cleanSavedState=function(S){r.wipe(S.stateHi),r.wipe(S.stateLo),S.buffer&&r.wipe(S.buffer),S.bufferLength=0,S.bytesHashed=0},v}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function g(v,S,U,R,F,K,q){for(var H=U[0],Q=U[1],J=U[2],ce=U[3],x=U[4],C=U[5],O=U[6],T=U[7],b=R[0],c=R[1],_=R[2],Z=R[3],u=R[4],f=R[5],d=R[6],E=R[7],y,p,D,L,W,A,z,te;q>=128;){for(var re=0;re<16;re++){var ne=8*re+K;v[re]=t.readUint32BE(F,ne),S[re]=t.readUint32BE(F,ne+4)}for(var re=0;re<80;re++){var ge=H,le=Q,be=J,X=ce,Y=x,B=C,l=O,$=T,he=b,pe=c,Oe=_,ze=Z,Ve=u,Fe=f,gt=d,_t=E;if(y=T,p=E,W=p&65535,A=p>>>16,z=y&65535,te=y>>>16,y=(x>>>14|u<<32-14)^(x>>>18|u<<32-18)^(u>>>41-32|x<<32-(41-32)),p=(u>>>14|x<<32-14)^(u>>>18|x<<32-18)^(x>>>41-32|u<<32-(41-32)),W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,y=x&C^~x&O,p=u&f^~u&d,W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,y=o[re*2],p=o[re*2+1],W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,y=v[re%16],p=S[re%16],W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,A+=W>>>16,z+=A>>>16,te+=z>>>16,D=z&65535|te<<16,L=W&65535|A<<16,y=D,p=L,W=p&65535,A=p>>>16,z=y&65535,te=y>>>16,y=(H>>>28|b<<32-28)^(b>>>34-32|H<<32-(34-32))^(b>>>39-32|H<<32-(39-32)),p=(b>>>28|H<<32-28)^(H>>>34-32|b<<32-(34-32))^(H>>>39-32|b<<32-(39-32)),W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,y=H&Q^H&J^Q&J,p=b&c^b&_^c&_,W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,A+=W>>>16,z+=A>>>16,te+=z>>>16,$=z&65535|te<<16,_t=W&65535|A<<16,y=X,p=ze,W=p&65535,A=p>>>16,z=y&65535,te=y>>>16,y=D,p=L,W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,A+=W>>>16,z+=A>>>16,te+=z>>>16,X=z&65535|te<<16,ze=W&65535|A<<16,Q=ge,J=le,ce=be,x=X,C=Y,O=B,T=l,H=$,c=he,_=pe,Z=Oe,u=ze,f=Ve,d=Fe,E=gt,b=_t,re%16===15)for(var ne=0;ne<16;ne++)y=v[ne],p=S[ne],W=p&65535,A=p>>>16,z=y&65535,te=y>>>16,y=v[(ne+9)%16],p=S[(ne+9)%16],W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,D=v[(ne+1)%16],L=S[(ne+1)%16],y=(D>>>1|L<<32-1)^(D>>>8|L<<32-8)^D>>>7,p=(L>>>1|D<<32-1)^(L>>>8|D<<32-8)^(L>>>7|D<<32-7),W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,D=v[(ne+14)%16],L=S[(ne+14)%16],y=(D>>>19|L<<32-19)^(L>>>61-32|D<<32-(61-32))^D>>>6,p=(L>>>19|D<<32-19)^(D>>>61-32|L<<32-(61-32))^(L>>>6|D<<32-6),W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,A+=W>>>16,z+=A>>>16,te+=z>>>16,v[ne]=z&65535|te<<16,S[ne]=W&65535|A<<16}y=H,p=b,W=p&65535,A=p>>>16,z=y&65535,te=y>>>16,y=U[0],p=R[0],W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,A+=W>>>16,z+=A>>>16,te+=z>>>16,U[0]=H=z&65535|te<<16,R[0]=b=W&65535|A<<16,y=Q,p=c,W=p&65535,A=p>>>16,z=y&65535,te=y>>>16,y=U[1],p=R[1],W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,A+=W>>>16,z+=A>>>16,te+=z>>>16,U[1]=Q=z&65535|te<<16,R[1]=c=W&65535|A<<16,y=J,p=_,W=p&65535,A=p>>>16,z=y&65535,te=y>>>16,y=U[2],p=R[2],W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,A+=W>>>16,z+=A>>>16,te+=z>>>16,U[2]=J=z&65535|te<<16,R[2]=_=W&65535|A<<16,y=ce,p=Z,W=p&65535,A=p>>>16,z=y&65535,te=y>>>16,y=U[3],p=R[3],W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,A+=W>>>16,z+=A>>>16,te+=z>>>16,U[3]=ce=z&65535|te<<16,R[3]=Z=W&65535|A<<16,y=x,p=u,W=p&65535,A=p>>>16,z=y&65535,te=y>>>16,y=U[4],p=R[4],W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,A+=W>>>16,z+=A>>>16,te+=z>>>16,U[4]=x=z&65535|te<<16,R[4]=u=W&65535|A<<16,y=C,p=f,W=p&65535,A=p>>>16,z=y&65535,te=y>>>16,y=U[5],p=R[5],W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,A+=W>>>16,z+=A>>>16,te+=z>>>16,U[5]=C=z&65535|te<<16,R[5]=f=W&65535|A<<16,y=O,p=d,W=p&65535,A=p>>>16,z=y&65535,te=y>>>16,y=U[6],p=R[6],W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,A+=W>>>16,z+=A>>>16,te+=z>>>16,U[6]=O=z&65535|te<<16,R[6]=d=W&65535|A<<16,y=T,p=E,W=p&65535,A=p>>>16,z=y&65535,te=y>>>16,y=U[7],p=R[7],W+=p&65535,A+=p>>>16,z+=y&65535,te+=y>>>16,A+=W>>>16,z+=A>>>16,te+=z>>>16,U[7]=T=z&65535|te<<16,R[7]=E=W&65535|A<<16,K+=128,q-=128}return K}function w(v){var S=new s;S.update(v);var U=S.digest();return S.clean(),U}i.hash=w})(Cd);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const t=Ni,r=Cd,s=Sr;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(X){const Y=new Float64Array(16);if(X)for(let B=0;B<X.length;B++)Y[B]=X[B];return Y}const g=new Uint8Array(32);g[0]=9;const w=o(),v=o([1]),S=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),U=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),R=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),F=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),K=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function q(X,Y){for(let B=0;B<16;B++)X[B]=Y[B]|0}function H(X){let Y=1;for(let B=0;B<16;B++){let l=X[B]+Y+65535;Y=Math.floor(l/65536),X[B]=l-Y*65536}X[0]+=Y-1+37*(Y-1)}function Q(X,Y,B){const l=~(B-1);for(let $=0;$<16;$++){const he=l&(X[$]^Y[$]);X[$]^=he,Y[$]^=he}}function J(X,Y){const B=o(),l=o();for(let $=0;$<16;$++)l[$]=Y[$];H(l),H(l),H(l);for(let $=0;$<2;$++){B[0]=l[0]-65517;for(let pe=1;pe<15;pe++)B[pe]=l[pe]-65535-(B[pe-1]>>16&1),B[pe-1]&=65535;B[15]=l[15]-32767-(B[14]>>16&1);const he=B[15]>>16&1;B[14]&=65535,Q(l,B,1-he)}for(let $=0;$<16;$++)X[2*$]=l[$]&255,X[2*$+1]=l[$]>>8}function ce(X,Y){let B=0;for(let l=0;l<32;l++)B|=X[l]^Y[l];return(1&B-1>>>8)-1}function x(X,Y){const B=new Uint8Array(32),l=new Uint8Array(32);return J(B,X),J(l,Y),ce(B,l)}function C(X){const Y=new Uint8Array(32);return J(Y,X),Y[0]&1}function O(X,Y){for(let B=0;B<16;B++)X[B]=Y[2*B]+(Y[2*B+1]<<8);X[15]&=32767}function T(X,Y,B){for(let l=0;l<16;l++)X[l]=Y[l]+B[l]}function b(X,Y,B){for(let l=0;l<16;l++)X[l]=Y[l]-B[l]}function c(X,Y,B){let l,$,he=0,pe=0,Oe=0,ze=0,Ve=0,Fe=0,gt=0,_t=0,Me=0,Pe=0,Ue=0,De=0,qe=0,Te=0,je=0,Ie=0,Ae=0,Be=0,xe=0,Ge=0,We=0,et=0,tt=0,Je=0,tr=0,hr=0,Gr=0,rr=0,rn=0,vn=0,Dn=0,St=B[0],yt=B[1],It=B[2],Ot=B[3],bt=B[4],vt=B[5],$t=B[6],Ft=B[7],Pt=B[8],Lt=B[9],xt=B[10],Nt=B[11],Tt=B[12],ht=B[13],Mt=B[14],qt=B[15];l=Y[0],he+=l*St,pe+=l*yt,Oe+=l*It,ze+=l*Ot,Ve+=l*bt,Fe+=l*vt,gt+=l*$t,_t+=l*Ft,Me+=l*Pt,Pe+=l*Lt,Ue+=l*xt,De+=l*Nt,qe+=l*Tt,Te+=l*ht,je+=l*Mt,Ie+=l*qt,l=Y[1],pe+=l*St,Oe+=l*yt,ze+=l*It,Ve+=l*Ot,Fe+=l*bt,gt+=l*vt,_t+=l*$t,Me+=l*Ft,Pe+=l*Pt,Ue+=l*Lt,De+=l*xt,qe+=l*Nt,Te+=l*Tt,je+=l*ht,Ie+=l*Mt,Ae+=l*qt,l=Y[2],Oe+=l*St,ze+=l*yt,Ve+=l*It,Fe+=l*Ot,gt+=l*bt,_t+=l*vt,Me+=l*$t,Pe+=l*Ft,Ue+=l*Pt,De+=l*Lt,qe+=l*xt,Te+=l*Nt,je+=l*Tt,Ie+=l*ht,Ae+=l*Mt,Be+=l*qt,l=Y[3],ze+=l*St,Ve+=l*yt,Fe+=l*It,gt+=l*Ot,_t+=l*bt,Me+=l*vt,Pe+=l*$t,Ue+=l*Ft,De+=l*Pt,qe+=l*Lt,Te+=l*xt,je+=l*Nt,Ie+=l*Tt,Ae+=l*ht,Be+=l*Mt,xe+=l*qt,l=Y[4],Ve+=l*St,Fe+=l*yt,gt+=l*It,_t+=l*Ot,Me+=l*bt,Pe+=l*vt,Ue+=l*$t,De+=l*Ft,qe+=l*Pt,Te+=l*Lt,je+=l*xt,Ie+=l*Nt,Ae+=l*Tt,Be+=l*ht,xe+=l*Mt,Ge+=l*qt,l=Y[5],Fe+=l*St,gt+=l*yt,_t+=l*It,Me+=l*Ot,Pe+=l*bt,Ue+=l*vt,De+=l*$t,qe+=l*Ft,Te+=l*Pt,je+=l*Lt,Ie+=l*xt,Ae+=l*Nt,Be+=l*Tt,xe+=l*ht,Ge+=l*Mt,We+=l*qt,l=Y[6],gt+=l*St,_t+=l*yt,Me+=l*It,Pe+=l*Ot,Ue+=l*bt,De+=l*vt,qe+=l*$t,Te+=l*Ft,je+=l*Pt,Ie+=l*Lt,Ae+=l*xt,Be+=l*Nt,xe+=l*Tt,Ge+=l*ht,We+=l*Mt,et+=l*qt,l=Y[7],_t+=l*St,Me+=l*yt,Pe+=l*It,Ue+=l*Ot,De+=l*bt,qe+=l*vt,Te+=l*$t,je+=l*Ft,Ie+=l*Pt,Ae+=l*Lt,Be+=l*xt,xe+=l*Nt,Ge+=l*Tt,We+=l*ht,et+=l*Mt,tt+=l*qt,l=Y[8],Me+=l*St,Pe+=l*yt,Ue+=l*It,De+=l*Ot,qe+=l*bt,Te+=l*vt,je+=l*$t,Ie+=l*Ft,Ae+=l*Pt,Be+=l*Lt,xe+=l*xt,Ge+=l*Nt,We+=l*Tt,et+=l*ht,tt+=l*Mt,Je+=l*qt,l=Y[9],Pe+=l*St,Ue+=l*yt,De+=l*It,qe+=l*Ot,Te+=l*bt,je+=l*vt,Ie+=l*$t,Ae+=l*Ft,Be+=l*Pt,xe+=l*Lt,Ge+=l*xt,We+=l*Nt,et+=l*Tt,tt+=l*ht,Je+=l*Mt,tr+=l*qt,l=Y[10],Ue+=l*St,De+=l*yt,qe+=l*It,Te+=l*Ot,je+=l*bt,Ie+=l*vt,Ae+=l*$t,Be+=l*Ft,xe+=l*Pt,Ge+=l*Lt,We+=l*xt,et+=l*Nt,tt+=l*Tt,Je+=l*ht,tr+=l*Mt,hr+=l*qt,l=Y[11],De+=l*St,qe+=l*yt,Te+=l*It,je+=l*Ot,Ie+=l*bt,Ae+=l*vt,Be+=l*$t,xe+=l*Ft,Ge+=l*Pt,We+=l*Lt,et+=l*xt,tt+=l*Nt,Je+=l*Tt,tr+=l*ht,hr+=l*Mt,Gr+=l*qt,l=Y[12],qe+=l*St,Te+=l*yt,je+=l*It,Ie+=l*Ot,Ae+=l*bt,Be+=l*vt,xe+=l*$t,Ge+=l*Ft,We+=l*Pt,et+=l*Lt,tt+=l*xt,Je+=l*Nt,tr+=l*Tt,hr+=l*ht,Gr+=l*Mt,rr+=l*qt,l=Y[13],Te+=l*St,je+=l*yt,Ie+=l*It,Ae+=l*Ot,Be+=l*bt,xe+=l*vt,Ge+=l*$t,We+=l*Ft,et+=l*Pt,tt+=l*Lt,Je+=l*xt,tr+=l*Nt,hr+=l*Tt,Gr+=l*ht,rr+=l*Mt,rn+=l*qt,l=Y[14],je+=l*St,Ie+=l*yt,Ae+=l*It,Be+=l*Ot,xe+=l*bt,Ge+=l*vt,We+=l*$t,et+=l*Ft,tt+=l*Pt,Je+=l*Lt,tr+=l*xt,hr+=l*Nt,Gr+=l*Tt,rr+=l*ht,rn+=l*Mt,vn+=l*qt,l=Y[15],Ie+=l*St,Ae+=l*yt,Be+=l*It,xe+=l*Ot,Ge+=l*bt,We+=l*vt,et+=l*$t,tt+=l*Ft,Je+=l*Pt,tr+=l*Lt,hr+=l*xt,Gr+=l*Nt,rr+=l*Tt,rn+=l*ht,vn+=l*Mt,Dn+=l*qt,he+=38*Ae,pe+=38*Be,Oe+=38*xe,ze+=38*Ge,Ve+=38*We,Fe+=38*et,gt+=38*tt,_t+=38*Je,Me+=38*tr,Pe+=38*hr,Ue+=38*Gr,De+=38*rr,qe+=38*rn,Te+=38*vn,je+=38*Dn,$=1,l=he+$+65535,$=Math.floor(l/65536),he=l-$*65536,l=pe+$+65535,$=Math.floor(l/65536),pe=l-$*65536,l=Oe+$+65535,$=Math.floor(l/65536),Oe=l-$*65536,l=ze+$+65535,$=Math.floor(l/65536),ze=l-$*65536,l=Ve+$+65535,$=Math.floor(l/65536),Ve=l-$*65536,l=Fe+$+65535,$=Math.floor(l/65536),Fe=l-$*65536,l=gt+$+65535,$=Math.floor(l/65536),gt=l-$*65536,l=_t+$+65535,$=Math.floor(l/65536),_t=l-$*65536,l=Me+$+65535,$=Math.floor(l/65536),Me=l-$*65536,l=Pe+$+65535,$=Math.floor(l/65536),Pe=l-$*65536,l=Ue+$+65535,$=Math.floor(l/65536),Ue=l-$*65536,l=De+$+65535,$=Math.floor(l/65536),De=l-$*65536,l=qe+$+65535,$=Math.floor(l/65536),qe=l-$*65536,l=Te+$+65535,$=Math.floor(l/65536),Te=l-$*65536,l=je+$+65535,$=Math.floor(l/65536),je=l-$*65536,l=Ie+$+65535,$=Math.floor(l/65536),Ie=l-$*65536,he+=$-1+37*($-1),$=1,l=he+$+65535,$=Math.floor(l/65536),he=l-$*65536,l=pe+$+65535,$=Math.floor(l/65536),pe=l-$*65536,l=Oe+$+65535,$=Math.floor(l/65536),Oe=l-$*65536,l=ze+$+65535,$=Math.floor(l/65536),ze=l-$*65536,l=Ve+$+65535,$=Math.floor(l/65536),Ve=l-$*65536,l=Fe+$+65535,$=Math.floor(l/65536),Fe=l-$*65536,l=gt+$+65535,$=Math.floor(l/65536),gt=l-$*65536,l=_t+$+65535,$=Math.floor(l/65536),_t=l-$*65536,l=Me+$+65535,$=Math.floor(l/65536),Me=l-$*65536,l=Pe+$+65535,$=Math.floor(l/65536),Pe=l-$*65536,l=Ue+$+65535,$=Math.floor(l/65536),Ue=l-$*65536,l=De+$+65535,$=Math.floor(l/65536),De=l-$*65536,l=qe+$+65535,$=Math.floor(l/65536),qe=l-$*65536,l=Te+$+65535,$=Math.floor(l/65536),Te=l-$*65536,l=je+$+65535,$=Math.floor(l/65536),je=l-$*65536,l=Ie+$+65535,$=Math.floor(l/65536),Ie=l-$*65536,he+=$-1+37*($-1),X[0]=he,X[1]=pe,X[2]=Oe,X[3]=ze,X[4]=Ve,X[5]=Fe,X[6]=gt,X[7]=_t,X[8]=Me,X[9]=Pe,X[10]=Ue,X[11]=De,X[12]=qe,X[13]=Te,X[14]=je,X[15]=Ie}function _(X,Y){c(X,Y,Y)}function Z(X,Y){const B=o();let l;for(l=0;l<16;l++)B[l]=Y[l];for(l=253;l>=0;l--)_(B,B),l!==2&&l!==4&&c(B,B,Y);for(l=0;l<16;l++)X[l]=B[l]}function u(X,Y){const B=o();let l;for(l=0;l<16;l++)B[l]=Y[l];for(l=250;l>=0;l--)_(B,B),l!==1&&c(B,B,Y);for(l=0;l<16;l++)X[l]=B[l]}function f(X,Y){const B=o(),l=o(),$=o(),he=o(),pe=o(),Oe=o(),ze=o(),Ve=o(),Fe=o();b(B,X[1],X[0]),b(Fe,Y[1],Y[0]),c(B,B,Fe),T(l,X[0],X[1]),T(Fe,Y[0],Y[1]),c(l,l,Fe),c($,X[3],Y[3]),c($,$,U),c(he,X[2],Y[2]),T(he,he,he),b(pe,l,B),b(Oe,he,$),T(ze,he,$),T(Ve,l,B),c(X[0],pe,Oe),c(X[1],Ve,ze),c(X[2],ze,Oe),c(X[3],pe,Ve)}function d(X,Y,B){for(let l=0;l<4;l++)Q(X[l],Y[l],B)}function E(X,Y){const B=o(),l=o(),$=o();Z($,Y[2]),c(B,Y[0],$),c(l,Y[1],$),J(X,l),X[31]^=C(B)<<7}function y(X,Y,B){q(X[0],w),q(X[1],v),q(X[2],v),q(X[3],w);for(let l=255;l>=0;--l){const $=B[l/8|0]>>(l&7)&1;d(X,Y,$),f(Y,X),f(X,X),d(X,Y,$)}}function p(X,Y){const B=[o(),o(),o(),o()];q(B[0],R),q(B[1],F),q(B[2],v),c(B[3],R,F),y(X,B,Y)}function D(X){if(X.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const Y=(0,r.hash)(X);Y[0]&=248,Y[31]&=127,Y[31]|=64;const B=new Uint8Array(32),l=[o(),o(),o(),o()];p(l,Y),E(B,l);const $=new Uint8Array(64);return $.set(X),$.set(B,32),{publicKey:B,secretKey:$}}i.generateKeyPairFromSeed=D;function L(X){const Y=(0,t.randomBytes)(32,X),B=D(Y);return(0,s.wipe)(Y),B}i.generateKeyPair=L;function W(X){if(X.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(X.subarray(32))}i.extractPublicKeyFromSecretKey=W;const A=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function z(X,Y){let B,l,$,he;for(l=63;l>=32;--l){for(B=0,$=l-32,he=l-12;$<he;++$)Y[$]+=B-16*Y[l]*A[$-(l-32)],B=Math.floor((Y[$]+128)/256),Y[$]-=B*256;Y[$]+=B,Y[l]=0}for(B=0,$=0;$<32;$++)Y[$]+=B-(Y[31]>>4)*A[$],B=Y[$]>>8,Y[$]&=255;for($=0;$<32;$++)Y[$]-=B*A[$];for(l=0;l<32;l++)Y[l+1]+=Y[l]>>8,X[l]=Y[l]&255}function te(X){const Y=new Float64Array(64);for(let B=0;B<64;B++)Y[B]=X[B];for(let B=0;B<64;B++)X[B]=0;z(X,Y)}function re(X,Y){const B=new Float64Array(64),l=[o(),o(),o(),o()],$=(0,r.hash)(X.subarray(0,32));$[0]&=248,$[31]&=127,$[31]|=64;const he=new Uint8Array(64);he.set($.subarray(32),32);const pe=new r.SHA512;pe.update(he.subarray(32)),pe.update(Y);const Oe=pe.digest();pe.clean(),te(Oe),p(l,Oe),E(he,l),pe.reset(),pe.update(he.subarray(0,32)),pe.update(X.subarray(32)),pe.update(Y);const ze=pe.digest();te(ze);for(let Ve=0;Ve<32;Ve++)B[Ve]=Oe[Ve];for(let Ve=0;Ve<32;Ve++)for(let Fe=0;Fe<32;Fe++)B[Ve+Fe]+=ze[Ve]*$[Fe];return z(he.subarray(32),B),he}i.sign=re;function ne(X,Y){const B=o(),l=o(),$=o(),he=o(),pe=o(),Oe=o(),ze=o();return q(X[2],v),O(X[1],Y),_($,X[1]),c(he,$,S),b($,$,X[2]),T(he,X[2],he),_(pe,he),_(Oe,pe),c(ze,Oe,pe),c(B,ze,$),c(B,B,he),u(B,B),c(B,B,$),c(B,B,he),c(B,B,he),c(X[0],B,he),_(l,X[0]),c(l,l,he),x(l,$)&&c(X[0],X[0],K),_(l,X[0]),c(l,l,he),x(l,$)?-1:(C(X[0])===Y[31]>>7&&b(X[0],w,X[0]),c(X[3],X[0],X[1]),0)}function ge(X,Y,B){const l=new Uint8Array(32),$=[o(),o(),o(),o()],he=[o(),o(),o(),o()];if(B.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(ne(he,X))return!1;const pe=new r.SHA512;pe.update(B.subarray(0,32)),pe.update(X),pe.update(Y);const Oe=pe.digest();return te(Oe),y($,he,Oe),p(he,B.subarray(32)),f($,he),E(l,$),!ce(B,l)}i.verify=ge;function le(X){let Y=[o(),o(),o(),o()];if(ne(Y,X))throw new Error("Ed25519: invalid public key");let B=o(),l=o(),$=Y[1];T(B,v,$),b(l,v,$),Z(l,l),c(B,B,l);let he=new Uint8Array(32);return J(he,B),he}i.convertPublicKeyToX25519=le;function be(X){const Y=(0,r.hash)(X.subarray(0,32));Y[0]&=248,Y[31]&=127,Y[31]|=64;const B=new Uint8Array(Y.subarray(0,32));return(0,s.wipe)(Y),B}i.convertSecretKeyToX25519=be})(hu);const Ob="EdDSA",Pb="JWT",Nd=".",Rd="base64url",xb="utf8",Tb="utf8",Ab=":",Cb="did",Nb="key",of="base58btc",Rb="z",Ub="K36",Db=32;function lu(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function Ud(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?lu(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function jb(i,t){t||(t=i.reduce((o,g)=>o+g.length,0));const r=Ud(t);let s=0;for(const o of i)r.set(o,s),s+=o.length;return lu(r)}function Dd(i,t,r,s){return{name:i,prefix:t,encoder:{name:i,prefix:t,encode:r},decoder:{decode:s}}}const cf=Dd("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Cc=Dd("ascii","a",i=>{let t="a";for(let r=0;r<i.length;r++)t+=String.fromCharCode(i[r]);return t},i=>{i=i.substring(1);const t=Ud(i.length);for(let r=0;r<i.length;r++)t[r]=i.charCodeAt(r);return t}),jd={utf8:cf,"utf-8":cf,hex:Ci.base16,latin1:Cc,ascii:Cc,binary:Cc,...Ci};function fu(i,t="utf8"){const r=jd[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):r.encoder.encode(i).substring(1)}function du(i,t="utf8"){const r=jd[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?lu(globalThis.Buffer.from(i,"utf-8")):r.decoder.decode(`${r.prefix}${i}`)}function Ua(i){return fu(du(ps(i),xb),Rd)}function $d(i){const t=du(Ub,of),r=Rb+fu(jb([t,i]),of);return[Cb,Nb,r].join(Ab)}function $b(i){return fu(i,Rd)}function Fb(i){return du([Ua(i.header),Ua(i.payload)].join(Nd),Tb)}function Lb(i){return[Ua(i.header),Ua(i.payload),$b(i.signature)].join(Nd)}function uf(i=Ni.randomBytes(Db)){return hu.generateKeyPairFromSeed(i)}async function Mb(i,t,r,s,o=me.fromMiliseconds(Date.now())){const g={alg:Ob,typ:Pb},w=$d(s.publicKey),v=o+r,S={iss:w,sub:i,aud:t,iat:o,exp:v},U=Fb({header:g,payload:S}),R=hu.sign(s.secretKey,U);return Lb({header:g,payload:S,signature:R})}var pu={},Ba={};Object.defineProperty(Ba,"__esModule",{value:!0});var er=$e,Wc=Sr,qb=20;function Hb(i,t,r){for(var s=1634760805,o=857760878,g=2036477234,w=1797285236,v=r[3]<<24|r[2]<<16|r[1]<<8|r[0],S=r[7]<<24|r[6]<<16|r[5]<<8|r[4],U=r[11]<<24|r[10]<<16|r[9]<<8|r[8],R=r[15]<<24|r[14]<<16|r[13]<<8|r[12],F=r[19]<<24|r[18]<<16|r[17]<<8|r[16],K=r[23]<<24|r[22]<<16|r[21]<<8|r[20],q=r[27]<<24|r[26]<<16|r[25]<<8|r[24],H=r[31]<<24|r[30]<<16|r[29]<<8|r[28],Q=t[3]<<24|t[2]<<16|t[1]<<8|t[0],J=t[7]<<24|t[6]<<16|t[5]<<8|t[4],ce=t[11]<<24|t[10]<<16|t[9]<<8|t[8],x=t[15]<<24|t[14]<<16|t[13]<<8|t[12],C=s,O=o,T=g,b=w,c=v,_=S,Z=U,u=R,f=F,d=K,E=q,y=H,p=Q,D=J,L=ce,W=x,A=0;A<qb;A+=2)C=C+c|0,p^=C,p=p>>>32-16|p<<16,f=f+p|0,c^=f,c=c>>>32-12|c<<12,O=O+_|0,D^=O,D=D>>>32-16|D<<16,d=d+D|0,_^=d,_=_>>>32-12|_<<12,T=T+Z|0,L^=T,L=L>>>32-16|L<<16,E=E+L|0,Z^=E,Z=Z>>>32-12|Z<<12,b=b+u|0,W^=b,W=W>>>32-16|W<<16,y=y+W|0,u^=y,u=u>>>32-12|u<<12,T=T+Z|0,L^=T,L=L>>>32-8|L<<8,E=E+L|0,Z^=E,Z=Z>>>32-7|Z<<7,b=b+u|0,W^=b,W=W>>>32-8|W<<8,y=y+W|0,u^=y,u=u>>>32-7|u<<7,O=O+_|0,D^=O,D=D>>>32-8|D<<8,d=d+D|0,_^=d,_=_>>>32-7|_<<7,C=C+c|0,p^=C,p=p>>>32-8|p<<8,f=f+p|0,c^=f,c=c>>>32-7|c<<7,C=C+_|0,W^=C,W=W>>>32-16|W<<16,E=E+W|0,_^=E,_=_>>>32-12|_<<12,O=O+Z|0,p^=O,p=p>>>32-16|p<<16,y=y+p|0,Z^=y,Z=Z>>>32-12|Z<<12,T=T+u|0,D^=T,D=D>>>32-16|D<<16,f=f+D|0,u^=f,u=u>>>32-12|u<<12,b=b+c|0,L^=b,L=L>>>32-16|L<<16,d=d+L|0,c^=d,c=c>>>32-12|c<<12,T=T+u|0,D^=T,D=D>>>32-8|D<<8,f=f+D|0,u^=f,u=u>>>32-7|u<<7,b=b+c|0,L^=b,L=L>>>32-8|L<<8,d=d+L|0,c^=d,c=c>>>32-7|c<<7,O=O+Z|0,p^=O,p=p>>>32-8|p<<8,y=y+p|0,Z^=y,Z=Z>>>32-7|Z<<7,C=C+_|0,W^=C,W=W>>>32-8|W<<8,E=E+W|0,_^=E,_=_>>>32-7|_<<7;er.writeUint32LE(C+s|0,i,0),er.writeUint32LE(O+o|0,i,4),er.writeUint32LE(T+g|0,i,8),er.writeUint32LE(b+w|0,i,12),er.writeUint32LE(c+v|0,i,16),er.writeUint32LE(_+S|0,i,20),er.writeUint32LE(Z+U|0,i,24),er.writeUint32LE(u+R|0,i,28),er.writeUint32LE(f+F|0,i,32),er.writeUint32LE(d+K|0,i,36),er.writeUint32LE(E+q|0,i,40),er.writeUint32LE(y+H|0,i,44),er.writeUint32LE(p+Q|0,i,48),er.writeUint32LE(D+J|0,i,52),er.writeUint32LE(L+ce|0,i,56),er.writeUint32LE(W+x|0,i,60)}function Fd(i,t,r,s,o){if(o===void 0&&(o=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var g,w;if(o===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");g=new Uint8Array(16),w=g.length-t.length,g.set(t,w)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");g=t,w=o}for(var v=new Uint8Array(64),S=0;S<r.length;S+=64){Hb(v,g,i);for(var U=S;U<S+64&&U<r.length;U++)s[U]=r[U]^v[U-S];Bb(g,0,w)}return Wc.wipe(v),o===0&&Wc.wipe(g),s}Ba.streamXOR=Fd;function zb(i,t,r,s){return s===void 0&&(s=0),Wc.wipe(r),Fd(i,t,r,r,s)}Ba.stream=zb;function Bb(i,t,r){for(var s=1;r--;)s=s+(i[t]&255)|0,i[t]=s&255,s>>>=8,t++;if(s>0)throw new Error("ChaCha: counter overflow")}var Ld={},Nn={};Object.defineProperty(Nn,"__esModule",{value:!0});function Kb(i,t,r){return~(i-1)&t|i-1&r}Nn.select=Kb;function Vb(i,t){return(i|0)-(t|0)-1>>>31&1}Nn.lessOrEqual=Vb;function Md(i,t){if(i.length!==t.length)return 0;for(var r=0,s=0;s<i.length;s++)r|=i[s]^t[s];return 1&r-1>>>8}Nn.compare=Md;function Gb(i,t){return i.length===0||t.length===0?!1:Md(i,t)!==0}Nn.equal=Gb;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=Nn,r=Sr;i.DIGEST_LENGTH=16;var s=function(){function w(v){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var S=v[0]|v[1]<<8;this._r[0]=S&8191;var U=v[2]|v[3]<<8;this._r[1]=(S>>>13|U<<3)&8191;var R=v[4]|v[5]<<8;this._r[2]=(U>>>10|R<<6)&7939;var F=v[6]|v[7]<<8;this._r[3]=(R>>>7|F<<9)&8191;var K=v[8]|v[9]<<8;this._r[4]=(F>>>4|K<<12)&255,this._r[5]=K>>>1&8190;var q=v[10]|v[11]<<8;this._r[6]=(K>>>14|q<<2)&8191;var H=v[12]|v[13]<<8;this._r[7]=(q>>>11|H<<5)&8065;var Q=v[14]|v[15]<<8;this._r[8]=(H>>>8|Q<<8)&8191,this._r[9]=Q>>>5&127,this._pad[0]=v[16]|v[17]<<8,this._pad[1]=v[18]|v[19]<<8,this._pad[2]=v[20]|v[21]<<8,this._pad[3]=v[22]|v[23]<<8,this._pad[4]=v[24]|v[25]<<8,this._pad[5]=v[26]|v[27]<<8,this._pad[6]=v[28]|v[29]<<8,this._pad[7]=v[30]|v[31]<<8}return w.prototype._blocks=function(v,S,U){for(var R=this._fin?0:2048,F=this._h[0],K=this._h[1],q=this._h[2],H=this._h[3],Q=this._h[4],J=this._h[5],ce=this._h[6],x=this._h[7],C=this._h[8],O=this._h[9],T=this._r[0],b=this._r[1],c=this._r[2],_=this._r[3],Z=this._r[4],u=this._r[5],f=this._r[6],d=this._r[7],E=this._r[8],y=this._r[9];U>=16;){var p=v[S+0]|v[S+1]<<8;F+=p&8191;var D=v[S+2]|v[S+3]<<8;K+=(p>>>13|D<<3)&8191;var L=v[S+4]|v[S+5]<<8;q+=(D>>>10|L<<6)&8191;var W=v[S+6]|v[S+7]<<8;H+=(L>>>7|W<<9)&8191;var A=v[S+8]|v[S+9]<<8;Q+=(W>>>4|A<<12)&8191,J+=A>>>1&8191;var z=v[S+10]|v[S+11]<<8;ce+=(A>>>14|z<<2)&8191;var te=v[S+12]|v[S+13]<<8;x+=(z>>>11|te<<5)&8191;var re=v[S+14]|v[S+15]<<8;C+=(te>>>8|re<<8)&8191,O+=re>>>5|R;var ne=0,ge=ne;ge+=F*T,ge+=K*(5*y),ge+=q*(5*E),ge+=H*(5*d),ge+=Q*(5*f),ne=ge>>>13,ge&=8191,ge+=J*(5*u),ge+=ce*(5*Z),ge+=x*(5*_),ge+=C*(5*c),ge+=O*(5*b),ne+=ge>>>13,ge&=8191;var le=ne;le+=F*b,le+=K*T,le+=q*(5*y),le+=H*(5*E),le+=Q*(5*d),ne=le>>>13,le&=8191,le+=J*(5*f),le+=ce*(5*u),le+=x*(5*Z),le+=C*(5*_),le+=O*(5*c),ne+=le>>>13,le&=8191;var be=ne;be+=F*c,be+=K*b,be+=q*T,be+=H*(5*y),be+=Q*(5*E),ne=be>>>13,be&=8191,be+=J*(5*d),be+=ce*(5*f),be+=x*(5*u),be+=C*(5*Z),be+=O*(5*_),ne+=be>>>13,be&=8191;var X=ne;X+=F*_,X+=K*c,X+=q*b,X+=H*T,X+=Q*(5*y),ne=X>>>13,X&=8191,X+=J*(5*E),X+=ce*(5*d),X+=x*(5*f),X+=C*(5*u),X+=O*(5*Z),ne+=X>>>13,X&=8191;var Y=ne;Y+=F*Z,Y+=K*_,Y+=q*c,Y+=H*b,Y+=Q*T,ne=Y>>>13,Y&=8191,Y+=J*(5*y),Y+=ce*(5*E),Y+=x*(5*d),Y+=C*(5*f),Y+=O*(5*u),ne+=Y>>>13,Y&=8191;var B=ne;B+=F*u,B+=K*Z,B+=q*_,B+=H*c,B+=Q*b,ne=B>>>13,B&=8191,B+=J*T,B+=ce*(5*y),B+=x*(5*E),B+=C*(5*d),B+=O*(5*f),ne+=B>>>13,B&=8191;var l=ne;l+=F*f,l+=K*u,l+=q*Z,l+=H*_,l+=Q*c,ne=l>>>13,l&=8191,l+=J*b,l+=ce*T,l+=x*(5*y),l+=C*(5*E),l+=O*(5*d),ne+=l>>>13,l&=8191;var $=ne;$+=F*d,$+=K*f,$+=q*u,$+=H*Z,$+=Q*_,ne=$>>>13,$&=8191,$+=J*c,$+=ce*b,$+=x*T,$+=C*(5*y),$+=O*(5*E),ne+=$>>>13,$&=8191;var he=ne;he+=F*E,he+=K*d,he+=q*f,he+=H*u,he+=Q*Z,ne=he>>>13,he&=8191,he+=J*_,he+=ce*c,he+=x*b,he+=C*T,he+=O*(5*y),ne+=he>>>13,he&=8191;var pe=ne;pe+=F*y,pe+=K*E,pe+=q*d,pe+=H*f,pe+=Q*u,ne=pe>>>13,pe&=8191,pe+=J*Z,pe+=ce*_,pe+=x*c,pe+=C*b,pe+=O*T,ne+=pe>>>13,pe&=8191,ne=(ne<<2)+ne|0,ne=ne+ge|0,ge=ne&8191,ne=ne>>>13,le+=ne,F=ge,K=le,q=be,H=X,Q=Y,J=B,ce=l,x=$,C=he,O=pe,S+=16,U-=16}this._h[0]=F,this._h[1]=K,this._h[2]=q,this._h[3]=H,this._h[4]=Q,this._h[5]=J,this._h[6]=ce,this._h[7]=x,this._h[8]=C,this._h[9]=O},w.prototype.finish=function(v,S){S===void 0&&(S=0);var U=new Uint16Array(10),R,F,K,q;if(this._leftover){for(q=this._leftover,this._buffer[q++]=1;q<16;q++)this._buffer[q]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(R=this._h[1]>>>13,this._h[1]&=8191,q=2;q<10;q++)this._h[q]+=R,R=this._h[q]>>>13,this._h[q]&=8191;for(this._h[0]+=R*5,R=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=R,R=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=R,U[0]=this._h[0]+5,R=U[0]>>>13,U[0]&=8191,q=1;q<10;q++)U[q]=this._h[q]+R,R=U[q]>>>13,U[q]&=8191;for(U[9]-=8192,F=(R^1)-1,q=0;q<10;q++)U[q]&=F;for(F=~F,q=0;q<10;q++)this._h[q]=this._h[q]&F|U[q];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,K=this._h[0]+this._pad[0],this._h[0]=K&65535,q=1;q<8;q++)K=(this._h[q]+this._pad[q]|0)+(K>>>16)|0,this._h[q]=K&65535;return v[S+0]=this._h[0]>>>0,v[S+1]=this._h[0]>>>8,v[S+2]=this._h[1]>>>0,v[S+3]=this._h[1]>>>8,v[S+4]=this._h[2]>>>0,v[S+5]=this._h[2]>>>8,v[S+6]=this._h[3]>>>0,v[S+7]=this._h[3]>>>8,v[S+8]=this._h[4]>>>0,v[S+9]=this._h[4]>>>8,v[S+10]=this._h[5]>>>0,v[S+11]=this._h[5]>>>8,v[S+12]=this._h[6]>>>0,v[S+13]=this._h[6]>>>8,v[S+14]=this._h[7]>>>0,v[S+15]=this._h[7]>>>8,this._finished=!0,this},w.prototype.update=function(v){var S=0,U=v.length,R;if(this._leftover){R=16-this._leftover,R>U&&(R=U);for(var F=0;F<R;F++)this._buffer[this._leftover+F]=v[S+F];if(U-=R,S+=R,this._leftover+=R,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(U>=16&&(R=U-U%16,this._blocks(v,S,R),S+=R,U-=R),U){for(var F=0;F<U;F++)this._buffer[this._leftover+F]=v[S+F];this._leftover+=U}return this},w.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var v=new Uint8Array(16);return this.finish(v),v},w.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},w}();i.Poly1305=s;function o(w,v){var S=new s(w);S.update(v);var U=S.digest();return S.clean(),U}i.oneTimeAuth=o;function g(w,v){return w.length!==i.DIGEST_LENGTH||v.length!==i.DIGEST_LENGTH?!1:t.equal(w,v)}i.equal=g})(Ld);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=Ba,r=Ld,s=Sr,o=$e,g=Nn;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var w=new Uint8Array(16),v=function(){function S(U){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,U.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(U)}return S.prototype.seal=function(U,R,F,K){if(U.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var q=new Uint8Array(16);q.set(U,q.length-U.length);var H=new Uint8Array(32);t.stream(this._key,q,H,4);var Q=R.length+this.tagLength,J;if(K){if(K.length!==Q)throw new Error("ChaCha20Poly1305: incorrect destination length");J=K}else J=new Uint8Array(Q);return t.streamXOR(this._key,q,R,J,4),this._authenticate(J.subarray(J.length-this.tagLength,J.length),H,J.subarray(0,J.length-this.tagLength),F),s.wipe(q),J},S.prototype.open=function(U,R,F,K){if(U.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(R.length<this.tagLength)return null;var q=new Uint8Array(16);q.set(U,q.length-U.length);var H=new Uint8Array(32);t.stream(this._key,q,H,4);var Q=new Uint8Array(this.tagLength);if(this._authenticate(Q,H,R.subarray(0,R.length-this.tagLength),F),!g.equal(Q,R.subarray(R.length-this.tagLength,R.length)))return null;var J=R.length-this.tagLength,ce;if(K){if(K.length!==J)throw new Error("ChaCha20Poly1305: incorrect destination length");ce=K}else ce=new Uint8Array(J);return t.streamXOR(this._key,q,R.subarray(0,R.length-this.tagLength),ce,4),s.wipe(q),ce},S.prototype.clean=function(){return s.wipe(this._key),this},S.prototype._authenticate=function(U,R,F,K){var q=new r.Poly1305(R);K&&(q.update(K),K.length%16>0&&q.update(w.subarray(K.length%16))),q.update(F),F.length%16>0&&q.update(w.subarray(F.length%16));var H=new Uint8Array(8);K&&o.writeUint64LE(K.length,H),q.update(H),o.writeUint64LE(F.length,H),q.update(H);for(var Q=q.digest(),J=0;J<Q.length;J++)U[J]=Q[J];q.clean(),s.wipe(Q),s.wipe(H)},S}();i.ChaCha20Poly1305=v})(pu);var qd={},vs={},gu={};Object.defineProperty(gu,"__esModule",{value:!0});function kb(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}gu.isSerializableHash=kb;Object.defineProperty(vs,"__esModule",{value:!0});var Zr=gu,Wb=Nn,Yb=Sr,Hd=function(){function i(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Zr.isSerializableHash(this._inner)&&Zr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Yb.wipe(s)}return i.prototype.reset=function(){if(!Zr.isSerializableHash(this._inner)||!Zr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){Zr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Zr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(t){return this._inner.update(t),this},i.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},i.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},i.prototype.saveState=function(){if(!Zr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(t){if(!Zr.isSerializableHash(this._inner)||!Zr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(t){if(!Zr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},i}();vs.HMAC=Hd;function Jb(i,t,r){var s=new Hd(i,t);s.update(r);var o=s.digest();return s.clean(),o}vs.hmac=Jb;vs.equal=Wb.equal;Object.defineProperty(qd,"__esModule",{value:!0});var hf=vs,lf=Sr,Xb=function(){function i(t,r,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=o;var g=hf.hmac(this._hash,s,r);this._hmac=new hf.HMAC(t,g),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(t){for(var r=new Uint8Array(t),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},i.prototype.clean=function(){this._hmac.clean(),lf.wipe(this._buffer),lf.wipe(this._counter),this._bufpos=0},i}(),Zb=qd.HKDF=Xb,Ka={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=$e,r=Sr;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function v(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return v.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},v.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},v.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},v.prototype.update=function(S,U){if(U===void 0&&(U=S.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var R=0;if(this._bytesHashed+=U,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&U>0;)this._buffer[this._bufferLength++]=S[R++],U--;this._bufferLength===this.blockSize&&(g(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(U>=this.blockSize&&(R=g(this._temp,this._state,S,R,U),U%=this.blockSize);U>0;)this._buffer[this._bufferLength++]=S[R++],U--;return this},v.prototype.finish=function(S){if(!this._finished){var U=this._bytesHashed,R=this._bufferLength,F=U/536870912|0,K=U<<3,q=U%64<56?64:128;this._buffer[R]=128;for(var H=R+1;H<q-8;H++)this._buffer[H]=0;t.writeUint32BE(F,this._buffer,q-8),t.writeUint32BE(K,this._buffer,q-4),g(this._temp,this._state,this._buffer,0,q),this._finished=!0}for(var H=0;H<this.digestLength/4;H++)t.writeUint32BE(this._state[H],S,H*4);return this},v.prototype.digest=function(){var S=new Uint8Array(this.digestLength);return this.finish(S),S},v.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},v.prototype.restoreState=function(S){return this._state.set(S.state),this._bufferLength=S.bufferLength,S.buffer&&this._buffer.set(S.buffer),this._bytesHashed=S.bytesHashed,this._finished=!1,this},v.prototype.cleanSavedState=function(S){r.wipe(S.state),S.buffer&&r.wipe(S.buffer),S.bufferLength=0,S.bytesHashed=0},v}();i.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function g(v,S,U,R,F){for(;F>=64;){for(var K=S[0],q=S[1],H=S[2],Q=S[3],J=S[4],ce=S[5],x=S[6],C=S[7],O=0;O<16;O++){var T=R+O*4;v[O]=t.readUint32BE(U,T)}for(var O=16;O<64;O++){var b=v[O-2],c=(b>>>17|b<<32-17)^(b>>>19|b<<32-19)^b>>>10;b=v[O-15];var _=(b>>>7|b<<32-7)^(b>>>18|b<<32-18)^b>>>3;v[O]=(c+v[O-7]|0)+(_+v[O-16]|0)}for(var O=0;O<64;O++){var c=(((J>>>6|J<<26)^(J>>>11|J<<21)^(J>>>25|J<<7))+(J&ce^~J&x)|0)+(C+(o[O]+v[O]|0)|0)|0,_=((K>>>2|K<<32-2)^(K>>>13|K<<32-13)^(K>>>22|K<<32-22))+(K&q^K&H^q&H)|0;C=x,x=ce,ce=J,J=Q+c|0,Q=H,H=q,q=K,K=c+_|0}S[0]+=K,S[1]+=q,S[2]+=H,S[3]+=Q,S[4]+=J,S[5]+=ce,S[6]+=x,S[7]+=C,R+=64,F-=64}return R}function w(v){var S=new s;S.update(v);var U=S.digest();return S.clean(),U}i.hash=w})(Ka);var _u={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const t=Ni,r=Sr;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(O){const T=new Float64Array(16);if(O)for(let b=0;b<O.length;b++)T[b]=O[b];return T}const o=new Uint8Array(32);o[0]=9;const g=s([56129,1]);function w(O){let T=1;for(let b=0;b<16;b++){let c=O[b]+T+65535;T=Math.floor(c/65536),O[b]=c-T*65536}O[0]+=T-1+37*(T-1)}function v(O,T,b){const c=~(b-1);for(let _=0;_<16;_++){const Z=c&(O[_]^T[_]);O[_]^=Z,T[_]^=Z}}function S(O,T){const b=s(),c=s();for(let _=0;_<16;_++)c[_]=T[_];w(c),w(c),w(c);for(let _=0;_<2;_++){b[0]=c[0]-65517;for(let u=1;u<15;u++)b[u]=c[u]-65535-(b[u-1]>>16&1),b[u-1]&=65535;b[15]=c[15]-32767-(b[14]>>16&1);const Z=b[15]>>16&1;b[14]&=65535,v(c,b,1-Z)}for(let _=0;_<16;_++)O[2*_]=c[_]&255,O[2*_+1]=c[_]>>8}function U(O,T){for(let b=0;b<16;b++)O[b]=T[2*b]+(T[2*b+1]<<8);O[15]&=32767}function R(O,T,b){for(let c=0;c<16;c++)O[c]=T[c]+b[c]}function F(O,T,b){for(let c=0;c<16;c++)O[c]=T[c]-b[c]}function K(O,T,b){let c,_,Z=0,u=0,f=0,d=0,E=0,y=0,p=0,D=0,L=0,W=0,A=0,z=0,te=0,re=0,ne=0,ge=0,le=0,be=0,X=0,Y=0,B=0,l=0,$=0,he=0,pe=0,Oe=0,ze=0,Ve=0,Fe=0,gt=0,_t=0,Me=b[0],Pe=b[1],Ue=b[2],De=b[3],qe=b[4],Te=b[5],je=b[6],Ie=b[7],Ae=b[8],Be=b[9],xe=b[10],Ge=b[11],We=b[12],et=b[13],tt=b[14],Je=b[15];c=T[0],Z+=c*Me,u+=c*Pe,f+=c*Ue,d+=c*De,E+=c*qe,y+=c*Te,p+=c*je,D+=c*Ie,L+=c*Ae,W+=c*Be,A+=c*xe,z+=c*Ge,te+=c*We,re+=c*et,ne+=c*tt,ge+=c*Je,c=T[1],u+=c*Me,f+=c*Pe,d+=c*Ue,E+=c*De,y+=c*qe,p+=c*Te,D+=c*je,L+=c*Ie,W+=c*Ae,A+=c*Be,z+=c*xe,te+=c*Ge,re+=c*We,ne+=c*et,ge+=c*tt,le+=c*Je,c=T[2],f+=c*Me,d+=c*Pe,E+=c*Ue,y+=c*De,p+=c*qe,D+=c*Te,L+=c*je,W+=c*Ie,A+=c*Ae,z+=c*Be,te+=c*xe,re+=c*Ge,ne+=c*We,ge+=c*et,le+=c*tt,be+=c*Je,c=T[3],d+=c*Me,E+=c*Pe,y+=c*Ue,p+=c*De,D+=c*qe,L+=c*Te,W+=c*je,A+=c*Ie,z+=c*Ae,te+=c*Be,re+=c*xe,ne+=c*Ge,ge+=c*We,le+=c*et,be+=c*tt,X+=c*Je,c=T[4],E+=c*Me,y+=c*Pe,p+=c*Ue,D+=c*De,L+=c*qe,W+=c*Te,A+=c*je,z+=c*Ie,te+=c*Ae,re+=c*Be,ne+=c*xe,ge+=c*Ge,le+=c*We,be+=c*et,X+=c*tt,Y+=c*Je,c=T[5],y+=c*Me,p+=c*Pe,D+=c*Ue,L+=c*De,W+=c*qe,A+=c*Te,z+=c*je,te+=c*Ie,re+=c*Ae,ne+=c*Be,ge+=c*xe,le+=c*Ge,be+=c*We,X+=c*et,Y+=c*tt,B+=c*Je,c=T[6],p+=c*Me,D+=c*Pe,L+=c*Ue,W+=c*De,A+=c*qe,z+=c*Te,te+=c*je,re+=c*Ie,ne+=c*Ae,ge+=c*Be,le+=c*xe,be+=c*Ge,X+=c*We,Y+=c*et,B+=c*tt,l+=c*Je,c=T[7],D+=c*Me,L+=c*Pe,W+=c*Ue,A+=c*De,z+=c*qe,te+=c*Te,re+=c*je,ne+=c*Ie,ge+=c*Ae,le+=c*Be,be+=c*xe,X+=c*Ge,Y+=c*We,B+=c*et,l+=c*tt,$+=c*Je,c=T[8],L+=c*Me,W+=c*Pe,A+=c*Ue,z+=c*De,te+=c*qe,re+=c*Te,ne+=c*je,ge+=c*Ie,le+=c*Ae,be+=c*Be,X+=c*xe,Y+=c*Ge,B+=c*We,l+=c*et,$+=c*tt,he+=c*Je,c=T[9],W+=c*Me,A+=c*Pe,z+=c*Ue,te+=c*De,re+=c*qe,ne+=c*Te,ge+=c*je,le+=c*Ie,be+=c*Ae,X+=c*Be,Y+=c*xe,B+=c*Ge,l+=c*We,$+=c*et,he+=c*tt,pe+=c*Je,c=T[10],A+=c*Me,z+=c*Pe,te+=c*Ue,re+=c*De,ne+=c*qe,ge+=c*Te,le+=c*je,be+=c*Ie,X+=c*Ae,Y+=c*Be,B+=c*xe,l+=c*Ge,$+=c*We,he+=c*et,pe+=c*tt,Oe+=c*Je,c=T[11],z+=c*Me,te+=c*Pe,re+=c*Ue,ne+=c*De,ge+=c*qe,le+=c*Te,be+=c*je,X+=c*Ie,Y+=c*Ae,B+=c*Be,l+=c*xe,$+=c*Ge,he+=c*We,pe+=c*et,Oe+=c*tt,ze+=c*Je,c=T[12],te+=c*Me,re+=c*Pe,ne+=c*Ue,ge+=c*De,le+=c*qe,be+=c*Te,X+=c*je,Y+=c*Ie,B+=c*Ae,l+=c*Be,$+=c*xe,he+=c*Ge,pe+=c*We,Oe+=c*et,ze+=c*tt,Ve+=c*Je,c=T[13],re+=c*Me,ne+=c*Pe,ge+=c*Ue,le+=c*De,be+=c*qe,X+=c*Te,Y+=c*je,B+=c*Ie,l+=c*Ae,$+=c*Be,he+=c*xe,pe+=c*Ge,Oe+=c*We,ze+=c*et,Ve+=c*tt,Fe+=c*Je,c=T[14],ne+=c*Me,ge+=c*Pe,le+=c*Ue,be+=c*De,X+=c*qe,Y+=c*Te,B+=c*je,l+=c*Ie,$+=c*Ae,he+=c*Be,pe+=c*xe,Oe+=c*Ge,ze+=c*We,Ve+=c*et,Fe+=c*tt,gt+=c*Je,c=T[15],ge+=c*Me,le+=c*Pe,be+=c*Ue,X+=c*De,Y+=c*qe,B+=c*Te,l+=c*je,$+=c*Ie,he+=c*Ae,pe+=c*Be,Oe+=c*xe,ze+=c*Ge,Ve+=c*We,Fe+=c*et,gt+=c*tt,_t+=c*Je,Z+=38*le,u+=38*be,f+=38*X,d+=38*Y,E+=38*B,y+=38*l,p+=38*$,D+=38*he,L+=38*pe,W+=38*Oe,A+=38*ze,z+=38*Ve,te+=38*Fe,re+=38*gt,ne+=38*_t,_=1,c=Z+_+65535,_=Math.floor(c/65536),Z=c-_*65536,c=u+_+65535,_=Math.floor(c/65536),u=c-_*65536,c=f+_+65535,_=Math.floor(c/65536),f=c-_*65536,c=d+_+65535,_=Math.floor(c/65536),d=c-_*65536,c=E+_+65535,_=Math.floor(c/65536),E=c-_*65536,c=y+_+65535,_=Math.floor(c/65536),y=c-_*65536,c=p+_+65535,_=Math.floor(c/65536),p=c-_*65536,c=D+_+65535,_=Math.floor(c/65536),D=c-_*65536,c=L+_+65535,_=Math.floor(c/65536),L=c-_*65536,c=W+_+65535,_=Math.floor(c/65536),W=c-_*65536,c=A+_+65535,_=Math.floor(c/65536),A=c-_*65536,c=z+_+65535,_=Math.floor(c/65536),z=c-_*65536,c=te+_+65535,_=Math.floor(c/65536),te=c-_*65536,c=re+_+65535,_=Math.floor(c/65536),re=c-_*65536,c=ne+_+65535,_=Math.floor(c/65536),ne=c-_*65536,c=ge+_+65535,_=Math.floor(c/65536),ge=c-_*65536,Z+=_-1+37*(_-1),_=1,c=Z+_+65535,_=Math.floor(c/65536),Z=c-_*65536,c=u+_+65535,_=Math.floor(c/65536),u=c-_*65536,c=f+_+65535,_=Math.floor(c/65536),f=c-_*65536,c=d+_+65535,_=Math.floor(c/65536),d=c-_*65536,c=E+_+65535,_=Math.floor(c/65536),E=c-_*65536,c=y+_+65535,_=Math.floor(c/65536),y=c-_*65536,c=p+_+65535,_=Math.floor(c/65536),p=c-_*65536,c=D+_+65535,_=Math.floor(c/65536),D=c-_*65536,c=L+_+65535,_=Math.floor(c/65536),L=c-_*65536,c=W+_+65535,_=Math.floor(c/65536),W=c-_*65536,c=A+_+65535,_=Math.floor(c/65536),A=c-_*65536,c=z+_+65535,_=Math.floor(c/65536),z=c-_*65536,c=te+_+65535,_=Math.floor(c/65536),te=c-_*65536,c=re+_+65535,_=Math.floor(c/65536),re=c-_*65536,c=ne+_+65535,_=Math.floor(c/65536),ne=c-_*65536,c=ge+_+65535,_=Math.floor(c/65536),ge=c-_*65536,Z+=_-1+37*(_-1),O[0]=Z,O[1]=u,O[2]=f,O[3]=d,O[4]=E,O[5]=y,O[6]=p,O[7]=D,O[8]=L,O[9]=W,O[10]=A,O[11]=z,O[12]=te,O[13]=re,O[14]=ne,O[15]=ge}function q(O,T){K(O,T,T)}function H(O,T){const b=s();for(let c=0;c<16;c++)b[c]=T[c];for(let c=253;c>=0;c--)q(b,b),c!==2&&c!==4&&K(b,b,T);for(let c=0;c<16;c++)O[c]=b[c]}function Q(O,T){const b=new Uint8Array(32),c=new Float64Array(80),_=s(),Z=s(),u=s(),f=s(),d=s(),E=s();for(let L=0;L<31;L++)b[L]=O[L];b[31]=O[31]&127|64,b[0]&=248,U(c,T);for(let L=0;L<16;L++)Z[L]=c[L];_[0]=f[0]=1;for(let L=254;L>=0;--L){const W=b[L>>>3]>>>(L&7)&1;v(_,Z,W),v(u,f,W),R(d,_,u),F(_,_,u),R(u,Z,f),F(Z,Z,f),q(f,d),q(E,_),K(_,u,_),K(u,Z,d),R(d,_,u),F(_,_,u),q(Z,_),F(u,f,E),K(_,u,g),R(_,_,f),K(u,u,_),K(_,f,E),K(f,Z,c),q(Z,d),v(_,Z,W),v(u,f,W)}for(let L=0;L<16;L++)c[L+16]=_[L],c[L+32]=u[L],c[L+48]=Z[L],c[L+64]=f[L];const y=c.subarray(32),p=c.subarray(16);H(y,y),K(p,p,y);const D=new Uint8Array(32);return S(D,p),D}i.scalarMult=Q;function J(O){return Q(O,o)}i.scalarMultBase=J;function ce(O){if(O.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const T=new Uint8Array(O);return{publicKey:J(T),secretKey:T}}i.generateKeyPairFromSeed=ce;function x(O){const T=(0,t.randomBytes)(32,O),b=ce(T);return(0,r.wipe)(T),b}i.generateKeyPair=x;function C(O,T,b=!1){if(O.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(T.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=Q(O,T);if(b){let _=0;for(let Z=0;Z<c.length;Z++)_|=c[Z];if(_===0)throw new Error("X25519: invalid shared key")}return c}i.sharedKey=C})(_u);var zd=i=>encodeURIComponent(i).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),Bd="%[a-f0-9]{2}",ff=new RegExp("("+Bd+")|([^%]+?)","gi"),df=new RegExp("("+Bd+")+","gi");function Yc(i,t){try{return[decodeURIComponent(i.join(""))]}catch{}if(i.length===1)return i;t=t||1;var r=i.slice(0,t),s=i.slice(t);return Array.prototype.concat.call([],Yc(r),Yc(s))}function Qb(i){try{return decodeURIComponent(i)}catch{for(var t=i.match(ff)||[],r=1;r<t.length;r++)i=Yc(t,r).join(""),t=i.match(ff)||[];return i}}function ew(i){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=df.exec(i);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var s=Qb(r[0]);s!==r[0]&&(t[r[0]]=s)}r=df.exec(i)}t["%C2"]="�";for(var o=Object.keys(t),g=0;g<o.length;g++){var w=o[g];i=i.replace(new RegExp(w,"g"),t[w])}return i}var Kd=function(i){if(typeof i!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof i+"`");try{return i=i.replace(/\+/g," "),decodeURIComponent(i)}catch{return ew(i)}},Vd=(i,t)=>{if(!(typeof i=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[i];const r=i.indexOf(t);return r===-1?[i]:[i.slice(0,r),i.slice(r+t.length)]},Gd=function(i,t){for(var r={},s=Object.keys(i),o=Array.isArray(t),g=0;g<s.length;g++){var w=s[g],v=i[w];(o?t.indexOf(w)!==-1:t(w,v,i))&&(r[w]=v)}return r};const tw={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},rw="PARSE_ERROR",nw="INVALID_REQUEST",iw="METHOD_NOT_FOUND",sw="INVALID_PARAMS",kd="INTERNAL_ERROR",yu="SERVER_ERROR",aw=[-32700,-32600,-32601,-32602,-32603],ds={[rw]:{code:-32700,message:"Parse error"},[nw]:{code:-32600,message:"Invalid Request"},[iw]:{code:-32601,message:"Method not found"},[sw]:{code:-32602,message:"Invalid params"},[kd]:{code:-32603,message:"Internal error"},[yu]:{code:-32e3,message:"Server error"}},Wd=yu;function ow(i){return aw.includes(i)}function pf(i){return Object.keys(ds).includes(i)?ds[i]:ds[Wd]}function cw(i){const t=Object.values(ds).find(r=>r.code===i);return t||ds[Wd]}function Yd(i,t,r){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):i}var Jd={},Xd={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(i){var t,r,s,o,g,w,v,S,U,R,F,K,q,H,Q,J,ce,x,C,O,T,b,c;(function(_){var Z=typeof Et=="object"?Et:typeof self=="object"?self:typeof this=="object"?this:{};_(u(Z,u(i.exports)));function u(f,d){return f!==Z&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(E,y){return f[E]=d?d(E,y):y}}})(function(_){var Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var d in f)f.hasOwnProperty(d)&&(u[d]=f[d])};t=function(u,f){Z(u,f);function d(){this.constructor=u}u.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(u){for(var f,d=1,E=arguments.length;d<E;d++){f=arguments[d];for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(u[y]=f[y])}return u},s=function(u,f){var d={};for(var E in u)Object.prototype.hasOwnProperty.call(u,E)&&f.indexOf(E)<0&&(d[E]=u[E]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,E=Object.getOwnPropertySymbols(u);y<E.length;y++)f.indexOf(E[y])<0&&Object.prototype.propertyIsEnumerable.call(u,E[y])&&(d[E[y]]=u[E[y]]);return d},o=function(u,f,d,E){var y=arguments.length,p=y<3?f:E===null?E=Object.getOwnPropertyDescriptor(f,d):E,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(u,f,d,E);else for(var L=u.length-1;L>=0;L--)(D=u[L])&&(p=(y<3?D(p):y>3?D(f,d,p):D(f,d))||p);return y>3&&p&&Object.defineProperty(f,d,p),p},g=function(u,f){return function(d,E){f(d,E,u)}},w=function(u,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,f)},v=function(u,f,d,E){function y(p){return p instanceof d?p:new d(function(D){D(p)})}return new(d||(d=Promise))(function(p,D){function L(z){try{A(E.next(z))}catch(te){D(te)}}function W(z){try{A(E.throw(z))}catch(te){D(te)}}function A(z){z.done?p(z.value):y(z.value).then(L,W)}A((E=E.apply(u,f||[])).next())})},S=function(u,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},E,y,p,D;return D={next:L(0),throw:L(1),return:L(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function L(A){return function(z){return W([A,z])}}function W(A){if(E)throw new TypeError("Generator is already executing.");for(;d;)try{if(E=1,y&&(p=A[0]&2?y.return:A[0]?y.throw||((p=y.return)&&p.call(y),0):y.next)&&!(p=p.call(y,A[1])).done)return p;switch(y=0,p&&(A=[A[0]&2,p.value]),A[0]){case 0:case 1:p=A;break;case 4:return d.label++,{value:A[1],done:!1};case 5:d.label++,y=A[1],A=[0];continue;case 7:A=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(A[0]===6||A[0]===2)){d=0;continue}if(A[0]===3&&(!p||A[1]>p[0]&&A[1]<p[3])){d.label=A[1];break}if(A[0]===6&&d.label<p[1]){d.label=p[1],p=A;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(A);break}p[2]&&d.ops.pop(),d.trys.pop();continue}A=f.call(u,d)}catch(z){A=[6,z],y=0}finally{E=p=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},c=function(u,f,d,E){E===void 0&&(E=d),u[E]=f[d]},U=function(u,f){for(var d in u)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=u[d])},R=function(u){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&u[f],E=0;if(d)return d.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&E>=u.length&&(u=void 0),{value:u&&u[E++],done:!u}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},F=function(u,f){var d=typeof Symbol=="function"&&u[Symbol.iterator];if(!d)return u;var E=d.call(u),y,p=[],D;try{for(;(f===void 0||f-- >0)&&!(y=E.next()).done;)p.push(y.value)}catch(L){D={error:L}}finally{try{y&&!y.done&&(d=E.return)&&d.call(E)}finally{if(D)throw D.error}}return p},K=function(){for(var u=[],f=0;f<arguments.length;f++)u=u.concat(F(arguments[f]));return u},q=function(){for(var u=0,f=0,d=arguments.length;f<d;f++)u+=arguments[f].length;for(var E=Array(u),y=0,f=0;f<d;f++)for(var p=arguments[f],D=0,L=p.length;D<L;D++,y++)E[y]=p[D];return E},H=function(u){return this instanceof H?(this.v=u,this):new H(u)},Q=function(u,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var E=d.apply(u,f||[]),y,p=[];return y={},D("next"),D("throw"),D("return"),y[Symbol.asyncIterator]=function(){return this},y;function D(re){E[re]&&(y[re]=function(ne){return new Promise(function(ge,le){p.push([re,ne,ge,le])>1||L(re,ne)})})}function L(re,ne){try{W(E[re](ne))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(A,z):te(p[0][2],re)}function A(re){L("next",re)}function z(re){L("throw",re)}function te(re,ne){re(ne),p.shift(),p.length&&L(p[0][0],p[0][1])}},J=function(u){var f,d;return f={},E("next"),E("throw",function(y){throw y}),E("return"),f[Symbol.iterator]=function(){return this},f;function E(y,p){f[y]=u[y]?function(D){return(d=!d)?{value:H(u[y](D)),done:y==="return"}:p?p(D):D}:p}},ce=function(u){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=u[Symbol.asyncIterator],d;return f?f.call(u):(u=typeof R=="function"?R(u):u[Symbol.iterator](),d={},E("next"),E("throw"),E("return"),d[Symbol.asyncIterator]=function(){return this},d);function E(p){d[p]=u[p]&&function(D){return new Promise(function(L,W){D=u[p](D),y(L,W,D.done,D.value)})}}function y(p,D,L,W){Promise.resolve(W).then(function(A){p({value:A,done:L})},D)}},x=function(u,f){return Object.defineProperty?Object.defineProperty(u,"raw",{value:f}):u.raw=f,u},C=function(u){if(u&&u.__esModule)return u;var f={};if(u!=null)for(var d in u)Object.hasOwnProperty.call(u,d)&&(f[d]=u[d]);return f.default=u,f},O=function(u){return u&&u.__esModule?u:{default:u}},T=function(u,f){if(!f.has(u))throw new TypeError("attempted to get private field on non-instance");return f.get(u)},b=function(u,f,d){if(!f.has(u))throw new TypeError("attempted to set private field on non-instance");return f.set(u,d),d},_("__extends",t),_("__assign",r),_("__rest",s),_("__decorate",o),_("__param",g),_("__metadata",w),_("__awaiter",v),_("__generator",S),_("__exportStar",U),_("__createBinding",c),_("__values",R),_("__read",F),_("__spread",K),_("__spreadArrays",q),_("__await",H),_("__asyncGenerator",Q),_("__asyncDelegator",J),_("__asyncValues",ce),_("__makeTemplateObject",x),_("__importStar",C),_("__importDefault",O),_("__classPrivateFieldGet",T),_("__classPrivateFieldSet",b)})})(Xd);var uw=Xd.exports,gn={},gf;function hw(){if(gf)return gn;gf=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.isBrowserCryptoAvailable=gn.getSubtleCrypto=gn.getBrowerCrypto=void 0;function i(){return(Et===null||Et===void 0?void 0:Et.crypto)||(Et===null||Et===void 0?void 0:Et.msCrypto)||{}}gn.getBrowerCrypto=i;function t(){const s=i();return s.subtle||s.webkitSubtle}gn.getSubtleCrypto=t;function r(){return!!i()&&!!t()}return gn.isBrowserCryptoAvailable=r,gn}var _n={},_f;function lw(){if(_f)return _n;_f=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.isBrowser=_n.isNode=_n.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}_n.isReactNative=i;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}_n.isNode=t;function r(){return!i()&&!t()}return _n.isBrowser=r,_n}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=uw;t.__exportStar(hw(),i),t.__exportStar(lw(),i)})(Jd);function Zd(i=3){const t=Date.now()*Math.pow(10,i),r=Math.floor(Math.random()*Math.pow(10,i));return t+r}function vu(i=6){return BigInt(Zd(i))}function Va(i,t,r){return{id:r||Zd(),jsonrpc:"2.0",method:i,params:t}}function mu(i,t){return{id:i,jsonrpc:"2.0",result:t}}function Ga(i,t,r){return{id:i,jsonrpc:"2.0",error:fw(t,r)}}function fw(i,t){return typeof i>"u"?pf(kd):(typeof i=="string"&&(i=Object.assign(Object.assign({},pf(yu)),{message:i})),typeof t<"u"&&(i.data=t),ow(i.code)&&(i=cw(i.code)),i)}class dw{}class pw extends dw{constructor(){super()}}class gw extends pw{constructor(t){super()}}const _w="^https?:",yw="^wss?:";function vw(i){const t=i.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Qd(i,t){const r=vw(i);return typeof r>"u"?!1:new RegExp(t).test(r)}function yf(i){return Qd(i,_w)}function vf(i){return Qd(i,yw)}function mw(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function ep(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function bu(i){return ep(i)&&"method"in i}function ka(i){return ep(i)&&(yn(i)||Kr(i))}function yn(i){return"result"in i}function Kr(i){return"error"in i}class Rn extends gw{constructor(t){super(t),this.events=new Fr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Va(t.method,t.params||[],t.id||vu().toString()),r)}async requestStrict(t,r){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(g){o(g)}this.events.on(`${t.id}`,g=>{Kr(g)?o(g.error):s(g.result)});try{await this.connection.send(t,r)}catch(g){o(g)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),ka(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const mf=10,bw=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),ww=()=>typeof window<"u",Ew=bw();class Sw{constructor(t){if(this.url=t,this.events=new Fr.EventEmitter,this.registering=!1,!vf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ps(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!vf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",g=>{this.resetMaxListeners(),o(g)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const o=Jd.isReactNative()?void 0:{rejectUnauthorized:!mw(t)},g=new Ew(t,[],o);ww()?g.onerror=w=>{const v=w;s(this.emitError(v.error))}:g.on("error",w=>{s(this.emitError(w))}),g.onopen=()=>{this.onOpen(g),r(g)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?uu(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),g=Ga(t,o);this.events.emit("payload",g)}parseError(t,r=this.url){return Yd(t,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>mf&&this.events.setMaxListeners(mf)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Da={exports:{}};Da.exports;(function(i,t){var r=200,s="__lodash_hash_undefined__",o=1,g=2,w=9007199254740991,v="[object Arguments]",S="[object Array]",U="[object AsyncFunction]",R="[object Boolean]",F="[object Date]",K="[object Error]",q="[object Function]",H="[object GeneratorFunction]",Q="[object Map]",J="[object Number]",ce="[object Null]",x="[object Object]",C="[object Promise]",O="[object Proxy]",T="[object RegExp]",b="[object Set]",c="[object String]",_="[object Symbol]",Z="[object Undefined]",u="[object WeakMap]",f="[object ArrayBuffer]",d="[object DataView]",E="[object Float32Array]",y="[object Float64Array]",p="[object Int8Array]",D="[object Int16Array]",L="[object Int32Array]",W="[object Uint8Array]",A="[object Uint8ClampedArray]",z="[object Uint16Array]",te="[object Uint32Array]",re=/[\\^$.*+?()[\]{}|]/g,ne=/^\[object .+?Constructor\]$/,ge=/^(?:0|[1-9]\d*)$/,le={};le[E]=le[y]=le[p]=le[D]=le[L]=le[W]=le[A]=le[z]=le[te]=!0,le[v]=le[S]=le[f]=le[R]=le[d]=le[F]=le[K]=le[q]=le[Q]=le[J]=le[x]=le[T]=le[b]=le[c]=le[u]=!1;var be=typeof Et=="object"&&Et&&Et.Object===Object&&Et,X=typeof self=="object"&&self&&self.Object===Object&&self,Y=be||X||Function("return this")(),B=t&&!t.nodeType&&t,l=B&&!0&&i&&!i.nodeType&&i,$=l&&l.exports===B,he=$&&be.process,pe=function(){try{return he&&he.binding&&he.binding("util")}catch{}}(),Oe=pe&&pe.isTypedArray;function ze(N,V){for(var oe=-1,_e=N==null?0:N.length,ot=0,Ne=[];++oe<_e;){var dt=N[oe];V(dt,oe,N)&&(Ne[ot++]=dt)}return Ne}function Ve(N,V){for(var oe=-1,_e=V.length,ot=N.length;++oe<_e;)N[ot+oe]=V[oe];return N}function Fe(N,V){for(var oe=-1,_e=N==null?0:N.length;++oe<_e;)if(V(N[oe],oe,N))return!0;return!1}function gt(N,V){for(var oe=-1,_e=Array(N);++oe<N;)_e[oe]=V(oe);return _e}function _t(N){return function(V){return N(V)}}function Me(N,V){return N.has(V)}function Pe(N,V){return N==null?void 0:N[V]}function Ue(N){var V=-1,oe=Array(N.size);return N.forEach(function(_e,ot){oe[++V]=[ot,_e]}),oe}function De(N,V){return function(oe){return N(V(oe))}}function qe(N){var V=-1,oe=Array(N.size);return N.forEach(function(_e){oe[++V]=_e}),oe}var Te=Array.prototype,je=Function.prototype,Ie=Object.prototype,Ae=Y["__core-js_shared__"],Be=je.toString,xe=Ie.hasOwnProperty,Ge=function(){var N=/[^.]+$/.exec(Ae&&Ae.keys&&Ae.keys.IE_PROTO||"");return N?"Symbol(src)_1."+N:""}(),We=Ie.toString,et=RegExp("^"+Be.call(xe).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=$?Y.Buffer:void 0,Je=Y.Symbol,tr=Y.Uint8Array,hr=Ie.propertyIsEnumerable,Gr=Te.splice,rr=Je?Je.toStringTag:void 0,rn=Object.getOwnPropertySymbols,vn=tt?tt.isBuffer:void 0,Dn=De(Object.keys,Object),St=yr(Y,"DataView"),yt=yr(Y,"Map"),It=yr(Y,"Promise"),Ot=yr(Y,"Set"),bt=yr(Y,"WeakMap"),vt=yr(Object,"create"),$t=sn(St),Ft=sn(yt),Pt=sn(It),Lt=sn(Ot),xt=sn(bt),Nt=Je?Je.prototype:void 0,Tt=Nt?Nt.valueOf:void 0;function ht(N){var V=-1,oe=N==null?0:N.length;for(this.clear();++V<oe;){var _e=N[V];this.set(_e[0],_e[1])}}function Mt(){this.__data__=vt?vt(null):{},this.size=0}function qt(N){var V=this.has(N)&&delete this.__data__[N];return this.size-=V?1:0,V}function Ja(N){var V=this.__data__;if(vt){var oe=V[N];return oe===s?void 0:oe}return xe.call(V,N)?V[N]:void 0}function Xa(N){var V=this.__data__;return vt?V[N]!==void 0:xe.call(V,N)}function Za(N,V){var oe=this.__data__;return this.size+=this.has(N)?0:1,oe[N]=vt&&V===void 0?s:V,this}ht.prototype.clear=Mt,ht.prototype.delete=qt,ht.prototype.get=Ja,ht.prototype.has=Xa,ht.prototype.set=Za;function Ir(N){var V=-1,oe=N==null?0:N.length;for(this.clear();++V<oe;){var _e=N[V];this.set(_e[0],_e[1])}}function Qa(){this.__data__=[],this.size=0}function eo(N){var V=this.__data__,oe=jn(V,N);if(oe<0)return!1;var _e=V.length-1;return oe==_e?V.pop():Gr.call(V,oe,1),--this.size,!0}function to(N){var V=this.__data__,oe=jn(V,N);return oe<0?void 0:V[oe][1]}function ro(N){return jn(this.__data__,N)>-1}function no(N,V){var oe=this.__data__,_e=jn(oe,N);return _e<0?(++this.size,oe.push([N,V])):oe[_e][1]=V,this}Ir.prototype.clear=Qa,Ir.prototype.delete=eo,Ir.prototype.get=to,Ir.prototype.has=ro,Ir.prototype.set=no;function nn(N){var V=-1,oe=N==null?0:N.length;for(this.clear();++V<oe;){var _e=N[V];this.set(_e[0],_e[1])}}function si(){this.size=0,this.__data__={hash:new ht,map:new(yt||Ir),string:new ht}}function io(N){var V=mn(this,N).delete(N);return this.size-=V?1:0,V}function ai(N){return mn(this,N).get(N)}function so(N){return mn(this,N).has(N)}function ao(N,V){var oe=mn(this,N),_e=oe.size;return oe.set(N,V),this.size+=oe.size==_e?0:1,this}nn.prototype.clear=si,nn.prototype.delete=io,nn.prototype.get=ai,nn.prototype.has=so,nn.prototype.set=ao;function oi(N){var V=-1,oe=N==null?0:N.length;for(this.__data__=new nn;++V<oe;)this.add(N[V])}function ws(N){return this.__data__.set(N,s),this}function Es(N){return this.__data__.has(N)}oi.prototype.add=oi.prototype.push=ws,oi.prototype.has=Es;function Lr(N){var V=this.__data__=new Ir(N);this.size=V.size}function oo(){this.__data__=new Ir,this.size=0}function co(N){var V=this.__data__,oe=V.delete(N);return this.size=V.size,oe}function uo(N){return this.__data__.get(N)}function ho(N){return this.__data__.has(N)}function Ss(N,V){var oe=this.__data__;if(oe instanceof Ir){var _e=oe.__data__;if(!yt||_e.length<r-1)return _e.push([N,V]),this.size=++oe.size,this;oe=this.__data__=new nn(_e)}return oe.set(N,V),this.size=oe.size,this}Lr.prototype.clear=oo,Lr.prototype.delete=co,Lr.prototype.get=uo,Lr.prototype.has=ho,Lr.prototype.set=Ss;function Is(N,V){var oe=hi(N),_e=!oe&&$s(N),ot=!oe&&!_e&&Li(N),Ne=!oe&&!_e&&!ot&&Ms(N),dt=oe||_e||ot||Ne,Ht=dt?gt(N.length,String):[],Xe=Ht.length;for(var ct in N)(V||xe.call(N,ct))&&!(dt&&(ct=="length"||ot&&(ct=="offset"||ct=="parent")||Ne&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Ns(ct,Xe)))&&Ht.push(ct);return Ht}function jn(N,V){for(var oe=N.length;oe--;)if(js(N[oe][0],V))return oe;return-1}function $i(N,V,oe){var _e=V(N);return hi(N)?_e:Ve(_e,oe(N))}function $n(N){return N==null?N===void 0?Z:ce:rr&&rr in Object(N)?As(N):po(N)}function Fi(N){return Ln(N)&&$n(N)==v}function Fn(N,V,oe,_e,ot){return N===V?!0:N==null||V==null||!Ln(N)&&!Ln(V)?N!==N&&V!==V:Os(N,V,oe,_e,Fn,ot)}function Os(N,V,oe,_e,ot,Ne){var dt=hi(N),Ht=hi(V),Xe=dt?S:kr(N),ct=Ht?S:kr(V);Xe=Xe==v?x:Xe,ct=ct==v?x:ct;var Rt=Xe==x,lr=ct==x,zt=Xe==ct;if(zt&&Li(N)){if(!Li(V))return!1;dt=!0,Rt=!1}if(zt&&!Rt)return Ne||(Ne=new Lr),dt||Ms(N)?ci(N,V,oe,_e,ot,Ne):fo(N,V,Xe,oe,_e,ot,Ne);if(!(oe&o)){var pt=Rt&&xe.call(N,"__wrapped__"),nr=lr&&xe.call(V,"__wrapped__");if(pt||nr){var Mr=pt?N.value():N,Or=nr?V.value():V;return Ne||(Ne=new Lr),ot(Mr,Or,oe,_e,Ne)}}return zt?(Ne||(Ne=new Lr),Ts(N,V,oe,_e,ot,Ne)):!1}function lo(N){if(!Ls(N)||Us(N))return!1;var V=li(N)?et:ne;return V.test(sn(N))}function Ps(N){return Ln(N)&&Fs(N.length)&&!!le[$n(N)]}function xs(N){if(!Ds(N))return Dn(N);var V=[];for(var oe in Object(N))xe.call(N,oe)&&oe!="constructor"&&V.push(oe);return V}function ci(N,V,oe,_e,ot,Ne){var dt=oe&o,Ht=N.length,Xe=V.length;if(Ht!=Xe&&!(dt&&Xe>Ht))return!1;var ct=Ne.get(N);if(ct&&Ne.get(V))return ct==V;var Rt=-1,lr=!0,zt=oe&g?new oi:void 0;for(Ne.set(N,V),Ne.set(V,N);++Rt<Ht;){var pt=N[Rt],nr=V[Rt];if(_e)var Mr=dt?_e(nr,pt,Rt,V,N,Ne):_e(pt,nr,Rt,N,V,Ne);if(Mr!==void 0){if(Mr)continue;lr=!1;break}if(zt){if(!Fe(V,function(Or,Wr){if(!Me(zt,Wr)&&(pt===Or||ot(pt,Or,oe,_e,Ne)))return zt.push(Wr)})){lr=!1;break}}else if(!(pt===nr||ot(pt,nr,oe,_e,Ne))){lr=!1;break}}return Ne.delete(N),Ne.delete(V),lr}function fo(N,V,oe,_e,ot,Ne,dt){switch(oe){case d:if(N.byteLength!=V.byteLength||N.byteOffset!=V.byteOffset)return!1;N=N.buffer,V=V.buffer;case f:return!(N.byteLength!=V.byteLength||!Ne(new tr(N),new tr(V)));case R:case F:case J:return js(+N,+V);case K:return N.name==V.name&&N.message==V.message;case T:case c:return N==V+"";case Q:var Ht=Ue;case b:var Xe=_e&o;if(Ht||(Ht=qe),N.size!=V.size&&!Xe)return!1;var ct=dt.get(N);if(ct)return ct==V;_e|=g,dt.set(N,V);var Rt=ci(Ht(N),Ht(V),_e,ot,Ne,dt);return dt.delete(N),Rt;case _:if(Tt)return Tt.call(N)==Tt.call(V)}return!1}function Ts(N,V,oe,_e,ot,Ne){var dt=oe&o,Ht=ui(N),Xe=Ht.length,ct=ui(V),Rt=ct.length;if(Xe!=Rt&&!dt)return!1;for(var lr=Xe;lr--;){var zt=Ht[lr];if(!(dt?zt in V:xe.call(V,zt)))return!1}var pt=Ne.get(N);if(pt&&Ne.get(V))return pt==V;var nr=!0;Ne.set(N,V),Ne.set(V,N);for(var Mr=dt;++lr<Xe;){zt=Ht[lr];var Or=N[zt],Wr=V[zt];if(_e)var Mi=dt?_e(Wr,Or,zt,V,N,Ne):_e(Or,Wr,zt,N,V,Ne);if(!(Mi===void 0?Or===Wr||ot(Or,Wr,oe,_e,Ne):Mi)){nr=!1;break}Mr||(Mr=zt=="constructor")}if(nr&&!Mr){var Mn=N.constructor,kt=V.constructor;Mn!=kt&&"constructor"in N&&"constructor"in V&&!(typeof Mn=="function"&&Mn instanceof Mn&&typeof kt=="function"&&kt instanceof kt)&&(nr=!1)}return Ne.delete(N),Ne.delete(V),nr}function ui(N){return $i(N,yo,Cs)}function mn(N,V){var oe=N.__data__;return Rs(V)?oe[typeof V=="string"?"string":"hash"]:oe.map}function yr(N,V){var oe=Pe(N,V);return lo(oe)?oe:void 0}function As(N){var V=xe.call(N,rr),oe=N[rr];try{N[rr]=void 0;var _e=!0}catch{}var ot=We.call(N);return _e&&(V?N[rr]=oe:delete N[rr]),ot}var Cs=rn?function(N){return N==null?[]:(N=Object(N),ze(rn(N),function(V){return hr.call(N,V)}))}:at,kr=$n;(St&&kr(new St(new ArrayBuffer(1)))!=d||yt&&kr(new yt)!=Q||It&&kr(It.resolve())!=C||Ot&&kr(new Ot)!=b||bt&&kr(new bt)!=u)&&(kr=function(N){var V=$n(N),oe=V==x?N.constructor:void 0,_e=oe?sn(oe):"";if(_e)switch(_e){case $t:return d;case Ft:return Q;case Pt:return C;case Lt:return b;case xt:return u}return V});function Ns(N,V){return V=V??w,!!V&&(typeof N=="number"||ge.test(N))&&N>-1&&N%1==0&&N<V}function Rs(N){var V=typeof N;return V=="string"||V=="number"||V=="symbol"||V=="boolean"?N!=="__proto__":N===null}function Us(N){return!!Ge&&Ge in N}function Ds(N){var V=N&&N.constructor,oe=typeof V=="function"&&V.prototype||Ie;return N===oe}function po(N){return We.call(N)}function sn(N){if(N!=null){try{return Be.call(N)}catch{}try{return N+""}catch{}}return""}function js(N,V){return N===V||N!==N&&V!==V}var $s=Fi(function(){return arguments}())?Fi:function(N){return Ln(N)&&xe.call(N,"callee")&&!hr.call(N,"callee")},hi=Array.isArray;function go(N){return N!=null&&Fs(N.length)&&!li(N)}var Li=vn||st;function _o(N,V){return Fn(N,V)}function li(N){if(!Ls(N))return!1;var V=$n(N);return V==q||V==H||V==U||V==O}function Fs(N){return typeof N=="number"&&N>-1&&N%1==0&&N<=w}function Ls(N){var V=typeof N;return N!=null&&(V=="object"||V=="function")}function Ln(N){return N!=null&&typeof N=="object"}var Ms=Oe?_t(Oe):Ps;function yo(N){return go(N)?Is(N):xs(N)}function at(){return[]}function st(){return!1}i.exports=_o})(Da,Da.exports);var Iw=Da.exports;const Ow=bm(Iw);function Pw(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function xw(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Pw(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function tp(i,t,r,s){return{name:i,prefix:t,encoder:{name:i,prefix:t,encode:r},decoder:{decode:s}}}const bf=tp("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Nc=tp("ascii","a",i=>{let t="a";for(let r=0;r<i.length;r++)t+=String.fromCharCode(i[r]);return t},i=>{i=i.substring(1);const t=xw(i.length);for(let r=0;r<i.length;r++)t[r]=i.charCodeAt(r);return t});({hex:Ci.base16,...Ci});var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=lt.getLocation=lt.getLocationOrThrow=lt.getNavigator=lt.getNavigatorOrThrow=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function ti(i){let t;return typeof window<"u"&&typeof window[i]<"u"&&(t=window[i]),t}lt.getFromWindow=ti;function Ri(i){const t=ti(i);if(!t)throw new Error(`${i} is not defined in Window`);return t}lt.getFromWindowOrThrow=Ri;function Tw(){return Ri("document")}lt.getDocumentOrThrow=Tw;function Aw(){return ti("document")}lt.getDocument=Aw;function Cw(){return Ri("navigator")}lt.getNavigatorOrThrow=Cw;function Nw(){return ti("navigator")}lt.getNavigator=Nw;function Rw(){return Ri("location")}lt.getLocationOrThrow=Rw;function Uw(){return ti("location")}lt.getLocation=Uw;function Dw(){return Ri("crypto")}lt.getCryptoOrThrow=Dw;function jw(){return ti("crypto")}lt.getCrypto=jw;function $w(){return Ri("localStorage")}lt.getLocalStorageOrThrow=$w;function Fw(){return ti("localStorage")}lt.getLocalStorage=Fw;var wu={};Object.defineProperty(wu,"__esModule",{value:!0});wu.getWindowMetadata=void 0;const wf=lt;function Lw(){let i,t;try{i=wf.getDocumentOrThrow(),t=wf.getLocationOrThrow()}catch{return null}function r(){const F=i.getElementsByTagName("link"),K=[];for(let q=0;q<F.length;q++){const H=F[q],Q=H.getAttribute("rel");if(Q&&Q.toLowerCase().indexOf("icon")>-1){const J=H.getAttribute("href");if(J)if(J.toLowerCase().indexOf("https:")===-1&&J.toLowerCase().indexOf("http:")===-1&&J.indexOf("//")!==0){let ce=t.protocol+"//"+t.host;if(J.indexOf("/")===0)ce+=J;else{const x=t.pathname.split("/");x.pop();const C=x.join("/");ce+=C+"/"+J}K.push(ce)}else if(J.indexOf("//")===0){const ce=t.protocol+J;K.push(ce)}else K.push(J)}}return K}function s(...F){const K=i.getElementsByTagName("meta");for(let q=0;q<K.length;q++){const H=K[q],Q=["itemprop","property","name"].map(J=>H.getAttribute(J)).filter(J=>J?F.includes(J):!1);if(Q.length&&Q){const J=H.getAttribute("content");if(J)return J}}return""}function o(){let F=s("name","og:site_name","og:title","twitter:title");return F||(F=i.title),F}function g(){return s("description","og:description","twitter:description","keywords")}const w=o(),v=g(),S=t.origin,U=r();return{description:v,url:S,icons:U,name:w}}wu.getWindowMetadata=Lw;var Mw={};(function(i){const t=zd,r=Kd,s=Vd,o=Gd,g=x=>x==null,w=Symbol("encodeFragmentIdentifier");function v(x){switch(x.arrayFormat){case"index":return C=>(O,T)=>{const b=O.length;return T===void 0||x.skipNull&&T===null||x.skipEmptyString&&T===""?O:T===null?[...O,[R(C,x),"[",b,"]"].join("")]:[...O,[R(C,x),"[",R(b,x),"]=",R(T,x)].join("")]};case"bracket":return C=>(O,T)=>T===void 0||x.skipNull&&T===null||x.skipEmptyString&&T===""?O:T===null?[...O,[R(C,x),"[]"].join("")]:[...O,[R(C,x),"[]=",R(T,x)].join("")];case"colon-list-separator":return C=>(O,T)=>T===void 0||x.skipNull&&T===null||x.skipEmptyString&&T===""?O:T===null?[...O,[R(C,x),":list="].join("")]:[...O,[R(C,x),":list=",R(T,x)].join("")];case"comma":case"separator":case"bracket-separator":{const C=x.arrayFormat==="bracket-separator"?"[]=":"=";return O=>(T,b)=>b===void 0||x.skipNull&&b===null||x.skipEmptyString&&b===""?T:(b=b===null?"":b,T.length===0?[[R(O,x),C,R(b,x)].join("")]:[[T,R(b,x)].join(x.arrayFormatSeparator)])}default:return C=>(O,T)=>T===void 0||x.skipNull&&T===null||x.skipEmptyString&&T===""?O:T===null?[...O,R(C,x)]:[...O,[R(C,x),"=",R(T,x)].join("")]}}function S(x){let C;switch(x.arrayFormat){case"index":return(O,T,b)=>{if(C=/\[(\d*)\]$/.exec(O),O=O.replace(/\[\d*\]$/,""),!C){b[O]=T;return}b[O]===void 0&&(b[O]={}),b[O][C[1]]=T};case"bracket":return(O,T,b)=>{if(C=/(\[\])$/.exec(O),O=O.replace(/\[\]$/,""),!C){b[O]=T;return}if(b[O]===void 0){b[O]=[T];return}b[O]=[].concat(b[O],T)};case"colon-list-separator":return(O,T,b)=>{if(C=/(:list)$/.exec(O),O=O.replace(/:list$/,""),!C){b[O]=T;return}if(b[O]===void 0){b[O]=[T];return}b[O]=[].concat(b[O],T)};case"comma":case"separator":return(O,T,b)=>{const c=typeof T=="string"&&T.includes(x.arrayFormatSeparator),_=typeof T=="string"&&!c&&F(T,x).includes(x.arrayFormatSeparator);T=_?F(T,x):T;const Z=c||_?T.split(x.arrayFormatSeparator).map(u=>F(u,x)):T===null?T:F(T,x);b[O]=Z};case"bracket-separator":return(O,T,b)=>{const c=/(\[\])$/.test(O);if(O=O.replace(/\[\]$/,""),!c){b[O]=T&&F(T,x);return}const _=T===null?[]:T.split(x.arrayFormatSeparator).map(Z=>F(Z,x));if(b[O]===void 0){b[O]=_;return}b[O]=[].concat(b[O],_)};default:return(O,T,b)=>{if(b[O]===void 0){b[O]=T;return}b[O]=[].concat(b[O],T)}}}function U(x){if(typeof x!="string"||x.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function R(x,C){return C.encode?C.strict?t(x):encodeURIComponent(x):x}function F(x,C){return C.decode?r(x):x}function K(x){return Array.isArray(x)?x.sort():typeof x=="object"?K(Object.keys(x)).sort((C,O)=>Number(C)-Number(O)).map(C=>x[C]):x}function q(x){const C=x.indexOf("#");return C!==-1&&(x=x.slice(0,C)),x}function H(x){let C="";const O=x.indexOf("#");return O!==-1&&(C=x.slice(O)),C}function Q(x){x=q(x);const C=x.indexOf("?");return C===-1?"":x.slice(C+1)}function J(x,C){return C.parseNumbers&&!Number.isNaN(Number(x))&&typeof x=="string"&&x.trim()!==""?x=Number(x):C.parseBooleans&&x!==null&&(x.toLowerCase()==="true"||x.toLowerCase()==="false")&&(x=x.toLowerCase()==="true"),x}function ce(x,C){C=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},C),U(C.arrayFormatSeparator);const O=S(C),T=Object.create(null);if(typeof x!="string"||(x=x.trim().replace(/^[?#&]/,""),!x))return T;for(const b of x.split("&")){if(b==="")continue;let[c,_]=s(C.decode?b.replace(/\+/g," "):b,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(C.arrayFormat)?_:F(_,C),O(F(c,C),_,T)}for(const b of Object.keys(T)){const c=T[b];if(typeof c=="object"&&c!==null)for(const _ of Object.keys(c))c[_]=J(c[_],C);else T[b]=J(c,C)}return C.sort===!1?T:(C.sort===!0?Object.keys(T).sort():Object.keys(T).sort(C.sort)).reduce((b,c)=>{const _=T[c];return _&&typeof _=="object"&&!Array.isArray(_)?b[c]=K(_):b[c]=_,b},Object.create(null))}i.extract=Q,i.parse=ce,i.stringify=(x,C)=>{if(!x)return"";C=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},C),U(C.arrayFormatSeparator);const O=_=>C.skipNull&&g(x[_])||C.skipEmptyString&&x[_]==="",T=v(C),b={};for(const _ of Object.keys(x))O(_)||(b[_]=x[_]);const c=Object.keys(b);return C.sort!==!1&&c.sort(C.sort),c.map(_=>{const Z=x[_];return Z===void 0?"":Z===null?R(_,C):Array.isArray(Z)?Z.length===0&&C.arrayFormat==="bracket-separator"?R(_,C)+"[]":Z.reduce(T(_),[]).join("&"):R(_,C)+"="+R(Z,C)}).filter(_=>_.length>0).join("&")},i.parseUrl=(x,C)=>{C=Object.assign({decode:!0},C);const[O,T]=s(x,"#");return Object.assign({url:O.split("?")[0]||"",query:ce(Q(x),C)},C&&C.parseFragmentIdentifier&&T?{fragmentIdentifier:F(T,C)}:{})},i.stringifyUrl=(x,C)=>{C=Object.assign({encode:!0,strict:!0,[w]:!0},C);const O=q(x.url).split("?")[0]||"",T=i.extract(x.url),b=i.parse(T,{sort:!1}),c=Object.assign(b,x.query);let _=i.stringify(c,C);_&&(_=`?${_}`);let Z=H(x.url);return x.fragmentIdentifier&&(Z=`#${C[w]?R(x.fragmentIdentifier,C):x.fragmentIdentifier}`),`${O}${_}${Z}`},i.pick=(x,C,O)=>{O=Object.assign({parseFragmentIdentifier:!0,[w]:!1},O);const{url:T,query:b,fragmentIdentifier:c}=i.parseUrl(x,O);return i.stringifyUrl({url:T,query:o(b,C),fragmentIdentifier:c},O)},i.exclude=(x,C,O)=>{const T=Array.isArray(C)?b=>!C.includes(b):(b,c)=>!C(b,c);return i.pick(x,T,O)}})(Mw);function qw(i,t=[]){const r=[];return Object.keys(i).forEach(s=>{if(t.length&&!t.includes(s))return;const o=i[s];r.push(...o.accounts)}),r}const Hw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function zw(i,t){const{message:r,code:s}=Hw[i];return{message:t?`${r} ${t}`:r,code:s}}function Jc(i,t){return Array.isArray(i)?typeof t<"u"&&i.length?i.every(t):!0:!1}class Bw extends ei{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class Kw extends ei{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class Vw{constructor(t,r){this.logger=t,this.core=r}}let Gw=class extends ei{constructor(t,r){super(),this.relayer=t,this.logger=r}},kw=class extends ei{constructor(t){super()}},Ww=class{constructor(t,r,s,o){this.core=t,this.logger=r,this.name=s}};class Yw extends ei{constructor(t,r){super(),this.relayer=t,this.logger=r}}class Jw extends ei{constructor(t,r){super(),this.core=t,this.logger=r}}let Xw=class{constructor(t,r){this.projectId=t,this.logger=r}},Zw=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},Qw=class{constructor(t){this.client=t}};function Eu(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function rp(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Eu(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Ef(i,t){t||(t=i.reduce((o,g)=>o+g.length,0));const r=rp(t);let s=0;for(const o of i)r.set(o,s),s+=o.length;return Eu(r)}function np(i,t,r,s){return{name:i,prefix:t,encoder:{name:i,prefix:t,encode:r},decoder:{decode:s}}}const Sf=np("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Rc=np("ascii","a",i=>{let t="a";for(let r=0;r<i.length;r++)t+=String.fromCharCode(i[r]);return t},i=>{i=i.substring(1);const t=rp(i.length);for(let r=0;r<i.length;r++)t[r]=i.charCodeAt(r);return t}),ip={utf8:Sf,"utf-8":Sf,hex:Ci.base16,latin1:Rc,ascii:Rc,binary:Rc,...Ci};function Vr(i,t="utf8"){const r=ip[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Eu(globalThis.Buffer.from(i,"utf-8")):r.decoder.decode(`${r.prefix}${i}`)}function jr(i,t="utf8"){const r=ip[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):r.encoder.encode(i).substring(1)}var ft={};Object.defineProperty(ft,"__esModule",{value:!0});ft.getLocalStorage=ft.getLocalStorageOrThrow=ft.getCrypto=ft.getCryptoOrThrow=ap=ft.getLocation=ft.getLocationOrThrow=Su=ft.getNavigator=ft.getNavigatorOrThrow=sp=ft.getDocument=ft.getDocumentOrThrow=ft.getFromWindowOrThrow=ft.getFromWindow=void 0;function ri(i){let t;return typeof window<"u"&&typeof window[i]<"u"&&(t=window[i]),t}ft.getFromWindow=ri;function Ui(i){const t=ri(i);if(!t)throw new Error(`${i} is not defined in Window`);return t}ft.getFromWindowOrThrow=Ui;function eE(){return Ui("document")}ft.getDocumentOrThrow=eE;function tE(){return ri("document")}var sp=ft.getDocument=tE;function rE(){return Ui("navigator")}ft.getNavigatorOrThrow=rE;function nE(){return ri("navigator")}var Su=ft.getNavigator=nE;function iE(){return Ui("location")}ft.getLocationOrThrow=iE;function sE(){return ri("location")}var ap=ft.getLocation=sE;function aE(){return Ui("crypto")}ft.getCryptoOrThrow=aE;function oE(){return ri("crypto")}ft.getCrypto=oE;function cE(){return Ui("localStorage")}ft.getLocalStorageOrThrow=cE;function uE(){return ri("localStorage")}ft.getLocalStorage=uE;var Iu={};Object.defineProperty(Iu,"__esModule",{value:!0});var op=Iu.getWindowMetadata=void 0;const If=ft;function hE(){let i,t;try{i=If.getDocumentOrThrow(),t=If.getLocationOrThrow()}catch{return null}function r(){const F=i.getElementsByTagName("link"),K=[];for(let q=0;q<F.length;q++){const H=F[q],Q=H.getAttribute("rel");if(Q&&Q.toLowerCase().indexOf("icon")>-1){const J=H.getAttribute("href");if(J)if(J.toLowerCase().indexOf("https:")===-1&&J.toLowerCase().indexOf("http:")===-1&&J.indexOf("//")!==0){let ce=t.protocol+"//"+t.host;if(J.indexOf("/")===0)ce+=J;else{const x=t.pathname.split("/");x.pop();const C=x.join("/");ce+=C+"/"+J}K.push(ce)}else if(J.indexOf("//")===0){const ce=t.protocol+J;K.push(ce)}else K.push(J)}}return K}function s(...F){const K=i.getElementsByTagName("meta");for(let q=0;q<K.length;q++){const H=K[q],Q=["itemprop","property","name"].map(J=>H.getAttribute(J)).filter(J=>J?F.includes(J):!1);if(Q.length&&Q){const J=H.getAttribute("content");if(J)return J}}return""}function o(){let F=s("name","og:site_name","og:title","twitter:title");return F||(F=i.title),F}function g(){return s("description","og:description","twitter:description","keywords")}const w=o(),v=g(),S=t.origin,U=r();return{description:v,url:S,icons:U,name:w}}op=Iu.getWindowMetadata=hE;var gs={};(function(i){const t=zd,r=Kd,s=Vd,o=Gd,g=x=>x==null,w=Symbol("encodeFragmentIdentifier");function v(x){switch(x.arrayFormat){case"index":return C=>(O,T)=>{const b=O.length;return T===void 0||x.skipNull&&T===null||x.skipEmptyString&&T===""?O:T===null?[...O,[R(C,x),"[",b,"]"].join("")]:[...O,[R(C,x),"[",R(b,x),"]=",R(T,x)].join("")]};case"bracket":return C=>(O,T)=>T===void 0||x.skipNull&&T===null||x.skipEmptyString&&T===""?O:T===null?[...O,[R(C,x),"[]"].join("")]:[...O,[R(C,x),"[]=",R(T,x)].join("")];case"colon-list-separator":return C=>(O,T)=>T===void 0||x.skipNull&&T===null||x.skipEmptyString&&T===""?O:T===null?[...O,[R(C,x),":list="].join("")]:[...O,[R(C,x),":list=",R(T,x)].join("")];case"comma":case"separator":case"bracket-separator":{const C=x.arrayFormat==="bracket-separator"?"[]=":"=";return O=>(T,b)=>b===void 0||x.skipNull&&b===null||x.skipEmptyString&&b===""?T:(b=b===null?"":b,T.length===0?[[R(O,x),C,R(b,x)].join("")]:[[T,R(b,x)].join(x.arrayFormatSeparator)])}default:return C=>(O,T)=>T===void 0||x.skipNull&&T===null||x.skipEmptyString&&T===""?O:T===null?[...O,R(C,x)]:[...O,[R(C,x),"=",R(T,x)].join("")]}}function S(x){let C;switch(x.arrayFormat){case"index":return(O,T,b)=>{if(C=/\[(\d*)\]$/.exec(O),O=O.replace(/\[\d*\]$/,""),!C){b[O]=T;return}b[O]===void 0&&(b[O]={}),b[O][C[1]]=T};case"bracket":return(O,T,b)=>{if(C=/(\[\])$/.exec(O),O=O.replace(/\[\]$/,""),!C){b[O]=T;return}if(b[O]===void 0){b[O]=[T];return}b[O]=[].concat(b[O],T)};case"colon-list-separator":return(O,T,b)=>{if(C=/(:list)$/.exec(O),O=O.replace(/:list$/,""),!C){b[O]=T;return}if(b[O]===void 0){b[O]=[T];return}b[O]=[].concat(b[O],T)};case"comma":case"separator":return(O,T,b)=>{const c=typeof T=="string"&&T.includes(x.arrayFormatSeparator),_=typeof T=="string"&&!c&&F(T,x).includes(x.arrayFormatSeparator);T=_?F(T,x):T;const Z=c||_?T.split(x.arrayFormatSeparator).map(u=>F(u,x)):T===null?T:F(T,x);b[O]=Z};case"bracket-separator":return(O,T,b)=>{const c=/(\[\])$/.test(O);if(O=O.replace(/\[\]$/,""),!c){b[O]=T&&F(T,x);return}const _=T===null?[]:T.split(x.arrayFormatSeparator).map(Z=>F(Z,x));if(b[O]===void 0){b[O]=_;return}b[O]=[].concat(b[O],_)};default:return(O,T,b)=>{if(b[O]===void 0){b[O]=T;return}b[O]=[].concat(b[O],T)}}}function U(x){if(typeof x!="string"||x.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function R(x,C){return C.encode?C.strict?t(x):encodeURIComponent(x):x}function F(x,C){return C.decode?r(x):x}function K(x){return Array.isArray(x)?x.sort():typeof x=="object"?K(Object.keys(x)).sort((C,O)=>Number(C)-Number(O)).map(C=>x[C]):x}function q(x){const C=x.indexOf("#");return C!==-1&&(x=x.slice(0,C)),x}function H(x){let C="";const O=x.indexOf("#");return O!==-1&&(C=x.slice(O)),C}function Q(x){x=q(x);const C=x.indexOf("?");return C===-1?"":x.slice(C+1)}function J(x,C){return C.parseNumbers&&!Number.isNaN(Number(x))&&typeof x=="string"&&x.trim()!==""?x=Number(x):C.parseBooleans&&x!==null&&(x.toLowerCase()==="true"||x.toLowerCase()==="false")&&(x=x.toLowerCase()==="true"),x}function ce(x,C){C=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},C),U(C.arrayFormatSeparator);const O=S(C),T=Object.create(null);if(typeof x!="string"||(x=x.trim().replace(/^[?#&]/,""),!x))return T;for(const b of x.split("&")){if(b==="")continue;let[c,_]=s(C.decode?b.replace(/\+/g," "):b,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(C.arrayFormat)?_:F(_,C),O(F(c,C),_,T)}for(const b of Object.keys(T)){const c=T[b];if(typeof c=="object"&&c!==null)for(const _ of Object.keys(c))c[_]=J(c[_],C);else T[b]=J(c,C)}return C.sort===!1?T:(C.sort===!0?Object.keys(T).sort():Object.keys(T).sort(C.sort)).reduce((b,c)=>{const _=T[c];return _&&typeof _=="object"&&!Array.isArray(_)?b[c]=K(_):b[c]=_,b},Object.create(null))}i.extract=Q,i.parse=ce,i.stringify=(x,C)=>{if(!x)return"";C=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},C),U(C.arrayFormatSeparator);const O=_=>C.skipNull&&g(x[_])||C.skipEmptyString&&x[_]==="",T=v(C),b={};for(const _ of Object.keys(x))O(_)||(b[_]=x[_]);const c=Object.keys(b);return C.sort!==!1&&c.sort(C.sort),c.map(_=>{const Z=x[_];return Z===void 0?"":Z===null?R(_,C):Array.isArray(Z)?Z.length===0&&C.arrayFormat==="bracket-separator"?R(_,C)+"[]":Z.reduce(T(_),[]).join("&"):R(_,C)+"="+R(Z,C)}).filter(_=>_.length>0).join("&")},i.parseUrl=(x,C)=>{C=Object.assign({decode:!0},C);const[O,T]=s(x,"#");return Object.assign({url:O.split("?")[0]||"",query:ce(Q(x),C)},C&&C.parseFragmentIdentifier&&T?{fragmentIdentifier:F(T,C)}:{})},i.stringifyUrl=(x,C)=>{C=Object.assign({encode:!0,strict:!0,[w]:!0},C);const O=q(x.url).split("?")[0]||"",T=i.extract(x.url),b=i.parse(T,{sort:!1}),c=Object.assign(b,x.query);let _=i.stringify(c,C);_&&(_=`?${_}`);let Z=H(x.url);return x.fragmentIdentifier&&(Z=`#${C[w]?R(x.fragmentIdentifier,C):x.fragmentIdentifier}`),`${O}${_}${Z}`},i.pick=(x,C,O)=>{O=Object.assign({parseFragmentIdentifier:!0,[w]:!1},O);const{url:T,query:b,fragmentIdentifier:c}=i.parseUrl(x,O);return i.stringifyUrl({url:T,query:o(b,C),fragmentIdentifier:c},O)},i.exclude=(x,C,O)=>{const T=Array.isArray(C)?b=>!C.includes(b):(b,c)=>!C(b,c);return i.pick(x,T,O)}})(gs);function cp(i,t){return i.includes(":")?[i]:t.chains||[]}const up="base10",ur="base16",Xc="base64pad",Ou="utf8",hp=0,ni=1,lE=0,Of=1,Zc=12,Pu=32;function fE(){const i=_u.generateKeyPair();return{privateKey:jr(i.secretKey,ur),publicKey:jr(i.publicKey,ur)}}function Qc(){const i=Ni.randomBytes(Pu);return jr(i,ur)}function dE(i,t){const r=_u.sharedKey(Vr(i,ur),Vr(t,ur)),s=new Zb(Ka.SHA256,r).expand(Pu);return jr(s,ur)}function pE(i){const t=Ka.hash(Vr(i,ur));return jr(t,ur)}function Ti(i){const t=Ka.hash(Vr(i,Ou));return jr(t,ur)}function gE(i){return Vr(`${i}`,up)}function ms(i){return Number(jr(i,up))}function _E(i){const t=gE(typeof i.type<"u"?i.type:hp);if(ms(t)===ni&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof i.senderPublicKey<"u"?Vr(i.senderPublicKey,ur):void 0,s=typeof i.iv<"u"?Vr(i.iv,ur):Ni.randomBytes(Zc),o=new pu.ChaCha20Poly1305(Vr(i.symKey,ur)).seal(s,Vr(i.message,Ou));return vE({type:t,sealed:o,iv:s,senderPublicKey:r})}function yE(i){const t=new pu.ChaCha20Poly1305(Vr(i.symKey,ur)),{sealed:r,iv:s}=ja(i.encoded),o=t.open(s,r);if(o===null)throw new Error("Failed to decrypt");return jr(o,Ou)}function vE(i){if(ms(i.type)===ni){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return jr(Ef([i.type,i.senderPublicKey,i.iv,i.sealed]),Xc)}return jr(Ef([i.type,i.iv,i.sealed]),Xc)}function ja(i){const t=Vr(i,Xc),r=t.slice(lE,Of),s=Of;if(ms(r)===ni){const v=s+Pu,S=v+Zc,U=t.slice(s,v),R=t.slice(v,S),F=t.slice(S);return{type:r,sealed:F,iv:R,senderPublicKey:U}}const o=s+Zc,g=t.slice(s,o),w=t.slice(o);return{type:r,sealed:w,iv:g}}function mE(i,t){const r=ja(i);return lp({type:ms(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?jr(r.senderPublicKey,ur):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function lp(i){const t=(i==null?void 0:i.type)||hp;if(t===ni){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function Pf(i){return i.type===ni&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var bE=Object.defineProperty,xf=Object.getOwnPropertySymbols,wE=Object.prototype.hasOwnProperty,EE=Object.prototype.propertyIsEnumerable,Tf=(i,t,r)=>t in i?bE(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,Af=(i,t)=>{for(var r in t||(t={}))wE.call(t,r)&&Tf(i,r,t[r]);if(xf)for(var r of xf(t))EE.call(t,r)&&Tf(i,r,t[r]);return i};const SE="ReactNative",Zn={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},IE="js";function xu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function fp(){return!sp()&&!!Su()&&navigator.product===SE}function Tu(){return!xu()&&!!Su()}function dp(){return fp()?Zn.reactNative:xu()?Zn.node:Tu()?Zn.browser:Zn.unknown}function OE(i,t){let r=gs.parse(i);return r=Af(Af({},r),t),i=gs.stringify(r),i}function PE(){return op()||{name:"",description:"",url:"",icons:[""]}}function xE(){if(typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const i=wm();if(i===null)return"unknown";const t=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[t,i.name,i.version].join("-"):[t,i.version].join("-")}function TE(){var i;const t=dp();return t===Zn.browser?[t,((i=ap())==null?void 0:i.host)||"unknown"].join(":"):t}function AE(i,t,r){const s=xE(),o=TE();return[[i,t].join("-"),[IE,r].join("-"),s,o].join("/")}function CE({protocol:i,version:t,relayUrl:r,sdkVersion:s,auth:o,projectId:g,useOnCloseEvent:w}){const v=r.split("?"),S=AE(i,t,s),U={auth:o,ua:S,projectId:g,useOnCloseEvent:w||void 0},R=OE(v[1]||"",U);return v[0]+"?"+R}function Qn(i,t){return i.filter(r=>t.includes(r)).length===i.length}function pp(i){return Object.fromEntries(i.entries())}function gp(i){return new Map(Object.entries(i))}function xi(i=me.FIVE_MINUTES,t){const r=me.toMiliseconds(i||me.FIVE_MINUTES);let s,o,g;return{resolve:w=>{g&&s&&(clearTimeout(g),s(w))},reject:w=>{g&&o&&(clearTimeout(g),o(w))},done:()=>new Promise((w,v)=>{g=setTimeout(()=>{v(new Error(t))},r),s=w,o=v})}}function $a(i,t,r){return new Promise(async(s,o)=>{const g=setTimeout(()=>o(new Error(r)),t);try{const w=await i;s(w)}catch(w){o(w)}clearTimeout(g)})}function _p(i,t){if(typeof t=="string"&&t.startsWith(`${i}:`))return t;if(i.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(i.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${i}`)}function NE(i){return _p("topic",i)}function RE(i){return _p("id",i)}function yp(i){const[t,r]=i.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function tn(i,t){return me.fromMiliseconds((t||Date.now())+me.toMiliseconds(i))}function An(i){return Date.now()>=me.toMiliseconds(i)}function Bt(i,t){return`${i}${t?`:${t}`:""}`}function Uc(i=[],t=[]){return[...new Set([...i,...t])]}async function UE({id:i,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const g=`${o}/wc?requestId=${i}&sessionTopic=${t}`,w=dp();w===Zn.browser?window.open(g,"_self","noreferrer noopener"):w===Zn.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(g)}catch(s){console.error(s)}}const DE="irn";function eu(i){return(i==null?void 0:i.relay)||{protocol:DE}}function Ta(i){const t=tw[i];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${i}`);return t}var jE=Object.defineProperty,Cf=Object.getOwnPropertySymbols,$E=Object.prototype.hasOwnProperty,FE=Object.prototype.propertyIsEnumerable,Nf=(i,t,r)=>t in i?jE(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,LE=(i,t)=>{for(var r in t||(t={}))$E.call(t,r)&&Nf(i,r,t[r]);if(Cf)for(var r of Cf(t))FE.call(t,r)&&Nf(i,r,t[r]);return i};function ME(i,t="-"){const r={},s="relay"+t;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const g=o.replace(s,""),w=i[o];r[g]=w}}),r}function qE(i){const t=i.indexOf(":"),r=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,t),o=i.substring(t+1,r).split("@"),g=typeof r<"u"?i.substring(r):"",w=gs.parse(g);return{protocol:s,topic:HE(o[0]),version:parseInt(o[1],10),symKey:w.symKey,relay:ME(w)}}function HE(i){return i.startsWith("//")?i.substring(2):i}function zE(i,t="-"){const r="relay",s={};return Object.keys(i).forEach(o=>{const g=r+t+o;i[o]&&(s[g]=i[o])}),s}function BE(i){return`${i.protocol}:${i.topic}@${i.version}?`+gs.stringify(LE({symKey:i.symKey},zE(i.relay)))}function Di(i){const t=[];return i.forEach(r=>{const[s,o]=r.split(":");t.push(`${s}:${o}`)}),t}function KE(i){const t=[];return Object.values(i).forEach(r=>{t.push(...Di(r.accounts))}),t}function VE(i,t){const r=[];return Object.values(i).forEach(s=>{Di(s.accounts).includes(t)&&r.push(...s.methods)}),r}function GE(i,t){const r=[];return Object.values(i).forEach(s=>{Di(s.accounts).includes(t)&&r.push(...s.events)}),r}function kE(i,t){const r=Ca(i,t);if(r)throw new Error(r.message);const s={};for(const[o,g]of Object.entries(i))s[o]={methods:g.methods,events:g.events,chains:g.accounts.map(w=>`${w.split(":")[0]}:${w.split(":")[1]}`)};return s}function vp(i){return i.includes(":")}function Aa(i){return vp(i)?i.split(":")[0]:i}const WE={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},YE={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function de(i,t){const{message:r,code:s}=YE[i];return{message:t?`${r} ${t}`:r,code:s}}function Kt(i,t){const{message:r,code:s}=WE[i];return{message:t?`${r} ${t}`:r,code:s}}function ji(i,t){return Array.isArray(i)?typeof t<"u"&&i.length?i.every(t):!0:!1}function Ai(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function cr(i){return typeof i>"u"}function Yt(i,t){return t&&cr(i)?!0:typeof i=="string"&&!!i.trim().length}function Au(i,t){return t&&cr(i)?!0:typeof i=="number"&&!isNaN(i)}function JE(i,t){const{requiredNamespaces:r}=t,s=Object.keys(i.namespaces),o=Object.keys(r);let g=!0;return Qn(o,s)?(s.forEach(w=>{const{accounts:v,methods:S,events:U}=i.namespaces[w],R=Di(v),F=r[w];(!Qn(cp(w,F),R)||!Qn(F.methods,S)||!Qn(F.events,U))&&(g=!1)}),g):!1}function Cu(i){return Yt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function XE(i){if(Yt(i,!1)&&i.includes(":")){const t=i.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Cu(r)}}return!1}function ZE(i){if(Yt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function QE(i){var t;return(t=i==null?void 0:i.proposer)==null?void 0:t.publicKey}function e6(i){return i==null?void 0:i.topic}function t6(i,t){let r=null;return Yt(i==null?void 0:i.publicKey,!1)||(r=de("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Rf(i){let t=!0;return ji(i)?i.length&&(t=i.every(r=>Yt(r,!1))):t=!1,t}function r6(i,t,r){let s=null;return ji(t)?t.forEach(o=>{s||(!Cu(o)||!o.includes(i))&&(s=Kt("UNSUPPORTED_CHAINS",`${r}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):s=Kt("UNSUPPORTED_CHAINS",`${r}, chains ${t} should be an array of strings conforming to "namespace:chainId" format`),s}function n6(i,t){let r=null;return Object.entries(i).forEach(([s,o])=>{if(r)return;const g=r6(s,cp(s,o),`${t} requiredNamespace`);g&&(r=g)}),r}function i6(i,t){let r=null;return ji(i)?i.forEach(s=>{r||XE(s)||(r=Kt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=Kt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function s6(i,t){let r=null;return Object.values(i).forEach(s=>{if(r)return;const o=i6(s==null?void 0:s.accounts,`${t} namespace`);o&&(r=o)}),r}function a6(i,t){let r=null;return Rf(i==null?void 0:i.methods)?Rf(i==null?void 0:i.events)||(r=Kt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Kt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function mp(i,t){let r=null;return Object.values(i).forEach(s=>{if(r)return;const o=a6(s,`${t}, namespace`);o&&(r=o)}),r}function o6(i,t,r){let s=null;if(i&&Ai(i)){const o=mp(i,t);o&&(s=o);const g=n6(i,t);g&&(s=g)}else s=de("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Ca(i,t){let r=null;if(i&&Ai(i)){const s=mp(i,t);s&&(r=s);const o=s6(i,t);o&&(r=o)}else r=de("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function bp(i){return Yt(i.protocol,!0)}function c6(i,t){let r=!1;return t&&!i?r=!0:i&&ji(i)&&i.length&&i.forEach(s=>{r=bp(s)}),r}function u6(i){return typeof i=="number"}function _r(i){return typeof i<"u"&&typeof i!==null}function h6(i){return!(!i||typeof i!="object"||!i.code||!Au(i.code,!1)||!i.message||!Yt(i.message,!1))}function l6(i){return!(cr(i)||!Yt(i.method,!1))}function f6(i){return!(cr(i)||cr(i.result)&&cr(i.error)||!Au(i.id,!1)||!Yt(i.jsonrpc,!1))}function d6(i){return!(cr(i)||!Yt(i.name,!1))}function Uf(i,t){return!(!Cu(t)||!KE(i).includes(t))}function p6(i,t,r){return Yt(r,!1)?VE(i,t).includes(r):!1}function g6(i,t,r){return Yt(r,!1)?GE(i,t).includes(r):!1}function Df(i,t,r){let s=null;const o=_6(i),g=y6(t),w=Object.keys(o),v=Object.keys(g),S=jf(Object.keys(i)),U=jf(Object.keys(t)),R=S.filter(F=>!U.includes(F));return R.length&&(s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${R.toString()}
      Received: ${Object.keys(t).toString()}`)),Qn(w,v)||(s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${w.toString()}
      Approved: ${v.toString()}`)),Object.keys(t).forEach(F=>{if(!F.includes(":")||s)return;const K=Di(t[F].accounts);K.includes(F)||(s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${F}
        Required: ${F}
        Approved: ${K.toString()}`))}),w.forEach(F=>{s||(Qn(o[F].methods,g[F].methods)?Qn(o[F].events,g[F].events)||(s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${F}`)):s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${F}`))}),s}function _6(i){const t={};return Object.keys(i).forEach(r=>{var s;r.includes(":")?t[r]=i[r]:(s=i[r].chains)==null||s.forEach(o=>{t[o]={methods:i[r].methods,events:i[r].events}})}),t}function jf(i){return[...new Set(i.map(t=>t.includes(":")?t.split(":")[0]:t))]}function y6(i){const t={};return Object.keys(i).forEach(r=>{if(r.includes(":"))t[r]=i[r];else{const s=Di(i[r].accounts);s==null||s.forEach(o=>{t[o]={accounts:i[r].accounts.filter(g=>g.includes(`${o}:`)),methods:i[r].methods,events:i[r].events}})}}),t}function v6(i,t){return Au(i,!1)&&i<=t.max&&i>=t.min}function m6(i,t){if(i.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<i.length;o++){var g=i.charAt(o),w=g.charCodeAt(0);if(r[w]!==255)throw new TypeError(g+" is ambiguous");r[w]=o}var v=i.length,S=i.charAt(0),U=Math.log(v)/Math.log(256),R=Math.log(256)/Math.log(v);function F(H){if(H instanceof Uint8Array||(ArrayBuffer.isView(H)?H=new Uint8Array(H.buffer,H.byteOffset,H.byteLength):Array.isArray(H)&&(H=Uint8Array.from(H))),!(H instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(H.length===0)return"";for(var Q=0,J=0,ce=0,x=H.length;ce!==x&&H[ce]===0;)ce++,Q++;for(var C=(x-ce)*R+1>>>0,O=new Uint8Array(C);ce!==x;){for(var T=H[ce],b=0,c=C-1;(T!==0||b<J)&&c!==-1;c--,b++)T+=256*O[c]>>>0,O[c]=T%v>>>0,T=T/v>>>0;if(T!==0)throw new Error("Non-zero carry");J=b,ce++}for(var _=C-J;_!==C&&O[_]===0;)_++;for(var Z=S.repeat(Q);_<C;++_)Z+=i.charAt(O[_]);return Z}function K(H){if(typeof H!="string")throw new TypeError("Expected String");if(H.length===0)return new Uint8Array;var Q=0;if(H[Q]!==" "){for(var J=0,ce=0;H[Q]===S;)J++,Q++;for(var x=(H.length-Q)*U+1>>>0,C=new Uint8Array(x);H[Q];){var O=r[H.charCodeAt(Q)];if(O===255)return;for(var T=0,b=x-1;(O!==0||T<ce)&&b!==-1;b--,T++)O+=v*C[b]>>>0,C[b]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");ce=T,Q++}if(H[Q]!==" "){for(var c=x-ce;c!==x&&C[c]===0;)c++;for(var _=new Uint8Array(J+(x-c)),Z=J;c!==x;)_[Z++]=C[c++];return _}}}function q(H){var Q=K(H);if(Q)return Q;throw new Error(`Non-${t} character`)}return{encode:F,decodeUnsafe:K,decode:q}}var b6=m6,w6=b6;const wp=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},E6=i=>new TextEncoder().encode(i),S6=i=>new TextDecoder().decode(i);class I6{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class O6{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Ep(this,t)}}class P6{constructor(t){this.decoders=t}or(t){return Ep(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ep=(i,t)=>new P6({...i.decoders||{[i.prefix]:i},...t.decoders||{[t.prefix]:t}});class x6{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new I6(t,r,s),this.decoder=new O6(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Wa=({name:i,prefix:t,encode:r,decode:s})=>new x6(i,t,r,s),bs=({prefix:i,name:t,alphabet:r})=>{const{encode:s,decode:o}=w6(r,t);return Wa({prefix:i,name:t,encode:s,decode:g=>wp(o(g))})},T6=(i,t,r,s)=>{const o={};for(let R=0;R<t.length;++R)o[t[R]]=R;let g=i.length;for(;i[g-1]==="=";)--g;const w=new Uint8Array(g*r/8|0);let v=0,S=0,U=0;for(let R=0;R<g;++R){const F=o[i[R]];if(F===void 0)throw new SyntaxError(`Non-${s} character`);S=S<<r|F,v+=r,v>=8&&(v-=8,w[U++]=255&S>>v)}if(v>=r||255&S<<8-v)throw new SyntaxError("Unexpected end of data");return w},A6=(i,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let g="",w=0,v=0;for(let S=0;S<i.length;++S)for(v=v<<8|i[S],w+=8;w>r;)w-=r,g+=t[o&v>>w];if(w&&(g+=t[o&v<<r-w]),s)for(;g.length*r&7;)g+="=";return g},Xt=({name:i,prefix:t,bitsPerChar:r,alphabet:s})=>Wa({prefix:t,name:i,encode(o){return A6(o,s,r)},decode(o){return T6(o,s,r,i)}}),C6=Wa({prefix:"\0",name:"identity",encode:i=>S6(i),decode:i=>E6(i)});var N6=Object.freeze({__proto__:null,identity:C6});const R6=Xt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var U6=Object.freeze({__proto__:null,base2:R6});const D6=Xt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var j6=Object.freeze({__proto__:null,base8:D6});const $6=bs({prefix:"9",name:"base10",alphabet:"0123456789"});var F6=Object.freeze({__proto__:null,base10:$6});const L6=Xt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),M6=Xt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var q6=Object.freeze({__proto__:null,base16:L6,base16upper:M6});const H6=Xt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),z6=Xt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),B6=Xt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),K6=Xt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),V6=Xt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),G6=Xt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),k6=Xt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),W6=Xt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Y6=Xt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var J6=Object.freeze({__proto__:null,base32:H6,base32upper:z6,base32pad:B6,base32padupper:K6,base32hex:V6,base32hexupper:G6,base32hexpad:k6,base32hexpadupper:W6,base32z:Y6});const X6=bs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Z6=bs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Q6=Object.freeze({__proto__:null,base36:X6,base36upper:Z6});const eS=bs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),tS=bs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var rS=Object.freeze({__proto__:null,base58btc:eS,base58flickr:tS});const nS=Xt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),iS=Xt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),sS=Xt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),aS=Xt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var oS=Object.freeze({__proto__:null,base64:nS,base64pad:iS,base64url:sS,base64urlpad:aS});const Sp=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),cS=Sp.reduce((i,t,r)=>(i[r]=t,i),[]),uS=Sp.reduce((i,t,r)=>(i[t.codePointAt(0)]=r,i),[]);function hS(i){return i.reduce((t,r)=>(t+=cS[r],t),"")}function lS(i){const t=[];for(const r of i){const s=uS[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const fS=Wa({prefix:"🚀",name:"base256emoji",encode:hS,decode:lS});var dS=Object.freeze({__proto__:null,base256emoji:fS}),pS=Ip,$f=128,gS=127,_S=~gS,yS=Math.pow(2,31);function Ip(i,t,r){t=t||[],r=r||0;for(var s=r;i>=yS;)t[r++]=i&255|$f,i/=128;for(;i&_S;)t[r++]=i&255|$f,i>>>=7;return t[r]=i|0,Ip.bytes=r-s+1,t}var vS=tu,mS=128,Ff=127;function tu(i,s){var r=0,s=s||0,o=0,g=s,w,v=i.length;do{if(g>=v)throw tu.bytes=0,new RangeError("Could not decode varint");w=i[g++],r+=o<28?(w&Ff)<<o:(w&Ff)*Math.pow(2,o),o+=7}while(w>=mS);return tu.bytes=g-s,r}var bS=Math.pow(2,7),wS=Math.pow(2,14),ES=Math.pow(2,21),SS=Math.pow(2,28),IS=Math.pow(2,35),OS=Math.pow(2,42),PS=Math.pow(2,49),xS=Math.pow(2,56),TS=Math.pow(2,63),AS=function(i){return i<bS?1:i<wS?2:i<ES?3:i<SS?4:i<IS?5:i<OS?6:i<PS?7:i<xS?8:i<TS?9:10},CS={encode:pS,decode:vS,encodingLength:AS},Op=CS;const Lf=(i,t,r=0)=>(Op.encode(i,t,r),t),Mf=i=>Op.encodingLength(i),ru=(i,t)=>{const r=t.byteLength,s=Mf(i),o=s+Mf(r),g=new Uint8Array(o+r);return Lf(i,g,0),Lf(r,g,s),g.set(t,o),new NS(i,r,t,g)};class NS{constructor(t,r,s,o){this.code=t,this.size=r,this.digest=s,this.bytes=o}}const Pp=({name:i,code:t,encode:r})=>new RS(i,t,r);class RS{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?ru(this.code,r):r.then(s=>ru(this.code,s))}else throw Error("Unknown type, must be binary type")}}const xp=i=>async t=>new Uint8Array(await crypto.subtle.digest(i,t)),US=Pp({name:"sha2-256",code:18,encode:xp("SHA-256")}),DS=Pp({name:"sha2-512",code:19,encode:xp("SHA-512")});var jS=Object.freeze({__proto__:null,sha256:US,sha512:DS});const Tp=0,$S="identity",Ap=wp,FS=i=>ru(Tp,Ap(i)),LS={code:Tp,name:$S,encode:Ap,digest:FS};var MS=Object.freeze({__proto__:null,identity:LS});new TextEncoder,new TextDecoder;const qf={...N6,...U6,...j6,...F6,...q6,...J6,...Q6,...rS,...oS,...dS};({...jS,...MS});function Cp(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function qS(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Cp(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Np(i,t,r,s){return{name:i,prefix:t,encoder:{name:i,prefix:t,encode:r},decoder:{decode:s}}}const Hf=Np("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Dc=Np("ascii","a",i=>{let t="a";for(let r=0;r<i.length;r++)t+=String.fromCharCode(i[r]);return t},i=>{i=i.substring(1);const t=qS(i.length);for(let r=0;r<i.length;r++)t[r]=i.charCodeAt(r);return t}),HS={utf8:Hf,"utf-8":Hf,hex:qf.base16,latin1:Dc,ascii:Dc,binary:Dc,...qf};function zS(i,t="utf8"){const r=HS[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Cp(globalThis.Buffer.from(i,"utf-8")):r.decoder.decode(`${r.prefix}${i}`)}const Rp="wc",BS=2,Nu="core",Cn=`${Rp}@2:${Nu}:`,KS={name:Nu,logger:"error"},VS={database:":memory:"},GS="crypto",zf="client_ed25519_seed",kS=me.ONE_DAY,WS="keychain",YS="0.3",JS="messages",XS="0.3",ZS=me.SIX_HOURS,QS="publisher",Up="irn",e2="error",Dp="wss://relay.walletconnect.com",t2="relayer",Ct={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},r2="_subscription",cs={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},n2=me.ONE_SECOND/2,i2="2.8.4",s2=1e4,a2="0.3",o2="WALLETCONNECT_CLIENT_ID",en={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},c2="subscription",u2="0.3",h2=me.FIVE_SECONDS*1e3,l2="pairing",f2="0.3",us={wc_pairingDelete:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:me.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:me.ONE_DAY,prompt:!1,tag:0},res:{ttl:me.ONE_DAY,prompt:!1,tag:0}}},Qr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},d2="history",p2="0.3",g2="expirer",Dr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},_2="0.3",jc="verify-api",Bf="https://verify.walletconnect.com";class y2{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=WS,this.version=YS,this.initialized=!1,this.storagePrefix=Cn,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:g}=de("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(g)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,pp(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?gp(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class v2{constructor(t,r,s){this.core=t,this.logger=r,this.name=GS,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),g=uf(o);return $d(g.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=fE();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const g=await this.getClientSeed(),w=uf(g),v=Qc();return await Mb(v,o,kS,w)},this.generateSharedKey=(o,g,w)=>{this.isInitialized();const v=this.getPrivateKey(o),S=dE(v,g);return this.setSymKey(S,w)},this.setSymKey=async(o,g)=>{this.isInitialized();const w=g||pE(o);return await this.keychain.set(w,o),w},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,g,w)=>{this.isInitialized();const v=lp(w),S=ps(g);if(Pf(v)){const K=v.senderPublicKey,q=v.receiverPublicKey;o=await this.generateSharedKey(K,q)}const U=this.getSymKey(o),{type:R,senderPublicKey:F}=v;return _E({type:R,symKey:U,message:S,senderPublicKey:F})},this.decode=async(o,g,w)=>{this.isInitialized();const v=mE(g,w);if(Pf(v)){const R=v.receiverPublicKey,F=v.senderPublicKey;o=await this.generateSharedKey(R,F)}const S=this.getSymKey(o),U=yE({symKey:S,encoded:g});return uu(U)},this.getPayloadType=o=>{const g=ja(o);return ms(g.type)},this.getPayloadSenderPublicKey=o=>{const g=ja(o);return g.senderPublicKey?jr(g.senderPublicKey,ur):void 0},this.core=t,this.logger=Qe.generateChildLogger(r,this.name),this.keychain=s||new y2(this.core,this.logger)}get context(){return Qe.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(zf)}catch{t=Qc(),await this.keychain.set(zf,t)}return zS(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class m2 extends Vw{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=JS,this.version=XS,this.initialized=!1,this.storagePrefix=Cn,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const g=Ti(o);let w=this.messages.get(s);return typeof w>"u"&&(w={}),typeof w[g]<"u"||(w[g]=o,this.messages.set(s,w),await this.persist()),g},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const g=this.get(s),w=Ti(o);return typeof g[w]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Qe.generateChildLogger(t,this.name),this.core=r}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,pp(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?gp(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class b2 extends Gw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Fr.EventEmitter,this.name=QS,this.queue=new Map,this.publishTimeout=me.toMiliseconds(me.TEN_SECONDS),this.queueTimeout=me.toMiliseconds(me.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,g)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:g}});try{const w=(g==null?void 0:g.ttl)||ZS,v=eu(g),S=(g==null?void 0:g.prompt)||!1,U=(g==null?void 0:g.tag)||0,R=(g==null?void 0:g.id)||vu().toString(),F={topic:s,message:o,opts:{ttl:w,relay:v,prompt:S,tag:U,id:R}},K=setTimeout(()=>this.queue.set(R,F),this.queueTimeout);try{await await $a(this.rpcPublish(s,o,w,v,S,U,R),this.publishTimeout),clearTimeout(K),this.relayer.events.emit(Ct.publish,F)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:g}})}catch(w){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(w),w}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=Qe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Qe.getLoggerContext(this.logger)}rpcPublish(t,r,s,o,g,w,v){var S,U,R,F;const K={method:Ta(o.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:g,tag:w},id:v};return cr((S=K.params)==null?void 0:S.prompt)&&((U=K.params)==null||delete U.prompt),cr((R=K.params)==null?void 0:R.tag)&&((F=K.params)==null||delete F.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:K}),this.relayer.request(K)}onPublish(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:o}=t;await this.publish(r,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(ys.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Ct.connection_stalled);return}this.checkQueue()}),this.relayer.on(Ct.message_ack,t=>{this.onPublish(t.id.toString())})}}class w2{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const o=s.filter(g=>g!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var E2=Object.defineProperty,S2=Object.defineProperties,I2=Object.getOwnPropertyDescriptors,Kf=Object.getOwnPropertySymbols,O2=Object.prototype.hasOwnProperty,P2=Object.prototype.propertyIsEnumerable,Vf=(i,t,r)=>t in i?E2(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,hs=(i,t)=>{for(var r in t||(t={}))O2.call(t,r)&&Vf(i,r,t[r]);if(Kf)for(var r of Kf(t))P2.call(t,r)&&Vf(i,r,t[r]);return i},$c=(i,t)=>S2(i,I2(t));class x2 extends Yw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new w2,this.events=new Fr.EventEmitter,this.name=c2,this.version=u2,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Cn,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const g=eu(o),w={topic:s,relay:g};this.pending.set(s,w);const v=await this.rpcSubscribe(s,g);return this.onSubscribe(v,w),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),v}catch(g){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(g),g}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,g)=>{const w=new me.Watch;w.start(this.pendingSubscriptionWatchLabel);const v=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(v),w.stop(this.pendingSubscriptionWatchLabel),o(!0)),w.elapsed(this.pendingSubscriptionWatchLabel)>=h2&&(clearInterval(v),w.stop(this.pendingSubscriptionWatchLabel),g(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Qe.generateChildLogger(r,this.name),this.clientId=""}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const o=eu(s);await this.rpcUnsubscribe(t,r,o);const g=Kt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,g),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const s={method:Ta(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await $a(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ct.connection_stalled)}return Ti(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:Ta(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await $a(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ct.connection_stalled)}}rpcUnsubscribe(t,r,s){const o={method:Ta(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,$c(hs({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,hs({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,hs({},r)),this.topicMap.set(r.topic,t),this.events.emit(en.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(en.deleted,$c(hs({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(en.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(en.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);ji(r)&&this.onBatchSubscribe(r.map((s,o)=>$c(hs({},t[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(ys.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ct.connect,async()=>{await this.onConnect()}),this.relayer.on(Ct.disconnect,()=>{this.onDisconnect()}),this.events.on(en.created,async t=>{const r=en.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(en.deleted,async t=>{const r=en.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var T2=Object.defineProperty,Gf=Object.getOwnPropertySymbols,A2=Object.prototype.hasOwnProperty,C2=Object.prototype.propertyIsEnumerable,kf=(i,t,r)=>t in i?T2(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,N2=(i,t)=>{for(var r in t||(t={}))A2.call(t,r)&&kf(i,r,t[r]);if(Gf)for(var r of Gf(t))C2.call(t,r)&&kf(i,r,t[r]);return i};class R2 extends kw{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Fr.EventEmitter,this.name=t2,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Qe.generateChildLogger(t.logger,this.name):Qe.pino(Qe.getDefaultLoggerOptions({level:t.logger||e2})),this.messages=new m2(this.logger,t.core),this.subscriber=new x2(this,this.logger),this.publisher=new b2(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Dp,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribted to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},s2)}get context(){return Qe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";return o||(await Promise.all([new Promise(g=>{this.subscriber.once(en.created,w=>{w.topic===t&&g()})}),new Promise(async g=>{o=await this.subscriber.subscribe(t,r),g()})]),o)}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ct.transport_closed))}async transportOpen(t){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=t||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(en.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,s)=>{await $a(this.provider.connect(),5e3,"socket stalled").catch(o=>s(o)).then(()=>r()).finally(()=>this.removeListener(Ct.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Ct.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.events.emit(Ct.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=t||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(cs.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Rn(new Sw(CE({sdkVersion:i2,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,s):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),bu(t)){if(!t.method.endsWith(r2))return;const r=t.params,{topic:s,message:o,publishedAt:g}=r.data,w={topic:s,message:o,publishedAt:g};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(N2({type:"event",event:r.id},w)),this.events.emit(r.id,w),await this.acknowledgePayload(t),await this.onMessageEvent(w)}else ka(t)&&this.events.emit(Ct.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Ct.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=mu(t.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(cs.payload,t=>this.onProviderPayload(t)),this.provider.on(cs.connect,()=>{this.events.emit(Ct.connect)}),this.provider.on(cs.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(cs.error,t=>{this.logger.error(t),this.events.emit(Ct.error,t)})}registerEventListeners(){this.events.on(Ct.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Ct.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},me.toMiliseconds(n2))}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var U2=Object.defineProperty,Wf=Object.getOwnPropertySymbols,D2=Object.prototype.hasOwnProperty,j2=Object.prototype.propertyIsEnumerable,Yf=(i,t,r)=>t in i?U2(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,Jf=(i,t)=>{for(var r in t||(t={}))D2.call(t,r)&&Yf(i,r,t[r]);if(Wf)for(var r of Wf(t))j2.call(t,r)&&Yf(i,r,t[r]);return i};class Ya extends Ww{constructor(t,r,s,o=Cn,g=void 0){super(t,r,s,o),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=a2,this.cached=[],this.initialized=!1,this.storagePrefix=Cn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(w=>{this.getKey&&w!==null&&!cr(w)?this.map.set(this.getKey(w),w):QE(w)?this.map.set(w.id,w):e6(w)&&this.map.set(w.topic,w)}),this.cached=[],this.initialized=!0)},this.set=async(w,v)=>{this.isInitialized(),this.map.has(w)?await this.update(w,v):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:w,value:v}),this.map.set(w,v),await this.persist())},this.get=w=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:w}),this.getData(w)),this.getAll=w=>(this.isInitialized(),w?this.values.filter(v=>Object.keys(w).every(S=>Ow(v[S],w[S]))):this.values),this.update=async(w,v)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:w,update:v});const S=Jf(Jf({},this.getData(w)),v);this.map.set(w,S),await this.persist()},this.delete=async(w,v)=>{this.isInitialized(),this.map.has(w)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:w,reason:v}),this.map.delete(w),await this.persist())},this.logger=Qe.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=g}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class $2{constructor(t,r){this.core=t,this.logger=r,this.name=l2,this.version=f2,this.events=new cu,this.initialized=!1,this.storagePrefix=Cn,this.ignoredPayloadTypes=[ni],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Qc(),o=await this.core.crypto.setSymKey(s),g=tn(me.FIVE_MINUTES),w={protocol:Up},v={topic:o,expiry:g,relay:w,active:!1},S=BE({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:w});return await this.pairings.set(o,v),await this.core.relayer.subscribe(o),this.core.expirer.set(o,g),{topic:o,uri:S}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:g,relay:w}=qE(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const v=tn(me.FIVE_MINUTES),S={topic:o,relay:w,expiry:v,active:!1};return await this.pairings.set(o,S),await this.core.crypto.setSymKey(g,o),await this.core.relayer.subscribe(o,{relay:w}),this.core.expirer.set(o,v),s.activatePairing&&await this.activate({topic:o}),S},this.activate=async({topic:s})=>{this.isInitialized();const o=tn(me.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const g=await this.sendRequest(o,"wc_pairingPing",{}),{done:w,resolve:v,reject:S}=xi();this.events.once(Bt("pairing_ping",g),({error:U})=>{U?S(U):v()}),await w()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Kt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,g)=>{const w=Va(o,g),v=await this.core.crypto.encode(s,w),S=us[o].req;return this.core.history.set(s,w),this.core.relayer.publish(s,v,S),w.id},this.sendResult=async(s,o,g)=>{const w=mu(s,g),v=await this.core.crypto.encode(o,w),S=await this.core.history.get(o,s),U=us[S.request.method].res;await this.core.relayer.publish(o,v,U),await this.core.history.resolve(w)},this.sendError=async(s,o,g)=>{const w=Ga(s,g),v=await this.core.crypto.encode(o,w),S=await this.core.history.get(o,s),U=us[S.request.method]?us[S.request.method].res:us.unregistered_method.res;await this.core.relayer.publish(o,v,U),await this.core.history.resolve(w)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Kt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>An(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:g}=s,w=g.method;if(this.pairings.keys.includes(o))switch(w){case"wc_pairingPing":return this.onPairingPingRequest(o,g);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,g);default:return this.onUnknownRpcMethodRequest(o,g)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:g}=s,w=(await this.core.history.get(o,g.id)).request.method;if(this.pairings.keys.includes(o))switch(w){case"wc_pairingPing":return this.onPairingPingResponse(o,g);default:return this.onUnknownRpcMethodResponse(w)}},this.onPairingPingRequest=async(s,o)=>{const{id:g}=o;try{this.isValidPing({topic:s}),await this.sendResult(g,s,!0),this.events.emit("pairing_ping",{id:g,topic:s})}catch(w){await this.sendError(g,s,w),this.logger.error(w)}},this.onPairingPingResponse=(s,o)=>{const{id:g}=o;setTimeout(()=>{yn(o)?this.events.emit(Bt("pairing_ping",g),{}):Kr(o)&&this.events.emit(Bt("pairing_ping",g),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:g}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:g,topic:s})}catch(w){await this.sendError(g,s,w),this.logger.error(w)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:g,method:w}=o;try{if(this.registeredMethods.includes(w))return;const v=Kt("WC_METHOD_UNSUPPORTED",w);await this.sendError(g,s,v),this.logger.error(v)}catch(v){await this.sendError(g,s,v),this.logger.error(v)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Kt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!_r(s)){const{message:o}=de("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!ZE(s.uri)){const{message:o}=de("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!_r(s)){const{message:g}=de("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(g)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!_r(s)){const{message:g}=de("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(g)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Yt(s,!1)){const{message:o}=de("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=de("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(An(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=de("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=t,this.logger=Qe.generateChildLogger(r,this.name),this.pairings=new Ya(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Qe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Ct.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(r,s);bu(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):ka(o)&&(await this.core.history.resolve(o),this.onRelayEventResponse({topic:r,payload:o}))})}registerExpirerEvents(){this.core.expirer.on(Dr.expired,async t=>{const{topic:r}=yp(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class F2 extends Kw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Fr.EventEmitter,this.name=d2,this.version=p2,this.cached=[],this.initialized=!1,this.storagePrefix=Cn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,g)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:g}),this.records.has(o.id))return;const w={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:g};this.records.set(w.id,w),this.events.emit(Qr.created,w)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Kr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Qr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(g=>{if(g.topic===s){if(typeof o<"u"&&g.id!==o)return;this.records.delete(g.id),this.events.emit(Qr.deleted,g)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Va(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Qr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Qr.created,t=>{const r=Qr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.updated,t=>{const r=Qr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.deleted,t=>{const r=Qr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class L2 extends Jw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Fr.EventEmitter,this.name=g2,this.version=_2,this.cached=[],this.initialized=!1,this.storagePrefix=Cn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const g=this.formatTarget(s),w={target:g,expiry:o};this.expirations.set(g,w),this.checkExpiry(g,w),this.events.emit(Dr.created,{target:g,expiration:w})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),g=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Dr.deleted,{target:o,expiration:g})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return NE(t);if(typeof t=="number")return RE(t);const{message:r}=de("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Dr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;me.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Dr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(ys.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Dr.created,t=>{const r=Dr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Dr.expired,t=>{const r=Dr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Dr.deleted,t=>{const r=Dr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class M2 extends Xw{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=jc,this.initialized=!1,this.init=async s=>{fp()||!Tu()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||Bf,await this.createIframe())},this.register=async s=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async s=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const g=this.startAbortTimer(me.FIVE_SECONDS),w=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(g),w.status===200?(o=await w.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,o)=>{if(document.getElementById(jc))return s();const g=document.createElement("iframe");g.setAttribute("id",jc),g.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),g.style.display="none",g.addEventListener("load",()=>{this.initialized=!0,s()}),g.addEventListener("error",w=>{o(w)}),document.body.append(g),this.iframe=g}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),me.toMiliseconds(me.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Qe.generateChildLogger(r,this.name),this.verifyUrl=Bf,this.abortController=new AbortController,this.isDevEnv=xu()&&{}.IS_VITEST}get context(){return Qe.getLoggerContext(this.logger)}startAbortTimer(t){return setTimeout(()=>this.abortController.abort(),me.toMiliseconds(t))}}var q2=Object.defineProperty,Xf=Object.getOwnPropertySymbols,H2=Object.prototype.hasOwnProperty,z2=Object.prototype.propertyIsEnumerable,Zf=(i,t,r)=>t in i?q2(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,Qf=(i,t)=>{for(var r in t||(t={}))H2.call(t,r)&&Zf(i,r,t[r]);if(Xf)for(var r of Xf(t))z2.call(t,r)&&Zf(i,r,t[r]);return i};let B2=class jp extends Bw{constructor(t){super(t),this.protocol=Rp,this.version=BS,this.name=Nu,this.events=new Fr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Dp;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||KS.logger}));this.logger=Qe.generateChildLogger(r,this.name),this.heartbeat=new ys.HeartBeat,this.crypto=new v2(this,this.logger,t==null?void 0:t.keychain),this.history=new F2(this,this.logger),this.expirer=new L2(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Nm(Qf(Qf({},VS),t==null?void 0:t.storageOptions)),this.relayer=new R2({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new $2(this,this.logger),this.verify=new M2(this.projectId||"",this.logger)}static async init(t){const r=new jp(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(o2,s),r}get context(){return Qe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}};const K2=B2,$p="wc",Fp=2,Lp="client",Ru=`${$p}@${Fp}:${Lp}:`,Fc={name:Lp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},V2="WALLETCONNECT_DEEPLINK_CHOICE",G2="proposal",Mp="Proposal expired",k2="session",Oa=me.SEVEN_DAYS,W2="engine",ls={wc_sessionPropose:{req:{ttl:me.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1104},res:{ttl:me.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1106},res:{ttl:me.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:me.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:me.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1112},res:{ttl:me.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1115}}},Lc={min:me.FIVE_MINUTES,max:me.SEVEN_DAYS},Y2="request",J2=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var X2=Object.defineProperty,Z2=Object.defineProperties,Q2=Object.getOwnPropertyDescriptors,ed=Object.getOwnPropertySymbols,e3=Object.prototype.hasOwnProperty,t3=Object.prototype.propertyIsEnumerable,td=(i,t,r)=>t in i?X2(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,Ur=(i,t)=>{for(var r in t||(t={}))e3.call(t,r)&&td(i,r,t[r]);if(ed)for(var r of ed(t))t3.call(t,r)&&td(i,r,t[r]);return i},Mc=(i,t)=>Z2(i,Q2(t));class r3 extends Qw{constructor(t){super(t),this.name=W2,this.events=new cu,this.initialized=!1,this.ignoredPayloadTypes=[ni],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(ls)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const s=Mc(Ur({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:g,optionalNamespaces:w,sessionProperties:v,relays:S}=s;let U=o,R,F=!1;if(U&&(F=this.client.core.pairing.pairings.get(U).active),!U||!F){const{topic:C,uri:O}=await this.client.core.pairing.create();U=C,R=O}const K=await this.client.core.crypto.generateKeyPair(),q=Ur({requiredNamespaces:g,optionalNamespaces:w,relays:S??[{protocol:Up}],proposer:{publicKey:K,metadata:this.client.metadata}},v&&{sessionProperties:v}),{reject:H,resolve:Q,done:J}=xi(me.FIVE_MINUTES,Mp);if(this.events.once(Bt("session_connect"),async({error:C,session:O})=>{if(C)H(C);else if(O){O.self.publicKey=K;const T=Mc(Ur({},O),{requiredNamespaces:O.requiredNamespaces,optionalNamespaces:O.optionalNamespaces});await this.client.session.set(O.topic,T),await this.setExpiry(O.topic,O.expiry),U&&await this.client.core.pairing.updateMetadata({topic:U,metadata:O.peer.metadata}),Q(T)}}),!U){const{message:C}=de("NO_MATCHING_KEY",`connect() pairing topic: ${U}`);throw new Error(C)}const ce=await this.sendRequest(U,"wc_sessionPropose",q),x=tn(me.FIVE_MINUTES);return await this.setProposal(ce,Ur({id:ce,expiry:x},q)),{uri:R,approval:J}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:o,namespaces:g,sessionProperties:w}=r,v=this.client.proposal.get(s);let{pairingTopic:S,proposer:U,requiredNamespaces:R,optionalNamespaces:F}=v;S=S||"",Ai(R)||(R=kE(g,"approve()"));const K=await this.client.core.crypto.generateKeyPair(),q=U.publicKey,H=await this.client.core.crypto.generateSharedKey(K,q);S&&s&&(await this.client.core.pairing.updateMetadata({topic:S,metadata:U.metadata}),await this.sendResult(s,S,{relay:{protocol:o??"irn"},responderPublicKey:K}),await this.client.proposal.delete(s,Kt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:S}));const Q=Ur({relay:{protocol:o??"irn"},namespaces:g,requiredNamespaces:R,optionalNamespaces:F,pairingTopic:S,controller:{publicKey:K,metadata:this.client.metadata},expiry:tn(Oa)},w&&{sessionProperties:w});await this.client.core.relayer.subscribe(H),await this.sendRequest(H,"wc_sessionSettle",Q);const J=Mc(Ur({},Q),{topic:H,pairingTopic:S,acknowledged:!1,self:Q.controller,peer:{publicKey:U.publicKey,metadata:U.metadata},controller:K});return await this.client.session.set(H,J),await this.setExpiry(H,tn(Oa)),{topic:H,acknowledged:()=>new Promise(ce=>setTimeout(()=>ce(this.client.session.get(H)),500))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:s,reason:o}=r,{pairingTopic:g}=this.client.proposal.get(s);g&&(await this.sendError(s,g,o),await this.client.proposal.delete(s,Kt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:o}=r,g=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:o}),{done:w,resolve:v,reject:S}=xi();return this.events.once(Bt("session_update",g),({error:U})=>{U?S(U):v()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:w}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,o=await this.sendRequest(s,"wc_sessionExtend",{}),{done:g,resolve:w,reject:v}=xi();return this.events.once(Bt("session_extend",o),({error:S})=>{S?v(S):w()}),await this.setExpiry(s,tn(Oa)),{acknowledged:g}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:o,topic:g,expiry:w}=r,v=await this.sendRequest(g,"wc_sessionRequest",{request:o,chainId:s},w),{done:S,resolve:U,reject:R}=xi(w);this.events.once(Bt("session_request",v),({error:K,result:q})=>{K?R(K):U(q)}),this.client.events.emit("session_request_sent",{topic:g,request:o,chainId:s,id:v});const F=await this.client.core.storage.getItem(V2);return UE({id:v,topic:g,wcDeepLink:F}),await S()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:o}=r,{id:g}=o;yn(o)?await this.sendResult(g,s,o.result):Kr(o)&&await this.sendError(g,s,o.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=await this.sendRequest(s,"wc_sessionPing",{}),{done:g,resolve:w,reject:v}=xi();this.events.once(Bt("session_ping",o),({error:S})=>{S?v(S):w()}),await g()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:o,chainId:g}=r;await this.sendRequest(s,"wc_sessionEvent",{event:o,chainId:g})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=vu().toString();let g;const w=v=>{(v==null?void 0:v.id.toString())===o&&(this.client.core.relayer.events.removeListener(Ct.message_ack,w),g())};await Promise.all([new Promise(v=>{g=v,this.client.core.relayer.on(Ct.message_ack,w)}),this.sendRequest(s,"wc_sessionDelete",Kt("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>JE(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(g=>{var w,v;return((w=g.peerMetadata)==null?void 0:w.url)&&((v=g.peerMetadata)==null?void 0:v.url)===r.peer.metadata.url&&g.topic&&g.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(g=>this.client.core.pairing.disconnect({topic:g.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Kt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r)},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,Kt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),o?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=ls.wc_sessionRequest.req.ttl,{id:o,topic:g,params:w}=r;await this.client.pendingRequest.set(o,{id:o,topic:g,params:w}),s&&this.client.core.expirer.set(o,tn(s))},this.sendRequest=async(r,s,o,g,w)=>{const v=Va(s,o);if(Tu()&&J2.includes(s)){const R=Ti(JSON.stringify(v));await this.client.core.verify.register({attestationId:R})}const S=await this.client.core.crypto.encode(r,v),U=ls[s].req;return g&&(U.ttl=g),w&&(U.id=w),this.client.core.history.set(r,v),this.client.core.relayer.publish(r,S,U),v.id},this.sendResult=async(r,s,o)=>{const g=mu(r,o),w=await this.client.core.crypto.encode(s,g),v=await this.client.core.history.get(s,r),S=ls[v.request.method].res;this.client.core.relayer.publish(s,w,S),await this.client.core.history.resolve(g)},this.sendError=async(r,s,o)=>{const g=Ga(r,o),w=await this.client.core.crypto.encode(s,g),v=await this.client.core.history.get(s,r),S=ls[v.request.method].res;this.client.core.relayer.publish(s,w,S),await this.client.core.history.resolve(g)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(o=>{An(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{An(o.expiry)&&s.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=r=>{const{topic:s,payload:o}=r,g=o.method;switch(g){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${g}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:o}=r,g=(await this.client.core.history.get(s,o.id)).request.method;switch(g){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${g}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:o}=de("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,s)=>{const{params:o,id:g}=s;try{this.isValidConnect(Ur({},s.params));const w=tn(me.FIVE_MINUTES),v=Ur({id:g,pairingTopic:r,expiry:w},o);await this.setProposal(g,v);const S=Ti(JSON.stringify(s)),U=await this.getVerifyContext(S,v.proposer.metadata);this.client.events.emit("session_proposal",{id:g,params:v,verifyContext:U})}catch(w){await this.sendError(g,r,w),this.client.logger.error(w)}},this.onSessionProposeResponse=async(r,s)=>{const{id:o}=s;if(yn(s)){const{result:g}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:g});const w=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:w});const v=w.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:v});const S=g.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:S});const U=await this.client.core.crypto.generateSharedKey(v,S);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:U});const R=await this.client.core.relayer.subscribe(U);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:R}),await this.client.core.pairing.activate({topic:r})}else Kr(s)&&(await this.client.proposal.delete(o,Kt("USER_DISCONNECTED")),this.events.emit(Bt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:o,params:g}=s;try{this.isValidSessionSettleRequest(g);const{relay:w,controller:v,expiry:S,namespaces:U,requiredNamespaces:R,optionalNamespaces:F,sessionProperties:K,pairingTopic:q}=s.params,H=Ur({topic:r,relay:w,expiry:S,namespaces:U,acknowledged:!0,pairingTopic:q,requiredNamespaces:R,optionalNamespaces:F,controller:v.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:v.publicKey,metadata:v.metadata}},K&&{sessionProperties:K});await this.sendResult(s.id,r,!0),this.events.emit(Bt("session_connect"),{session:H}),this.cleanupDuplicatePairings(H)}catch(w){await this.sendError(o,r,w),this.client.logger.error(w)}},this.onSessionSettleResponse=async(r,s)=>{const{id:o}=s;yn(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Bt("session_approve",o),{})):Kr(s)&&(await this.client.session.delete(r,Kt("USER_DISCONNECTED")),this.events.emit(Bt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:o,id:g}=s;try{this.isValidUpdate(Ur({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult(g,r,!0),this.client.events.emit("session_update",{id:g,topic:r,params:o})}catch(w){await this.sendError(g,r,w),this.client.logger.error(w)}},this.onSessionUpdateResponse=(r,s)=>{const{id:o}=s;yn(s)?this.events.emit(Bt("session_update",o),{}):Kr(s)&&this.events.emit(Bt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:o}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,tn(Oa)),await this.sendResult(o,r,!0),this.client.events.emit("session_extend",{id:o,topic:r})}catch(g){await this.sendError(o,r,g),this.client.logger.error(g)}},this.onSessionExtendResponse=(r,s)=>{const{id:o}=s;yn(s)?this.events.emit(Bt("session_extend",o),{}):Kr(s)&&this.events.emit(Bt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:o}=s;try{this.isValidPing({topic:r}),await this.sendResult(o,r,!0),this.client.events.emit("session_ping",{id:o,topic:r})}catch(g){await this.sendError(o,r,g),this.client.logger.error(g)}},this.onSessionPingResponse=(r,s)=>{const{id:o}=s;setTimeout(()=>{yn(s)?this.events.emit(Bt("session_ping",o),{}):Kr(s)&&this.events.emit(Bt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(g=>{this.client.core.relayer.once(Ct.publish,async()=>{g(await this.deleteSession(r))})}),this.sendResult(o,r,!0)]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(g){this.client.logger.error(g)}},this.onSessionRequest=async(r,s)=>{const{id:o,params:g}=s;try{this.isValidRequest(Ur({topic:r},g)),await this.setPendingSessionRequest({id:o,topic:r,params:g});const w=Ti(JSON.stringify(s)),v=this.client.session.get(r),S=await this.getVerifyContext(w,v.peer.metadata);this.client.events.emit("session_request",{id:o,topic:r,params:g,verifyContext:S})}catch(w){await this.sendError(o,r,w),this.client.logger.error(w)}},this.onSessionRequestResponse=(r,s)=>{const{id:o}=s;yn(s)?this.events.emit(Bt("session_request",o),{result:s.result}):Kr(s)&&this.events.emit(Bt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:o,params:g}=s;try{this.isValidEmit(Ur({topic:r},g)),this.client.events.emit("session_event",{id:o,topic:r,params:g})}catch(w){await this.sendError(o,r,w),this.client.logger.error(w)}},this.isValidConnect=async r=>{if(!_r(r)){const{message:S}=de("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(S)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:g,sessionProperties:w,relays:v}=r;if(cr(s)||await this.isValidPairingTopic(s),!c6(v,!0)){const{message:S}=de("MISSING_OR_INVALID",`connect() relays: ${v}`);throw new Error(S)}!cr(o)&&Ai(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!cr(g)&&Ai(g)!==0&&this.validateNamespaces(g,"optionalNamespaces"),cr(w)||this.validateSessionProps(w,"sessionProperties")},this.validateNamespaces=(r,s)=>{const o=o6(r,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!_r(r))throw new Error(de("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:o,relayProtocol:g,sessionProperties:w}=r;await this.isValidProposalId(s);const v=this.client.proposal.get(s),S=Ca(o,"approve()");if(S)throw new Error(S.message);const U=Df(v.requiredNamespaces,o,"approve()");if(U)throw new Error(U.message);if(!Yt(g,!0)){const{message:R}=de("MISSING_OR_INVALID",`approve() relayProtocol: ${g}`);throw new Error(R)}cr(w)||this.validateSessionProps(w,"sessionProperties")},this.isValidReject=async r=>{if(!_r(r)){const{message:g}=de("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(g)}const{id:s,reason:o}=r;if(await this.isValidProposalId(s),!h6(o)){const{message:g}=de("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidSessionSettleRequest=r=>{if(!_r(r)){const{message:U}=de("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(U)}const{relay:s,controller:o,namespaces:g,expiry:w}=r;if(!bp(s)){const{message:U}=de("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(U)}const v=t6(o,"onSessionSettleRequest()");if(v)throw new Error(v.message);const S=Ca(g,"onSessionSettleRequest()");if(S)throw new Error(S.message);if(An(w)){const{message:U}=de("EXPIRED","onSessionSettleRequest()");throw new Error(U)}},this.isValidUpdate=async r=>{if(!_r(r)){const{message:S}=de("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(S)}const{topic:s,namespaces:o}=r;await this.isValidSessionTopic(s);const g=this.client.session.get(s),w=Ca(o,"update()");if(w)throw new Error(w.message);const v=Df(g.requiredNamespaces,o,"update()");if(v)throw new Error(v.message)},this.isValidExtend=async r=>{if(!_r(r)){const{message:o}=de("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!_r(r)){const{message:S}=de("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(S)}const{topic:s,request:o,chainId:g,expiry:w}=r;await this.isValidSessionTopic(s);const{namespaces:v}=this.client.session.get(s);if(!Uf(v,g)){const{message:S}=de("MISSING_OR_INVALID",`request() chainId: ${g}`);throw new Error(S)}if(!l6(o)){const{message:S}=de("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(S)}if(!p6(v,g,o.method)){const{message:S}=de("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(S)}if(w&&!v6(w,Lc)){const{message:S}=de("MISSING_OR_INVALID",`request() expiry: ${w}. Expiry must be a number (in seconds) between ${Lc.min} and ${Lc.max}`);throw new Error(S)}},this.isValidRespond=async r=>{if(!_r(r)){const{message:g}=de("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(g)}const{topic:s,response:o}=r;if(await this.isValidSessionTopic(s),!f6(o)){const{message:g}=de("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidPing=async r=>{if(!_r(r)){const{message:o}=de("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!_r(r)){const{message:v}=de("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(v)}const{topic:s,event:o,chainId:g}=r;await this.isValidSessionTopic(s);const{namespaces:w}=this.client.session.get(s);if(!Uf(w,g)){const{message:v}=de("MISSING_OR_INVALID",`emit() chainId: ${g}`);throw new Error(v)}if(!d6(o)){const{message:v}=de("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(v)}if(!g6(w,g,o.name)){const{message:v}=de("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(v)}},this.isValidDisconnect=async r=>{if(!_r(r)){const{message:o}=de("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const o={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const g=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});g&&(o.verified.origin=g,o.verified.validation=g===s.url?"VALID":"INVALID")}catch(g){this.client.logger.error(g)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(o=>{if(!Yt(o,!1)){const{message:g}=de("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(g)}})}}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(Ct.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(r,s);bu(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):ka(o)?(await this.client.core.history.resolve(o),this.onRelayEventResponse({topic:r,payload:o})):this.onRelayEventUnknownPayload({topic:r,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(Dr.expired,async t=>{const{topic:r,id:s}=yp(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,de("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(t){if(!Yt(t,!1)){const{message:r}=de("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=de("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(An(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=de("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Yt(t,!1)){const{message:r}=de("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=de("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(An(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=de("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Yt(t,!1)){const{message:r}=de("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=de("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!u6(t)){const{message:r}=de("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=de("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(An(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=de("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class n3 extends Ya{constructor(t,r){super(t,r,G2,Ru),this.core=t,this.logger=r}}class i3 extends Ya{constructor(t,r){super(t,r,k2,Ru),this.core=t,this.logger=r}}class s3 extends Ya{constructor(t,r){super(t,r,Y2,Ru,s=>s.id),this.core=t,this.logger=r}}class Uu extends Zw{constructor(t){super(t),this.protocol=$p,this.version=Fp,this.name=Fc.name,this.events=new Fr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Fc.name,this.metadata=(t==null?void 0:t.metadata)||PE();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Fc.logger}));this.core=(t==null?void 0:t.core)||new K2(t),this.logger=Qe.generateChildLogger(r,this.name),this.session=new i3(this.core,this.logger),this.proposal=new n3(this.core,this.logger),this.pendingRequest=new s3(this.core,this.logger),this.engine=new r3(this)}static async init(t){const r=new Uu(t);return await r.initialize(),r}get context(){return Qe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}const a3={Accept:"application/json","Content-Type":"application/json"},o3="POST",rd={headers:a3,method:o3},nd=10;class ii{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Fr.EventEmitter,this.isAvailable=!1,this.registering=!1,!yf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=ps(t),g=await(await jl(this.url,Object.assign(Object.assign({},rd),{body:s}))).json();this.onPayload({data:g})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!yf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",g=>{this.resetMaxListeners(),o(g)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=ps({id:1,jsonrpc:"2.0",method:"test",params:[]});await jl(t,Object.assign(Object.assign({},rd),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?uu(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),g=Ga(t,o);this.events.emit("payload",g)}parseError(t,r=this.url){return Yd(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>nd&&this.events.setMaxListeners(nd)}}const id="error",c3="wss://relay.walletconnect.com",u3="wc",h3="universal_provider",sd=`${u3}@2:${h3}:`,l3="https://rpc.walletconnect.com/v1",Un={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var fs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},nu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,t){(function(){var r,s="4.17.21",o=200,g="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",w="Expected a function",v="Invalid `variable` option passed into `_.template`",S="__lodash_hash_undefined__",U=500,R="__lodash_placeholder__",F=1,K=2,q=4,H=1,Q=2,J=1,ce=2,x=4,C=8,O=16,T=32,b=64,c=128,_=256,Z=512,u=30,f="...",d=800,E=16,y=1,p=2,D=3,L=1/0,W=9007199254740991,A=17976931348623157e292,z=0/0,te=4294967295,re=te-1,ne=te>>>1,ge=[["ary",c],["bind",J],["bindKey",ce],["curry",C],["curryRight",O],["flip",Z],["partial",T],["partialRight",b],["rearg",_]],le="[object Arguments]",be="[object Array]",X="[object AsyncFunction]",Y="[object Boolean]",B="[object Date]",l="[object DOMException]",$="[object Error]",he="[object Function]",pe="[object GeneratorFunction]",Oe="[object Map]",ze="[object Number]",Ve="[object Null]",Fe="[object Object]",gt="[object Promise]",_t="[object Proxy]",Me="[object RegExp]",Pe="[object Set]",Ue="[object String]",De="[object Symbol]",qe="[object Undefined]",Te="[object WeakMap]",je="[object WeakSet]",Ie="[object ArrayBuffer]",Ae="[object DataView]",Be="[object Float32Array]",xe="[object Float64Array]",Ge="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",tr="[object Uint16Array]",hr="[object Uint32Array]",Gr=/\b__p \+= '';/g,rr=/\b(__p \+=) '' \+/g,rn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,vn=/&(?:amp|lt|gt|quot|#39);/g,Dn=/[&<>"']/g,St=RegExp(vn.source),yt=RegExp(Dn.source),It=/<%-([\s\S]+?)%>/g,Ot=/<%([\s\S]+?)%>/g,bt=/<%=([\s\S]+?)%>/g,vt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$t=/^\w*$/,Ft=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pt=/[\\^$.*+?()[\]{}|]/g,Lt=RegExp(Pt.source),xt=/^\s+/,Nt=/\s/,Tt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Mt=/,? & /,qt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ja=/[()=,{}\[\]\/\s]/,Xa=/\\(\\)?/g,Za=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ir=/\w*$/,Qa=/^[-+]0x[0-9a-f]+$/i,eo=/^0b[01]+$/i,to=/^\[object .+?Constructor\]$/,ro=/^0o[0-7]+$/i,no=/^(?:0|[1-9]\d*)$/,nn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,si=/($^)/,io=/['\n\r\u2028\u2029\\]/g,ai="\\ud800-\\udfff",so="\\u0300-\\u036f",ao="\\ufe20-\\ufe2f",oi="\\u20d0-\\u20ff",ws=so+ao+oi,Es="\\u2700-\\u27bf",Lr="a-z\\xdf-\\xf6\\xf8-\\xff",oo="\\xac\\xb1\\xd7\\xf7",co="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",uo="\\u2000-\\u206f",ho=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ss="A-Z\\xc0-\\xd6\\xd8-\\xde",Is="\\ufe0e\\ufe0f",jn=oo+co+uo+ho,$i="['’]",$n="["+ai+"]",Fi="["+jn+"]",Fn="["+ws+"]",Os="\\d+",lo="["+Es+"]",Ps="["+Lr+"]",xs="[^"+ai+jn+Os+Es+Lr+Ss+"]",ci="\\ud83c[\\udffb-\\udfff]",fo="(?:"+Fn+"|"+ci+")",Ts="[^"+ai+"]",ui="(?:\\ud83c[\\udde6-\\uddff]){2}",mn="[\\ud800-\\udbff][\\udc00-\\udfff]",yr="["+Ss+"]",As="\\u200d",Cs="(?:"+Ps+"|"+xs+")",kr="(?:"+yr+"|"+xs+")",Ns="(?:"+$i+"(?:d|ll|m|re|s|t|ve))?",Rs="(?:"+$i+"(?:D|LL|M|RE|S|T|VE))?",Us=fo+"?",Ds="["+Is+"]?",po="(?:"+As+"(?:"+[Ts,ui,mn].join("|")+")"+Ds+Us+")*",sn="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",js="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",$s=Ds+Us+po,hi="(?:"+[lo,ui,mn].join("|")+")"+$s,go="(?:"+[Ts+Fn+"?",Fn,ui,mn,$n].join("|")+")",Li=RegExp($i,"g"),_o=RegExp(Fn,"g"),li=RegExp(ci+"(?="+ci+")|"+go+$s,"g"),Fs=RegExp([yr+"?"+Ps+"+"+Ns+"(?="+[Fi,yr,"$"].join("|")+")",kr+"+"+Rs+"(?="+[Fi,yr+Cs,"$"].join("|")+")",yr+"?"+Cs+"+"+Ns,yr+"+"+Rs,js,sn,Os,hi].join("|"),"g"),Ls=RegExp("["+As+ai+ws+Is+"]"),Ln=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ms=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],yo=-1,at={};at[Be]=at[xe]=at[Ge]=at[We]=at[et]=at[tt]=at[Je]=at[tr]=at[hr]=!0,at[le]=at[be]=at[Ie]=at[Y]=at[Ae]=at[B]=at[$]=at[he]=at[Oe]=at[ze]=at[Fe]=at[Me]=at[Pe]=at[Ue]=at[Te]=!1;var st={};st[le]=st[be]=st[Ie]=st[Ae]=st[Y]=st[B]=st[Be]=st[xe]=st[Ge]=st[We]=st[et]=st[Oe]=st[ze]=st[Fe]=st[Me]=st[Pe]=st[Ue]=st[De]=st[tt]=st[Je]=st[tr]=st[hr]=!0,st[$]=st[he]=st[Te]=!1;var N={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},V={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},oe={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},_e={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ot=parseFloat,Ne=parseInt,dt=typeof fs=="object"&&fs&&fs.Object===Object&&fs,Ht=typeof self=="object"&&self&&self.Object===Object&&self,Xe=dt||Ht||Function("return this")(),ct=t&&!t.nodeType&&t,Rt=ct&&!0&&i&&!i.nodeType&&i,lr=Rt&&Rt.exports===ct,zt=lr&&dt.process,pt=function(){try{var G=Rt&&Rt.require&&Rt.require("util").types;return G||zt&&zt.binding&&zt.binding("util")}catch{}}(),nr=pt&&pt.isArrayBuffer,Mr=pt&&pt.isDate,Or=pt&&pt.isMap,Wr=pt&&pt.isRegExp,Mi=pt&&pt.isSet,Mn=pt&&pt.isTypedArray;function kt(G,ie,ee){switch(ee.length){case 0:return G.call(ie);case 1:return G.call(ie,ee[0]);case 2:return G.call(ie,ee[0],ee[1]);case 3:return G.call(ie,ee[0],ee[1],ee[2])}return G.apply(ie,ee)}function Hp(G,ie,ee,ye){for(var Ce=-1,rt=G==null?0:G.length;++Ce<rt;){var Vt=G[Ce];ie(ye,Vt,ee(Vt),G)}return ye}function Pr(G,ie){for(var ee=-1,ye=G==null?0:G.length;++ee<ye&&ie(G[ee],ee,G)!==!1;);return G}function zp(G,ie){for(var ee=G==null?0:G.length;ee--&&ie(G[ee],ee,G)!==!1;);return G}function $u(G,ie){for(var ee=-1,ye=G==null?0:G.length;++ee<ye;)if(!ie(G[ee],ee,G))return!1;return!0}function bn(G,ie){for(var ee=-1,ye=G==null?0:G.length,Ce=0,rt=[];++ee<ye;){var Vt=G[ee];ie(Vt,ee,G)&&(rt[Ce++]=Vt)}return rt}function qs(G,ie){var ee=G==null?0:G.length;return!!ee&&fi(G,ie,0)>-1}function vo(G,ie,ee){for(var ye=-1,Ce=G==null?0:G.length;++ye<Ce;)if(ee(ie,G[ye]))return!0;return!1}function mt(G,ie){for(var ee=-1,ye=G==null?0:G.length,Ce=Array(ye);++ee<ye;)Ce[ee]=ie(G[ee],ee,G);return Ce}function wn(G,ie){for(var ee=-1,ye=ie.length,Ce=G.length;++ee<ye;)G[Ce+ee]=ie[ee];return G}function mo(G,ie,ee,ye){var Ce=-1,rt=G==null?0:G.length;for(ye&&rt&&(ee=G[++Ce]);++Ce<rt;)ee=ie(ee,G[Ce],Ce,G);return ee}function Bp(G,ie,ee,ye){var Ce=G==null?0:G.length;for(ye&&Ce&&(ee=G[--Ce]);Ce--;)ee=ie(ee,G[Ce],Ce,G);return ee}function bo(G,ie){for(var ee=-1,ye=G==null?0:G.length;++ee<ye;)if(ie(G[ee],ee,G))return!0;return!1}var Kp=wo("length");function Vp(G){return G.split("")}function Gp(G){return G.match(qt)||[]}function Fu(G,ie,ee){var ye;return ee(G,function(Ce,rt,Vt){if(ie(Ce,rt,Vt))return ye=rt,!1}),ye}function Hs(G,ie,ee,ye){for(var Ce=G.length,rt=ee+(ye?1:-1);ye?rt--:++rt<Ce;)if(ie(G[rt],rt,G))return rt;return-1}function fi(G,ie,ee){return ie===ie?ig(G,ie,ee):Hs(G,Lu,ee)}function kp(G,ie,ee,ye){for(var Ce=ee-1,rt=G.length;++Ce<rt;)if(ye(G[Ce],ie))return Ce;return-1}function Lu(G){return G!==G}function Mu(G,ie){var ee=G==null?0:G.length;return ee?So(G,ie)/ee:z}function wo(G){return function(ie){return ie==null?r:ie[G]}}function Eo(G){return function(ie){return G==null?r:G[ie]}}function qu(G,ie,ee,ye,Ce){return Ce(G,function(rt,Vt,ut){ee=ye?(ye=!1,rt):ie(ee,rt,Vt,ut)}),ee}function Wp(G,ie){var ee=G.length;for(G.sort(ie);ee--;)G[ee]=G[ee].value;return G}function So(G,ie){for(var ee,ye=-1,Ce=G.length;++ye<Ce;){var rt=ie(G[ye]);rt!==r&&(ee=ee===r?rt:ee+rt)}return ee}function Io(G,ie){for(var ee=-1,ye=Array(G);++ee<G;)ye[ee]=ie(ee);return ye}function Yp(G,ie){return mt(ie,function(ee){return[ee,G[ee]]})}function Hu(G){return G&&G.slice(0,Vu(G)+1).replace(xt,"")}function vr(G){return function(ie){return G(ie)}}function Oo(G,ie){return mt(ie,function(ee){return G[ee]})}function qi(G,ie){return G.has(ie)}function zu(G,ie){for(var ee=-1,ye=G.length;++ee<ye&&fi(ie,G[ee],0)>-1;);return ee}function Bu(G,ie){for(var ee=G.length;ee--&&fi(ie,G[ee],0)>-1;);return ee}function Jp(G,ie){for(var ee=G.length,ye=0;ee--;)G[ee]===ie&&++ye;return ye}var Xp=Eo(N),Zp=Eo(V);function Qp(G){return"\\"+_e[G]}function eg(G,ie){return G==null?r:G[ie]}function di(G){return Ls.test(G)}function tg(G){return Ln.test(G)}function rg(G){for(var ie,ee=[];!(ie=G.next()).done;)ee.push(ie.value);return ee}function Po(G){var ie=-1,ee=Array(G.size);return G.forEach(function(ye,Ce){ee[++ie]=[Ce,ye]}),ee}function Ku(G,ie){return function(ee){return G(ie(ee))}}function En(G,ie){for(var ee=-1,ye=G.length,Ce=0,rt=[];++ee<ye;){var Vt=G[ee];(Vt===ie||Vt===R)&&(G[ee]=R,rt[Ce++]=ee)}return rt}function zs(G){var ie=-1,ee=Array(G.size);return G.forEach(function(ye){ee[++ie]=ye}),ee}function ng(G){var ie=-1,ee=Array(G.size);return G.forEach(function(ye){ee[++ie]=[ye,ye]}),ee}function ig(G,ie,ee){for(var ye=ee-1,Ce=G.length;++ye<Ce;)if(G[ye]===ie)return ye;return-1}function sg(G,ie,ee){for(var ye=ee+1;ye--;)if(G[ye]===ie)return ye;return ye}function pi(G){return di(G)?og(G):Kp(G)}function qr(G){return di(G)?cg(G):Vp(G)}function Vu(G){for(var ie=G.length;ie--&&Nt.test(G.charAt(ie)););return ie}var ag=Eo(oe);function og(G){for(var ie=li.lastIndex=0;li.test(G);)++ie;return ie}function cg(G){return G.match(li)||[]}function ug(G){return G.match(Fs)||[]}var hg=function G(ie){ie=ie==null?Xe:gi.defaults(Xe.Object(),ie,gi.pick(Xe,Ms));var ee=ie.Array,ye=ie.Date,Ce=ie.Error,rt=ie.Function,Vt=ie.Math,ut=ie.Object,xo=ie.RegExp,lg=ie.String,xr=ie.TypeError,Bs=ee.prototype,fg=rt.prototype,_i=ut.prototype,Ks=ie["__core-js_shared__"],Vs=fg.toString,it=_i.hasOwnProperty,dg=0,Gu=function(){var e=/[^.]+$/.exec(Ks&&Ks.keys&&Ks.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Gs=_i.toString,pg=Vs.call(ut),gg=Xe._,_g=xo("^"+Vs.call(it).replace(Pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ks=lr?ie.Buffer:r,Sn=ie.Symbol,Ws=ie.Uint8Array,ku=ks?ks.allocUnsafe:r,Ys=Ku(ut.getPrototypeOf,ut),Wu=ut.create,Yu=_i.propertyIsEnumerable,Js=Bs.splice,Ju=Sn?Sn.isConcatSpreadable:r,Hi=Sn?Sn.iterator:r,qn=Sn?Sn.toStringTag:r,Xs=function(){try{var e=Vn(ut,"defineProperty");return e({},"",{}),e}catch{}}(),yg=ie.clearTimeout!==Xe.clearTimeout&&ie.clearTimeout,vg=ye&&ye.now!==Xe.Date.now&&ye.now,mg=ie.setTimeout!==Xe.setTimeout&&ie.setTimeout,Zs=Vt.ceil,Qs=Vt.floor,To=ut.getOwnPropertySymbols,bg=ks?ks.isBuffer:r,Xu=ie.isFinite,wg=Bs.join,Eg=Ku(ut.keys,ut),Gt=Vt.max,Zt=Vt.min,Sg=ye.now,Ig=ie.parseInt,Zu=Vt.random,Og=Bs.reverse,Ao=Vn(ie,"DataView"),zi=Vn(ie,"Map"),Co=Vn(ie,"Promise"),yi=Vn(ie,"Set"),Bi=Vn(ie,"WeakMap"),Ki=Vn(ut,"create"),ea=Bi&&new Bi,vi={},Pg=Gn(Ao),xg=Gn(zi),Tg=Gn(Co),Ag=Gn(yi),Cg=Gn(Bi),ta=Sn?Sn.prototype:r,Vi=ta?ta.valueOf:r,Qu=ta?ta.toString:r;function I(e){if(At(e)&&!Re(e)&&!(e instanceof Ye)){if(e instanceof Tr)return e;if(it.call(e,"__wrapped__"))return el(e)}return new Tr(e)}var mi=function(){function e(){}return function(n){if(!wt(n))return{};if(Wu)return Wu(n);e.prototype=n;var a=new e;return e.prototype=r,a}}();function ra(){}function Tr(e,n){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=r}I.templateSettings={escape:It,evaluate:Ot,interpolate:bt,variable:"",imports:{_:I}},I.prototype=ra.prototype,I.prototype.constructor=I,Tr.prototype=mi(ra.prototype),Tr.prototype.constructor=Tr;function Ye(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=te,this.__views__=[]}function Ng(){var e=new Ye(this.__wrapped__);return e.__actions__=fr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=fr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=fr(this.__views__),e}function Rg(){if(this.__filtered__){var e=new Ye(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Ug(){var e=this.__wrapped__.value(),n=this.__dir__,a=Re(e),h=n<0,m=a?e.length:0,P=V0(0,m,this.__views__),j=P.start,M=P.end,k=M-j,se=h?M:j-1,ae=this.__iteratees__,ue=ae.length,fe=0,ve=Zt(k,this.__takeCount__);if(!a||!h&&m==k&&ve==k)return Sh(e,this.__actions__);var Ee=[];e:for(;k--&&fe<ve;){se+=n;for(var He=-1,Se=e[se];++He<ue;){var ke=ae[He],Ze=ke.iteratee,wr=ke.type,ar=Ze(Se);if(wr==p)Se=ar;else if(!ar){if(wr==y)continue e;break e}}Ee[fe++]=Se}return Ee}Ye.prototype=mi(ra.prototype),Ye.prototype.constructor=Ye;function Hn(e){var n=-1,a=e==null?0:e.length;for(this.clear();++n<a;){var h=e[n];this.set(h[0],h[1])}}function Dg(){this.__data__=Ki?Ki(null):{},this.size=0}function jg(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}function $g(e){var n=this.__data__;if(Ki){var a=n[e];return a===S?r:a}return it.call(n,e)?n[e]:r}function Fg(e){var n=this.__data__;return Ki?n[e]!==r:it.call(n,e)}function Lg(e,n){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=Ki&&n===r?S:n,this}Hn.prototype.clear=Dg,Hn.prototype.delete=jg,Hn.prototype.get=$g,Hn.prototype.has=Fg,Hn.prototype.set=Lg;function an(e){var n=-1,a=e==null?0:e.length;for(this.clear();++n<a;){var h=e[n];this.set(h[0],h[1])}}function Mg(){this.__data__=[],this.size=0}function qg(e){var n=this.__data__,a=na(n,e);if(a<0)return!1;var h=n.length-1;return a==h?n.pop():Js.call(n,a,1),--this.size,!0}function Hg(e){var n=this.__data__,a=na(n,e);return a<0?r:n[a][1]}function zg(e){return na(this.__data__,e)>-1}function Bg(e,n){var a=this.__data__,h=na(a,e);return h<0?(++this.size,a.push([e,n])):a[h][1]=n,this}an.prototype.clear=Mg,an.prototype.delete=qg,an.prototype.get=Hg,an.prototype.has=zg,an.prototype.set=Bg;function on(e){var n=-1,a=e==null?0:e.length;for(this.clear();++n<a;){var h=e[n];this.set(h[0],h[1])}}function Kg(){this.size=0,this.__data__={hash:new Hn,map:new(zi||an),string:new Hn}}function Vg(e){var n=ga(this,e).delete(e);return this.size-=n?1:0,n}function Gg(e){return ga(this,e).get(e)}function kg(e){return ga(this,e).has(e)}function Wg(e,n){var a=ga(this,e),h=a.size;return a.set(e,n),this.size+=a.size==h?0:1,this}on.prototype.clear=Kg,on.prototype.delete=Vg,on.prototype.get=Gg,on.prototype.has=kg,on.prototype.set=Wg;function zn(e){var n=-1,a=e==null?0:e.length;for(this.__data__=new on;++n<a;)this.add(e[n])}function Yg(e){return this.__data__.set(e,S),this}function Jg(e){return this.__data__.has(e)}zn.prototype.add=zn.prototype.push=Yg,zn.prototype.has=Jg;function Hr(e){var n=this.__data__=new an(e);this.size=n.size}function Xg(){this.__data__=new an,this.size=0}function Zg(e){var n=this.__data__,a=n.delete(e);return this.size=n.size,a}function Qg(e){return this.__data__.get(e)}function e0(e){return this.__data__.has(e)}function t0(e,n){var a=this.__data__;if(a instanceof an){var h=a.__data__;if(!zi||h.length<o-1)return h.push([e,n]),this.size=++a.size,this;a=this.__data__=new on(h)}return a.set(e,n),this.size=a.size,this}Hr.prototype.clear=Xg,Hr.prototype.delete=Zg,Hr.prototype.get=Qg,Hr.prototype.has=e0,Hr.prototype.set=t0;function eh(e,n){var a=Re(e),h=!a&&kn(e),m=!a&&!h&&Tn(e),P=!a&&!h&&!m&&Si(e),j=a||h||m||P,M=j?Io(e.length,lg):[],k=M.length;for(var se in e)(n||it.call(e,se))&&!(j&&(se=="length"||m&&(se=="offset"||se=="parent")||P&&(se=="buffer"||se=="byteLength"||se=="byteOffset")||ln(se,k)))&&M.push(se);return M}function th(e){var n=e.length;return n?e[Ho(0,n-1)]:r}function r0(e,n){return _a(fr(e),Bn(n,0,e.length))}function n0(e){return _a(fr(e))}function No(e,n,a){(a!==r&&!zr(e[n],a)||a===r&&!(n in e))&&cn(e,n,a)}function Gi(e,n,a){var h=e[n];(!(it.call(e,n)&&zr(h,a))||a===r&&!(n in e))&&cn(e,n,a)}function na(e,n){for(var a=e.length;a--;)if(zr(e[a][0],n))return a;return-1}function i0(e,n,a,h){return In(e,function(m,P,j){n(h,m,a(m),j)}),h}function rh(e,n){return e&&Jr(n,Wt(n),e)}function s0(e,n){return e&&Jr(n,pr(n),e)}function cn(e,n,a){n=="__proto__"&&Xs?Xs(e,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[n]=a}function Ro(e,n){for(var a=-1,h=n.length,m=ee(h),P=e==null;++a<h;)m[a]=P?r:fc(e,n[a]);return m}function Bn(e,n,a){return e===e&&(a!==r&&(e=e<=a?e:a),n!==r&&(e=e>=n?e:n)),e}function Ar(e,n,a,h,m,P){var j,M=n&F,k=n&K,se=n&q;if(a&&(j=m?a(e,h,m,P):a(e)),j!==r)return j;if(!wt(e))return e;var ae=Re(e);if(ae){if(j=k0(e),!M)return fr(e,j)}else{var ue=Qt(e),fe=ue==he||ue==pe;if(Tn(e))return Ph(e,M);if(ue==Fe||ue==le||fe&&!m){if(j=k||fe?{}:Vh(e),!M)return k?$0(e,s0(j,e)):j0(e,rh(j,e))}else{if(!st[ue])return m?e:{};j=W0(e,ue,M)}}P||(P=new Hr);var ve=P.get(e);if(ve)return ve;P.set(e,j),bl(e)?e.forEach(function(Se){j.add(Ar(Se,n,a,Se,e,P))}):vl(e)&&e.forEach(function(Se,ke){j.set(ke,Ar(Se,n,a,ke,e,P))});var Ee=se?k?Zo:Xo:k?pr:Wt,He=ae?r:Ee(e);return Pr(He||e,function(Se,ke){He&&(ke=Se,Se=e[ke]),Gi(j,ke,Ar(Se,n,a,ke,e,P))}),j}function a0(e){var n=Wt(e);return function(a){return nh(a,e,n)}}function nh(e,n,a){var h=a.length;if(e==null)return!h;for(e=ut(e);h--;){var m=a[h],P=n[m],j=e[m];if(j===r&&!(m in e)||!P(j))return!1}return!0}function ih(e,n,a){if(typeof e!="function")throw new xr(w);return Qi(function(){e.apply(r,a)},n)}function ki(e,n,a,h){var m=-1,P=qs,j=!0,M=e.length,k=[],se=n.length;if(!M)return k;a&&(n=mt(n,vr(a))),h?(P=vo,j=!1):n.length>=o&&(P=qi,j=!1,n=new zn(n));e:for(;++m<M;){var ae=e[m],ue=a==null?ae:a(ae);if(ae=h||ae!==0?ae:0,j&&ue===ue){for(var fe=se;fe--;)if(n[fe]===ue)continue e;k.push(ae)}else P(n,ue,h)||k.push(ae)}return k}var In=Nh(Yr),sh=Nh(Do,!0);function o0(e,n){var a=!0;return In(e,function(h,m,P){return a=!!n(h,m,P),a}),a}function ia(e,n,a){for(var h=-1,m=e.length;++h<m;){var P=e[h],j=n(P);if(j!=null&&(M===r?j===j&&!br(j):a(j,M)))var M=j,k=P}return k}function c0(e,n,a,h){var m=e.length;for(a=Le(a),a<0&&(a=-a>m?0:m+a),h=h===r||h>m?m:Le(h),h<0&&(h+=m),h=a>h?0:El(h);a<h;)e[a++]=n;return e}function ah(e,n){var a=[];return In(e,function(h,m,P){n(h,m,P)&&a.push(h)}),a}function Jt(e,n,a,h,m){var P=-1,j=e.length;for(a||(a=J0),m||(m=[]);++P<j;){var M=e[P];n>0&&a(M)?n>1?Jt(M,n-1,a,h,m):wn(m,M):h||(m[m.length]=M)}return m}var Uo=Rh(),oh=Rh(!0);function Yr(e,n){return e&&Uo(e,n,Wt)}function Do(e,n){return e&&oh(e,n,Wt)}function sa(e,n){return bn(n,function(a){return fn(e[a])})}function Kn(e,n){n=Pn(n,e);for(var a=0,h=n.length;e!=null&&a<h;)e=e[Xr(n[a++])];return a&&a==h?e:r}function ch(e,n,a){var h=n(e);return Re(e)?h:wn(h,a(e))}function ir(e){return e==null?e===r?qe:Ve:qn&&qn in ut(e)?K0(e):n_(e)}function jo(e,n){return e>n}function u0(e,n){return e!=null&&it.call(e,n)}function h0(e,n){return e!=null&&n in ut(e)}function l0(e,n,a){return e>=Zt(n,a)&&e<Gt(n,a)}function $o(e,n,a){for(var h=a?vo:qs,m=e[0].length,P=e.length,j=P,M=ee(P),k=1/0,se=[];j--;){var ae=e[j];j&&n&&(ae=mt(ae,vr(n))),k=Zt(ae.length,k),M[j]=!a&&(n||m>=120&&ae.length>=120)?new zn(j&&ae):r}ae=e[0];var ue=-1,fe=M[0];e:for(;++ue<m&&se.length<k;){var ve=ae[ue],Ee=n?n(ve):ve;if(ve=a||ve!==0?ve:0,!(fe?qi(fe,Ee):h(se,Ee,a))){for(j=P;--j;){var He=M[j];if(!(He?qi(He,Ee):h(e[j],Ee,a)))continue e}fe&&fe.push(Ee),se.push(ve)}}return se}function f0(e,n,a,h){return Yr(e,function(m,P,j){n(h,a(m),P,j)}),h}function Wi(e,n,a){n=Pn(n,e),e=Yh(e,n);var h=e==null?e:e[Xr(Nr(n))];return h==null?r:kt(h,e,a)}function uh(e){return At(e)&&ir(e)==le}function d0(e){return At(e)&&ir(e)==Ie}function p0(e){return At(e)&&ir(e)==B}function Yi(e,n,a,h,m){return e===n?!0:e==null||n==null||!At(e)&&!At(n)?e!==e&&n!==n:g0(e,n,a,h,Yi,m)}function g0(e,n,a,h,m,P){var j=Re(e),M=Re(n),k=j?be:Qt(e),se=M?be:Qt(n);k=k==le?Fe:k,se=se==le?Fe:se;var ae=k==Fe,ue=se==Fe,fe=k==se;if(fe&&Tn(e)){if(!Tn(n))return!1;j=!0,ae=!1}if(fe&&!ae)return P||(P=new Hr),j||Si(e)?zh(e,n,a,h,m,P):z0(e,n,k,a,h,m,P);if(!(a&H)){var ve=ae&&it.call(e,"__wrapped__"),Ee=ue&&it.call(n,"__wrapped__");if(ve||Ee){var He=ve?e.value():e,Se=Ee?n.value():n;return P||(P=new Hr),m(He,Se,a,h,P)}}return fe?(P||(P=new Hr),B0(e,n,a,h,m,P)):!1}function _0(e){return At(e)&&Qt(e)==Oe}function Fo(e,n,a,h){var m=a.length,P=m,j=!h;if(e==null)return!P;for(e=ut(e);m--;){var M=a[m];if(j&&M[2]?M[1]!==e[M[0]]:!(M[0]in e))return!1}for(;++m<P;){M=a[m];var k=M[0],se=e[k],ae=M[1];if(j&&M[2]){if(se===r&&!(k in e))return!1}else{var ue=new Hr;if(h)var fe=h(se,ae,k,e,n,ue);if(!(fe===r?Yi(ae,se,H|Q,h,ue):fe))return!1}}return!0}function hh(e){if(!wt(e)||Z0(e))return!1;var n=fn(e)?_g:to;return n.test(Gn(e))}function y0(e){return At(e)&&ir(e)==Me}function v0(e){return At(e)&&Qt(e)==Pe}function m0(e){return At(e)&&Ea(e.length)&&!!at[ir(e)]}function lh(e){return typeof e=="function"?e:e==null?gr:typeof e=="object"?Re(e)?ph(e[0],e[1]):dh(e):Ul(e)}function Lo(e){if(!Zi(e))return Eg(e);var n=[];for(var a in ut(e))it.call(e,a)&&a!="constructor"&&n.push(a);return n}function b0(e){if(!wt(e))return r_(e);var n=Zi(e),a=[];for(var h in e)h=="constructor"&&(n||!it.call(e,h))||a.push(h);return a}function Mo(e,n){return e<n}function fh(e,n){var a=-1,h=dr(e)?ee(e.length):[];return In(e,function(m,P,j){h[++a]=n(m,P,j)}),h}function dh(e){var n=ec(e);return n.length==1&&n[0][2]?kh(n[0][0],n[0][1]):function(a){return a===e||Fo(a,e,n)}}function ph(e,n){return rc(e)&&Gh(n)?kh(Xr(e),n):function(a){var h=fc(a,e);return h===r&&h===n?dc(a,e):Yi(n,h,H|Q)}}function aa(e,n,a,h,m){e!==n&&Uo(n,function(P,j){if(m||(m=new Hr),wt(P))w0(e,n,j,a,aa,h,m);else{var M=h?h(ic(e,j),P,j+"",e,n,m):r;M===r&&(M=P),No(e,j,M)}},pr)}function w0(e,n,a,h,m,P,j){var M=ic(e,a),k=ic(n,a),se=j.get(k);if(se){No(e,a,se);return}var ae=P?P(M,k,a+"",e,n,j):r,ue=ae===r;if(ue){var fe=Re(k),ve=!fe&&Tn(k),Ee=!fe&&!ve&&Si(k);ae=k,fe||ve||Ee?Re(M)?ae=M:Ut(M)?ae=fr(M):ve?(ue=!1,ae=Ph(k,!0)):Ee?(ue=!1,ae=xh(k,!0)):ae=[]:es(k)||kn(k)?(ae=M,kn(M)?ae=Sl(M):(!wt(M)||fn(M))&&(ae=Vh(k))):ue=!1}ue&&(j.set(k,ae),m(ae,k,h,P,j),j.delete(k)),No(e,a,ae)}function gh(e,n){var a=e.length;if(a)return n+=n<0?a:0,ln(n,a)?e[n]:r}function _h(e,n,a){n.length?n=mt(n,function(P){return Re(P)?function(j){return Kn(j,P.length===1?P[0]:P)}:P}):n=[gr];var h=-1;n=mt(n,vr(we()));var m=fh(e,function(P,j,M){var k=mt(n,function(se){return se(P)});return{criteria:k,index:++h,value:P}});return Wp(m,function(P,j){return D0(P,j,a)})}function E0(e,n){return yh(e,n,function(a,h){return dc(e,h)})}function yh(e,n,a){for(var h=-1,m=n.length,P={};++h<m;){var j=n[h],M=Kn(e,j);a(M,j)&&Ji(P,Pn(j,e),M)}return P}function S0(e){return function(n){return Kn(n,e)}}function qo(e,n,a,h){var m=h?kp:fi,P=-1,j=n.length,M=e;for(e===n&&(n=fr(n)),a&&(M=mt(e,vr(a)));++P<j;)for(var k=0,se=n[P],ae=a?a(se):se;(k=m(M,ae,k,h))>-1;)M!==e&&Js.call(M,k,1),Js.call(e,k,1);return e}function vh(e,n){for(var a=e?n.length:0,h=a-1;a--;){var m=n[a];if(a==h||m!==P){var P=m;ln(m)?Js.call(e,m,1):Ko(e,m)}}return e}function Ho(e,n){return e+Qs(Zu()*(n-e+1))}function I0(e,n,a,h){for(var m=-1,P=Gt(Zs((n-e)/(a||1)),0),j=ee(P);P--;)j[h?P:++m]=e,e+=a;return j}function zo(e,n){var a="";if(!e||n<1||n>W)return a;do n%2&&(a+=e),n=Qs(n/2),n&&(e+=e);while(n);return a}function Ke(e,n){return sc(Wh(e,n,gr),e+"")}function O0(e){return th(Ii(e))}function P0(e,n){var a=Ii(e);return _a(a,Bn(n,0,a.length))}function Ji(e,n,a,h){if(!wt(e))return e;n=Pn(n,e);for(var m=-1,P=n.length,j=P-1,M=e;M!=null&&++m<P;){var k=Xr(n[m]),se=a;if(k==="__proto__"||k==="constructor"||k==="prototype")return e;if(m!=j){var ae=M[k];se=h?h(ae,k,M):r,se===r&&(se=wt(ae)?ae:ln(n[m+1])?[]:{})}Gi(M,k,se),M=M[k]}return e}var mh=ea?function(e,n){return ea.set(e,n),e}:gr,x0=Xs?function(e,n){return Xs(e,"toString",{configurable:!0,enumerable:!1,value:gc(n),writable:!0})}:gr;function T0(e){return _a(Ii(e))}function Cr(e,n,a){var h=-1,m=e.length;n<0&&(n=-n>m?0:m+n),a=a>m?m:a,a<0&&(a+=m),m=n>a?0:a-n>>>0,n>>>=0;for(var P=ee(m);++h<m;)P[h]=e[h+n];return P}function A0(e,n){var a;return In(e,function(h,m,P){return a=n(h,m,P),!a}),!!a}function oa(e,n,a){var h=0,m=e==null?h:e.length;if(typeof n=="number"&&n===n&&m<=ne){for(;h<m;){var P=h+m>>>1,j=e[P];j!==null&&!br(j)&&(a?j<=n:j<n)?h=P+1:m=P}return m}return Bo(e,n,gr,a)}function Bo(e,n,a,h){var m=0,P=e==null?0:e.length;if(P===0)return 0;n=a(n);for(var j=n!==n,M=n===null,k=br(n),se=n===r;m<P;){var ae=Qs((m+P)/2),ue=a(e[ae]),fe=ue!==r,ve=ue===null,Ee=ue===ue,He=br(ue);if(j)var Se=h||Ee;else se?Se=Ee&&(h||fe):M?Se=Ee&&fe&&(h||!ve):k?Se=Ee&&fe&&!ve&&(h||!He):ve||He?Se=!1:Se=h?ue<=n:ue<n;Se?m=ae+1:P=ae}return Zt(P,re)}function bh(e,n){for(var a=-1,h=e.length,m=0,P=[];++a<h;){var j=e[a],M=n?n(j):j;if(!a||!zr(M,k)){var k=M;P[m++]=j===0?0:j}}return P}function wh(e){return typeof e=="number"?e:br(e)?z:+e}function mr(e){if(typeof e=="string")return e;if(Re(e))return mt(e,mr)+"";if(br(e))return Qu?Qu.call(e):"";var n=e+"";return n=="0"&&1/e==-L?"-0":n}function On(e,n,a){var h=-1,m=qs,P=e.length,j=!0,M=[],k=M;if(a)j=!1,m=vo;else if(P>=o){var se=n?null:q0(e);if(se)return zs(se);j=!1,m=qi,k=new zn}else k=n?[]:M;e:for(;++h<P;){var ae=e[h],ue=n?n(ae):ae;if(ae=a||ae!==0?ae:0,j&&ue===ue){for(var fe=k.length;fe--;)if(k[fe]===ue)continue e;n&&k.push(ue),M.push(ae)}else m(k,ue,a)||(k!==M&&k.push(ue),M.push(ae))}return M}function Ko(e,n){return n=Pn(n,e),e=Yh(e,n),e==null||delete e[Xr(Nr(n))]}function Eh(e,n,a,h){return Ji(e,n,a(Kn(e,n)),h)}function ca(e,n,a,h){for(var m=e.length,P=h?m:-1;(h?P--:++P<m)&&n(e[P],P,e););return a?Cr(e,h?0:P,h?P+1:m):Cr(e,h?P+1:0,h?m:P)}function Sh(e,n){var a=e;return a instanceof Ye&&(a=a.value()),mo(n,function(h,m){return m.func.apply(m.thisArg,wn([h],m.args))},a)}function Vo(e,n,a){var h=e.length;if(h<2)return h?On(e[0]):[];for(var m=-1,P=ee(h);++m<h;)for(var j=e[m],M=-1;++M<h;)M!=m&&(P[m]=ki(P[m]||j,e[M],n,a));return On(Jt(P,1),n,a)}function Ih(e,n,a){for(var h=-1,m=e.length,P=n.length,j={};++h<m;){var M=h<P?n[h]:r;a(j,e[h],M)}return j}function Go(e){return Ut(e)?e:[]}function ko(e){return typeof e=="function"?e:gr}function Pn(e,n){return Re(e)?e:rc(e,n)?[e]:Qh(nt(e))}var C0=Ke;function xn(e,n,a){var h=e.length;return a=a===r?h:a,!n&&a>=h?e:Cr(e,n,a)}var Oh=yg||function(e){return Xe.clearTimeout(e)};function Ph(e,n){if(n)return e.slice();var a=e.length,h=ku?ku(a):new e.constructor(a);return e.copy(h),h}function Wo(e){var n=new e.constructor(e.byteLength);return new Ws(n).set(new Ws(e)),n}function N0(e,n){var a=n?Wo(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function R0(e){var n=new e.constructor(e.source,Ir.exec(e));return n.lastIndex=e.lastIndex,n}function U0(e){return Vi?ut(Vi.call(e)):{}}function xh(e,n){var a=n?Wo(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function Th(e,n){if(e!==n){var a=e!==r,h=e===null,m=e===e,P=br(e),j=n!==r,M=n===null,k=n===n,se=br(n);if(!M&&!se&&!P&&e>n||P&&j&&k&&!M&&!se||h&&j&&k||!a&&k||!m)return 1;if(!h&&!P&&!se&&e<n||se&&a&&m&&!h&&!P||M&&a&&m||!j&&m||!k)return-1}return 0}function D0(e,n,a){for(var h=-1,m=e.criteria,P=n.criteria,j=m.length,M=a.length;++h<j;){var k=Th(m[h],P[h]);if(k){if(h>=M)return k;var se=a[h];return k*(se=="desc"?-1:1)}}return e.index-n.index}function Ah(e,n,a,h){for(var m=-1,P=e.length,j=a.length,M=-1,k=n.length,se=Gt(P-j,0),ae=ee(k+se),ue=!h;++M<k;)ae[M]=n[M];for(;++m<j;)(ue||m<P)&&(ae[a[m]]=e[m]);for(;se--;)ae[M++]=e[m++];return ae}function Ch(e,n,a,h){for(var m=-1,P=e.length,j=-1,M=a.length,k=-1,se=n.length,ae=Gt(P-M,0),ue=ee(ae+se),fe=!h;++m<ae;)ue[m]=e[m];for(var ve=m;++k<se;)ue[ve+k]=n[k];for(;++j<M;)(fe||m<P)&&(ue[ve+a[j]]=e[m++]);return ue}function fr(e,n){var a=-1,h=e.length;for(n||(n=ee(h));++a<h;)n[a]=e[a];return n}function Jr(e,n,a,h){var m=!a;a||(a={});for(var P=-1,j=n.length;++P<j;){var M=n[P],k=h?h(a[M],e[M],M,a,e):r;k===r&&(k=e[M]),m?cn(a,M,k):Gi(a,M,k)}return a}function j0(e,n){return Jr(e,tc(e),n)}function $0(e,n){return Jr(e,Bh(e),n)}function ua(e,n){return function(a,h){var m=Re(a)?Hp:i0,P=n?n():{};return m(a,e,we(h,2),P)}}function bi(e){return Ke(function(n,a){var h=-1,m=a.length,P=m>1?a[m-1]:r,j=m>2?a[2]:r;for(P=e.length>3&&typeof P=="function"?(m--,P):r,j&&sr(a[0],a[1],j)&&(P=m<3?r:P,m=1),n=ut(n);++h<m;){var M=a[h];M&&e(n,M,h,P)}return n})}function Nh(e,n){return function(a,h){if(a==null)return a;if(!dr(a))return e(a,h);for(var m=a.length,P=n?m:-1,j=ut(a);(n?P--:++P<m)&&h(j[P],P,j)!==!1;);return a}}function Rh(e){return function(n,a,h){for(var m=-1,P=ut(n),j=h(n),M=j.length;M--;){var k=j[e?M:++m];if(a(P[k],k,P)===!1)break}return n}}function F0(e,n,a){var h=n&J,m=Xi(e);function P(){var j=this&&this!==Xe&&this instanceof P?m:e;return j.apply(h?a:this,arguments)}return P}function Uh(e){return function(n){n=nt(n);var a=di(n)?qr(n):r,h=a?a[0]:n.charAt(0),m=a?xn(a,1).join(""):n.slice(1);return h[e]()+m}}function wi(e){return function(n){return mo(Nl(Cl(n).replace(Li,"")),e,"")}}function Xi(e){return function(){var n=arguments;switch(n.length){case 0:return new e;case 1:return new e(n[0]);case 2:return new e(n[0],n[1]);case 3:return new e(n[0],n[1],n[2]);case 4:return new e(n[0],n[1],n[2],n[3]);case 5:return new e(n[0],n[1],n[2],n[3],n[4]);case 6:return new e(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new e(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=mi(e.prototype),h=e.apply(a,n);return wt(h)?h:a}}function L0(e,n,a){var h=Xi(e);function m(){for(var P=arguments.length,j=ee(P),M=P,k=Ei(m);M--;)j[M]=arguments[M];var se=P<3&&j[0]!==k&&j[P-1]!==k?[]:En(j,k);if(P-=se.length,P<a)return Lh(e,n,ha,m.placeholder,r,j,se,r,r,a-P);var ae=this&&this!==Xe&&this instanceof m?h:e;return kt(ae,this,j)}return m}function Dh(e){return function(n,a,h){var m=ut(n);if(!dr(n)){var P=we(a,3);n=Wt(n),a=function(M){return P(m[M],M,m)}}var j=e(n,a,h);return j>-1?m[P?n[j]:j]:r}}function jh(e){return hn(function(n){var a=n.length,h=a,m=Tr.prototype.thru;for(e&&n.reverse();h--;){var P=n[h];if(typeof P!="function")throw new xr(w);if(m&&!j&&pa(P)=="wrapper")var j=new Tr([],!0)}for(h=j?h:a;++h<a;){P=n[h];var M=pa(P),k=M=="wrapper"?Qo(P):r;k&&nc(k[0])&&k[1]==(c|C|T|_)&&!k[4].length&&k[9]==1?j=j[pa(k[0])].apply(j,k[3]):j=P.length==1&&nc(P)?j[M]():j.thru(P)}return function(){var se=arguments,ae=se[0];if(j&&se.length==1&&Re(ae))return j.plant(ae).value();for(var ue=0,fe=a?n[ue].apply(this,se):ae;++ue<a;)fe=n[ue].call(this,fe);return fe}})}function ha(e,n,a,h,m,P,j,M,k,se){var ae=n&c,ue=n&J,fe=n&ce,ve=n&(C|O),Ee=n&Z,He=fe?r:Xi(e);function Se(){for(var ke=arguments.length,Ze=ee(ke),wr=ke;wr--;)Ze[wr]=arguments[wr];if(ve)var ar=Ei(Se),Er=Jp(Ze,ar);if(h&&(Ze=Ah(Ze,h,m,ve)),P&&(Ze=Ch(Ze,P,j,ve)),ke-=Er,ve&&ke<se){var Dt=En(Ze,ar);return Lh(e,n,ha,Se.placeholder,a,Ze,Dt,M,k,se-ke)}var Br=ue?a:this,pn=fe?Br[e]:e;return ke=Ze.length,M?Ze=i_(Ze,M):Ee&&ke>1&&Ze.reverse(),ae&&k<ke&&(Ze.length=k),this&&this!==Xe&&this instanceof Se&&(pn=He||Xi(pn)),pn.apply(Br,Ze)}return Se}function $h(e,n){return function(a,h){return f0(a,e,n(h),{})}}function la(e,n){return function(a,h){var m;if(a===r&&h===r)return n;if(a!==r&&(m=a),h!==r){if(m===r)return h;typeof a=="string"||typeof h=="string"?(a=mr(a),h=mr(h)):(a=wh(a),h=wh(h)),m=e(a,h)}return m}}function Yo(e){return hn(function(n){return n=mt(n,vr(we())),Ke(function(a){var h=this;return e(n,function(m){return kt(m,h,a)})})})}function fa(e,n){n=n===r?" ":mr(n);var a=n.length;if(a<2)return a?zo(n,e):n;var h=zo(n,Zs(e/pi(n)));return di(n)?xn(qr(h),0,e).join(""):h.slice(0,e)}function M0(e,n,a,h){var m=n&J,P=Xi(e);function j(){for(var M=-1,k=arguments.length,se=-1,ae=h.length,ue=ee(ae+k),fe=this&&this!==Xe&&this instanceof j?P:e;++se<ae;)ue[se]=h[se];for(;k--;)ue[se++]=arguments[++M];return kt(fe,m?a:this,ue)}return j}function Fh(e){return function(n,a,h){return h&&typeof h!="number"&&sr(n,a,h)&&(a=h=r),n=dn(n),a===r?(a=n,n=0):a=dn(a),h=h===r?n<a?1:-1:dn(h),I0(n,a,h,e)}}function da(e){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=Rr(n),a=Rr(a)),e(n,a)}}function Lh(e,n,a,h,m,P,j,M,k,se){var ae=n&C,ue=ae?j:r,fe=ae?r:j,ve=ae?P:r,Ee=ae?r:P;n|=ae?T:b,n&=~(ae?b:T),n&x||(n&=~(J|ce));var He=[e,n,m,ve,ue,Ee,fe,M,k,se],Se=a.apply(r,He);return nc(e)&&Jh(Se,He),Se.placeholder=h,Xh(Se,e,n)}function Jo(e){var n=Vt[e];return function(a,h){if(a=Rr(a),h=h==null?0:Zt(Le(h),292),h&&Xu(a)){var m=(nt(a)+"e").split("e"),P=n(m[0]+"e"+(+m[1]+h));return m=(nt(P)+"e").split("e"),+(m[0]+"e"+(+m[1]-h))}return n(a)}}var q0=yi&&1/zs(new yi([,-0]))[1]==L?function(e){return new yi(e)}:vc;function Mh(e){return function(n){var a=Qt(n);return a==Oe?Po(n):a==Pe?ng(n):Yp(n,e(n))}}function un(e,n,a,h,m,P,j,M){var k=n&ce;if(!k&&typeof e!="function")throw new xr(w);var se=h?h.length:0;if(se||(n&=~(T|b),h=m=r),j=j===r?j:Gt(Le(j),0),M=M===r?M:Le(M),se-=m?m.length:0,n&b){var ae=h,ue=m;h=m=r}var fe=k?r:Qo(e),ve=[e,n,a,h,m,ae,ue,P,j,M];if(fe&&t_(ve,fe),e=ve[0],n=ve[1],a=ve[2],h=ve[3],m=ve[4],M=ve[9]=ve[9]===r?k?0:e.length:Gt(ve[9]-se,0),!M&&n&(C|O)&&(n&=~(C|O)),!n||n==J)var Ee=F0(e,n,a);else n==C||n==O?Ee=L0(e,n,M):(n==T||n==(J|T))&&!m.length?Ee=M0(e,n,a,h):Ee=ha.apply(r,ve);var He=fe?mh:Jh;return Xh(He(Ee,ve),e,n)}function qh(e,n,a,h){return e===r||zr(e,_i[a])&&!it.call(h,a)?n:e}function Hh(e,n,a,h,m,P){return wt(e)&&wt(n)&&(P.set(n,e),aa(e,n,r,Hh,P),P.delete(n)),e}function H0(e){return es(e)?r:e}function zh(e,n,a,h,m,P){var j=a&H,M=e.length,k=n.length;if(M!=k&&!(j&&k>M))return!1;var se=P.get(e),ae=P.get(n);if(se&&ae)return se==n&&ae==e;var ue=-1,fe=!0,ve=a&Q?new zn:r;for(P.set(e,n),P.set(n,e);++ue<M;){var Ee=e[ue],He=n[ue];if(h)var Se=j?h(He,Ee,ue,n,e,P):h(Ee,He,ue,e,n,P);if(Se!==r){if(Se)continue;fe=!1;break}if(ve){if(!bo(n,function(ke,Ze){if(!qi(ve,Ze)&&(Ee===ke||m(Ee,ke,a,h,P)))return ve.push(Ze)})){fe=!1;break}}else if(!(Ee===He||m(Ee,He,a,h,P))){fe=!1;break}}return P.delete(e),P.delete(n),fe}function z0(e,n,a,h,m,P,j){switch(a){case Ae:if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case Ie:return!(e.byteLength!=n.byteLength||!P(new Ws(e),new Ws(n)));case Y:case B:case ze:return zr(+e,+n);case $:return e.name==n.name&&e.message==n.message;case Me:case Ue:return e==n+"";case Oe:var M=Po;case Pe:var k=h&H;if(M||(M=zs),e.size!=n.size&&!k)return!1;var se=j.get(e);if(se)return se==n;h|=Q,j.set(e,n);var ae=zh(M(e),M(n),h,m,P,j);return j.delete(e),ae;case De:if(Vi)return Vi.call(e)==Vi.call(n)}return!1}function B0(e,n,a,h,m,P){var j=a&H,M=Xo(e),k=M.length,se=Xo(n),ae=se.length;if(k!=ae&&!j)return!1;for(var ue=k;ue--;){var fe=M[ue];if(!(j?fe in n:it.call(n,fe)))return!1}var ve=P.get(e),Ee=P.get(n);if(ve&&Ee)return ve==n&&Ee==e;var He=!0;P.set(e,n),P.set(n,e);for(var Se=j;++ue<k;){fe=M[ue];var ke=e[fe],Ze=n[fe];if(h)var wr=j?h(Ze,ke,fe,n,e,P):h(ke,Ze,fe,e,n,P);if(!(wr===r?ke===Ze||m(ke,Ze,a,h,P):wr)){He=!1;break}Se||(Se=fe=="constructor")}if(He&&!Se){var ar=e.constructor,Er=n.constructor;ar!=Er&&"constructor"in e&&"constructor"in n&&!(typeof ar=="function"&&ar instanceof ar&&typeof Er=="function"&&Er instanceof Er)&&(He=!1)}return P.delete(e),P.delete(n),He}function hn(e){return sc(Wh(e,r,nl),e+"")}function Xo(e){return ch(e,Wt,tc)}function Zo(e){return ch(e,pr,Bh)}var Qo=ea?function(e){return ea.get(e)}:vc;function pa(e){for(var n=e.name+"",a=vi[n],h=it.call(vi,n)?a.length:0;h--;){var m=a[h],P=m.func;if(P==null||P==e)return m.name}return n}function Ei(e){var n=it.call(I,"placeholder")?I:e;return n.placeholder}function we(){var e=I.iteratee||_c;return e=e===_c?lh:e,arguments.length?e(arguments[0],arguments[1]):e}function ga(e,n){var a=e.__data__;return X0(n)?a[typeof n=="string"?"string":"hash"]:a.map}function ec(e){for(var n=Wt(e),a=n.length;a--;){var h=n[a],m=e[h];n[a]=[h,m,Gh(m)]}return n}function Vn(e,n){var a=eg(e,n);return hh(a)?a:r}function K0(e){var n=it.call(e,qn),a=e[qn];try{e[qn]=r;var h=!0}catch{}var m=Gs.call(e);return h&&(n?e[qn]=a:delete e[qn]),m}var tc=To?function(e){return e==null?[]:(e=ut(e),bn(To(e),function(n){return Yu.call(e,n)}))}:mc,Bh=To?function(e){for(var n=[];e;)wn(n,tc(e)),e=Ys(e);return n}:mc,Qt=ir;(Ao&&Qt(new Ao(new ArrayBuffer(1)))!=Ae||zi&&Qt(new zi)!=Oe||Co&&Qt(Co.resolve())!=gt||yi&&Qt(new yi)!=Pe||Bi&&Qt(new Bi)!=Te)&&(Qt=function(e){var n=ir(e),a=n==Fe?e.constructor:r,h=a?Gn(a):"";if(h)switch(h){case Pg:return Ae;case xg:return Oe;case Tg:return gt;case Ag:return Pe;case Cg:return Te}return n});function V0(e,n,a){for(var h=-1,m=a.length;++h<m;){var P=a[h],j=P.size;switch(P.type){case"drop":e+=j;break;case"dropRight":n-=j;break;case"take":n=Zt(n,e+j);break;case"takeRight":e=Gt(e,n-j);break}}return{start:e,end:n}}function G0(e){var n=e.match(ht);return n?n[1].split(Mt):[]}function Kh(e,n,a){n=Pn(n,e);for(var h=-1,m=n.length,P=!1;++h<m;){var j=Xr(n[h]);if(!(P=e!=null&&a(e,j)))break;e=e[j]}return P||++h!=m?P:(m=e==null?0:e.length,!!m&&Ea(m)&&ln(j,m)&&(Re(e)||kn(e)))}function k0(e){var n=e.length,a=new e.constructor(n);return n&&typeof e[0]=="string"&&it.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function Vh(e){return typeof e.constructor=="function"&&!Zi(e)?mi(Ys(e)):{}}function W0(e,n,a){var h=e.constructor;switch(n){case Ie:return Wo(e);case Y:case B:return new h(+e);case Ae:return N0(e,a);case Be:case xe:case Ge:case We:case et:case tt:case Je:case tr:case hr:return xh(e,a);case Oe:return new h;case ze:case Ue:return new h(e);case Me:return R0(e);case Pe:return new h;case De:return U0(e)}}function Y0(e,n){var a=n.length;if(!a)return e;var h=a-1;return n[h]=(a>1?"& ":"")+n[h],n=n.join(a>2?", ":" "),e.replace(Tt,`{
/* [wrapped with `+n+`] */
`)}function J0(e){return Re(e)||kn(e)||!!(Ju&&e&&e[Ju])}function ln(e,n){var a=typeof e;return n=n??W,!!n&&(a=="number"||a!="symbol"&&no.test(e))&&e>-1&&e%1==0&&e<n}function sr(e,n,a){if(!wt(a))return!1;var h=typeof n;return(h=="number"?dr(a)&&ln(n,a.length):h=="string"&&n in a)?zr(a[n],e):!1}function rc(e,n){if(Re(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||br(e)?!0:$t.test(e)||!vt.test(e)||n!=null&&e in ut(n)}function X0(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}function nc(e){var n=pa(e),a=I[n];if(typeof a!="function"||!(n in Ye.prototype))return!1;if(e===a)return!0;var h=Qo(a);return!!h&&e===h[0]}function Z0(e){return!!Gu&&Gu in e}var Q0=Ks?fn:bc;function Zi(e){var n=e&&e.constructor,a=typeof n=="function"&&n.prototype||_i;return e===a}function Gh(e){return e===e&&!wt(e)}function kh(e,n){return function(a){return a==null?!1:a[e]===n&&(n!==r||e in ut(a))}}function e_(e){var n=ba(e,function(h){return a.size===U&&a.clear(),h}),a=n.cache;return n}function t_(e,n){var a=e[1],h=n[1],m=a|h,P=m<(J|ce|c),j=h==c&&a==C||h==c&&a==_&&e[7].length<=n[8]||h==(c|_)&&n[7].length<=n[8]&&a==C;if(!(P||j))return e;h&J&&(e[2]=n[2],m|=a&J?0:x);var M=n[3];if(M){var k=e[3];e[3]=k?Ah(k,M,n[4]):M,e[4]=k?En(e[3],R):n[4]}return M=n[5],M&&(k=e[5],e[5]=k?Ch(k,M,n[6]):M,e[6]=k?En(e[5],R):n[6]),M=n[7],M&&(e[7]=M),h&c&&(e[8]=e[8]==null?n[8]:Zt(e[8],n[8])),e[9]==null&&(e[9]=n[9]),e[0]=n[0],e[1]=m,e}function r_(e){var n=[];if(e!=null)for(var a in ut(e))n.push(a);return n}function n_(e){return Gs.call(e)}function Wh(e,n,a){return n=Gt(n===r?e.length-1:n,0),function(){for(var h=arguments,m=-1,P=Gt(h.length-n,0),j=ee(P);++m<P;)j[m]=h[n+m];m=-1;for(var M=ee(n+1);++m<n;)M[m]=h[m];return M[n]=a(j),kt(e,this,M)}}function Yh(e,n){return n.length<2?e:Kn(e,Cr(n,0,-1))}function i_(e,n){for(var a=e.length,h=Zt(n.length,a),m=fr(e);h--;){var P=n[h];e[h]=ln(P,a)?m[P]:r}return e}function ic(e,n){if(!(n==="constructor"&&typeof e[n]=="function")&&n!="__proto__")return e[n]}var Jh=Zh(mh),Qi=mg||function(e,n){return Xe.setTimeout(e,n)},sc=Zh(x0);function Xh(e,n,a){var h=n+"";return sc(e,Y0(h,s_(G0(h),a)))}function Zh(e){var n=0,a=0;return function(){var h=Sg(),m=E-(h-a);if(a=h,m>0){if(++n>=d)return arguments[0]}else n=0;return e.apply(r,arguments)}}function _a(e,n){var a=-1,h=e.length,m=h-1;for(n=n===r?h:n;++a<n;){var P=Ho(a,m),j=e[P];e[P]=e[a],e[a]=j}return e.length=n,e}var Qh=e_(function(e){var n=[];return e.charCodeAt(0)===46&&n.push(""),e.replace(Ft,function(a,h,m,P){n.push(m?P.replace(Xa,"$1"):h||a)}),n});function Xr(e){if(typeof e=="string"||br(e))return e;var n=e+"";return n=="0"&&1/e==-L?"-0":n}function Gn(e){if(e!=null){try{return Vs.call(e)}catch{}try{return e+""}catch{}}return""}function s_(e,n){return Pr(ge,function(a){var h="_."+a[0];n&a[1]&&!qs(e,h)&&e.push(h)}),e.sort()}function el(e){if(e instanceof Ye)return e.clone();var n=new Tr(e.__wrapped__,e.__chain__);return n.__actions__=fr(e.__actions__),n.__index__=e.__index__,n.__values__=e.__values__,n}function a_(e,n,a){(a?sr(e,n,a):n===r)?n=1:n=Gt(Le(n),0);var h=e==null?0:e.length;if(!h||n<1)return[];for(var m=0,P=0,j=ee(Zs(h/n));m<h;)j[P++]=Cr(e,m,m+=n);return j}function o_(e){for(var n=-1,a=e==null?0:e.length,h=0,m=[];++n<a;){var P=e[n];P&&(m[h++]=P)}return m}function c_(){var e=arguments.length;if(!e)return[];for(var n=ee(e-1),a=arguments[0],h=e;h--;)n[h-1]=arguments[h];return wn(Re(a)?fr(a):[a],Jt(n,1))}var u_=Ke(function(e,n){return Ut(e)?ki(e,Jt(n,1,Ut,!0)):[]}),h_=Ke(function(e,n){var a=Nr(n);return Ut(a)&&(a=r),Ut(e)?ki(e,Jt(n,1,Ut,!0),we(a,2)):[]}),l_=Ke(function(e,n){var a=Nr(n);return Ut(a)&&(a=r),Ut(e)?ki(e,Jt(n,1,Ut,!0),r,a):[]});function f_(e,n,a){var h=e==null?0:e.length;return h?(n=a||n===r?1:Le(n),Cr(e,n<0?0:n,h)):[]}function d_(e,n,a){var h=e==null?0:e.length;return h?(n=a||n===r?1:Le(n),n=h-n,Cr(e,0,n<0?0:n)):[]}function p_(e,n){return e&&e.length?ca(e,we(n,3),!0,!0):[]}function g_(e,n){return e&&e.length?ca(e,we(n,3),!0):[]}function __(e,n,a,h){var m=e==null?0:e.length;return m?(a&&typeof a!="number"&&sr(e,n,a)&&(a=0,h=m),c0(e,n,a,h)):[]}function tl(e,n,a){var h=e==null?0:e.length;if(!h)return-1;var m=a==null?0:Le(a);return m<0&&(m=Gt(h+m,0)),Hs(e,we(n,3),m)}function rl(e,n,a){var h=e==null?0:e.length;if(!h)return-1;var m=h-1;return a!==r&&(m=Le(a),m=a<0?Gt(h+m,0):Zt(m,h-1)),Hs(e,we(n,3),m,!0)}function nl(e){var n=e==null?0:e.length;return n?Jt(e,1):[]}function y_(e){var n=e==null?0:e.length;return n?Jt(e,L):[]}function v_(e,n){var a=e==null?0:e.length;return a?(n=n===r?1:Le(n),Jt(e,n)):[]}function m_(e){for(var n=-1,a=e==null?0:e.length,h={};++n<a;){var m=e[n];h[m[0]]=m[1]}return h}function il(e){return e&&e.length?e[0]:r}function b_(e,n,a){var h=e==null?0:e.length;if(!h)return-1;var m=a==null?0:Le(a);return m<0&&(m=Gt(h+m,0)),fi(e,n,m)}function w_(e){var n=e==null?0:e.length;return n?Cr(e,0,-1):[]}var E_=Ke(function(e){var n=mt(e,Go);return n.length&&n[0]===e[0]?$o(n):[]}),S_=Ke(function(e){var n=Nr(e),a=mt(e,Go);return n===Nr(a)?n=r:a.pop(),a.length&&a[0]===e[0]?$o(a,we(n,2)):[]}),I_=Ke(function(e){var n=Nr(e),a=mt(e,Go);return n=typeof n=="function"?n:r,n&&a.pop(),a.length&&a[0]===e[0]?$o(a,r,n):[]});function O_(e,n){return e==null?"":wg.call(e,n)}function Nr(e){var n=e==null?0:e.length;return n?e[n-1]:r}function P_(e,n,a){var h=e==null?0:e.length;if(!h)return-1;var m=h;return a!==r&&(m=Le(a),m=m<0?Gt(h+m,0):Zt(m,h-1)),n===n?sg(e,n,m):Hs(e,Lu,m,!0)}function x_(e,n){return e&&e.length?gh(e,Le(n)):r}var T_=Ke(sl);function sl(e,n){return e&&e.length&&n&&n.length?qo(e,n):e}function A_(e,n,a){return e&&e.length&&n&&n.length?qo(e,n,we(a,2)):e}function C_(e,n,a){return e&&e.length&&n&&n.length?qo(e,n,r,a):e}var N_=hn(function(e,n){var a=e==null?0:e.length,h=Ro(e,n);return vh(e,mt(n,function(m){return ln(m,a)?+m:m}).sort(Th)),h});function R_(e,n){var a=[];if(!(e&&e.length))return a;var h=-1,m=[],P=e.length;for(n=we(n,3);++h<P;){var j=e[h];n(j,h,e)&&(a.push(j),m.push(h))}return vh(e,m),a}function ac(e){return e==null?e:Og.call(e)}function U_(e,n,a){var h=e==null?0:e.length;return h?(a&&typeof a!="number"&&sr(e,n,a)?(n=0,a=h):(n=n==null?0:Le(n),a=a===r?h:Le(a)),Cr(e,n,a)):[]}function D_(e,n){return oa(e,n)}function j_(e,n,a){return Bo(e,n,we(a,2))}function $_(e,n){var a=e==null?0:e.length;if(a){var h=oa(e,n);if(h<a&&zr(e[h],n))return h}return-1}function F_(e,n){return oa(e,n,!0)}function L_(e,n,a){return Bo(e,n,we(a,2),!0)}function M_(e,n){var a=e==null?0:e.length;if(a){var h=oa(e,n,!0)-1;if(zr(e[h],n))return h}return-1}function q_(e){return e&&e.length?bh(e):[]}function H_(e,n){return e&&e.length?bh(e,we(n,2)):[]}function z_(e){var n=e==null?0:e.length;return n?Cr(e,1,n):[]}function B_(e,n,a){return e&&e.length?(n=a||n===r?1:Le(n),Cr(e,0,n<0?0:n)):[]}function K_(e,n,a){var h=e==null?0:e.length;return h?(n=a||n===r?1:Le(n),n=h-n,Cr(e,n<0?0:n,h)):[]}function V_(e,n){return e&&e.length?ca(e,we(n,3),!1,!0):[]}function G_(e,n){return e&&e.length?ca(e,we(n,3)):[]}var k_=Ke(function(e){return On(Jt(e,1,Ut,!0))}),W_=Ke(function(e){var n=Nr(e);return Ut(n)&&(n=r),On(Jt(e,1,Ut,!0),we(n,2))}),Y_=Ke(function(e){var n=Nr(e);return n=typeof n=="function"?n:r,On(Jt(e,1,Ut,!0),r,n)});function J_(e){return e&&e.length?On(e):[]}function X_(e,n){return e&&e.length?On(e,we(n,2)):[]}function Z_(e,n){return n=typeof n=="function"?n:r,e&&e.length?On(e,r,n):[]}function oc(e){if(!(e&&e.length))return[];var n=0;return e=bn(e,function(a){if(Ut(a))return n=Gt(a.length,n),!0}),Io(n,function(a){return mt(e,wo(a))})}function al(e,n){if(!(e&&e.length))return[];var a=oc(e);return n==null?a:mt(a,function(h){return kt(n,r,h)})}var Q_=Ke(function(e,n){return Ut(e)?ki(e,n):[]}),ey=Ke(function(e){return Vo(bn(e,Ut))}),ty=Ke(function(e){var n=Nr(e);return Ut(n)&&(n=r),Vo(bn(e,Ut),we(n,2))}),ry=Ke(function(e){var n=Nr(e);return n=typeof n=="function"?n:r,Vo(bn(e,Ut),r,n)}),ny=Ke(oc);function iy(e,n){return Ih(e||[],n||[],Gi)}function sy(e,n){return Ih(e||[],n||[],Ji)}var ay=Ke(function(e){var n=e.length,a=n>1?e[n-1]:r;return a=typeof a=="function"?(e.pop(),a):r,al(e,a)});function ol(e){var n=I(e);return n.__chain__=!0,n}function oy(e,n){return n(e),e}function ya(e,n){return n(e)}var cy=hn(function(e){var n=e.length,a=n?e[0]:0,h=this.__wrapped__,m=function(P){return Ro(P,e)};return n>1||this.__actions__.length||!(h instanceof Ye)||!ln(a)?this.thru(m):(h=h.slice(a,+a+(n?1:0)),h.__actions__.push({func:ya,args:[m],thisArg:r}),new Tr(h,this.__chain__).thru(function(P){return n&&!P.length&&P.push(r),P}))});function uy(){return ol(this)}function hy(){return new Tr(this.value(),this.__chain__)}function ly(){this.__values__===r&&(this.__values__=wl(this.value()));var e=this.__index__>=this.__values__.length,n=e?r:this.__values__[this.__index__++];return{done:e,value:n}}function fy(){return this}function dy(e){for(var n,a=this;a instanceof ra;){var h=el(a);h.__index__=0,h.__values__=r,n?m.__wrapped__=h:n=h;var m=h;a=a.__wrapped__}return m.__wrapped__=e,n}function py(){var e=this.__wrapped__;if(e instanceof Ye){var n=e;return this.__actions__.length&&(n=new Ye(this)),n=n.reverse(),n.__actions__.push({func:ya,args:[ac],thisArg:r}),new Tr(n,this.__chain__)}return this.thru(ac)}function gy(){return Sh(this.__wrapped__,this.__actions__)}var _y=ua(function(e,n,a){it.call(e,a)?++e[a]:cn(e,a,1)});function yy(e,n,a){var h=Re(e)?$u:o0;return a&&sr(e,n,a)&&(n=r),h(e,we(n,3))}function vy(e,n){var a=Re(e)?bn:ah;return a(e,we(n,3))}var my=Dh(tl),by=Dh(rl);function wy(e,n){return Jt(va(e,n),1)}function Ey(e,n){return Jt(va(e,n),L)}function Sy(e,n,a){return a=a===r?1:Le(a),Jt(va(e,n),a)}function cl(e,n){var a=Re(e)?Pr:In;return a(e,we(n,3))}function ul(e,n){var a=Re(e)?zp:sh;return a(e,we(n,3))}var Iy=ua(function(e,n,a){it.call(e,a)?e[a].push(n):cn(e,a,[n])});function Oy(e,n,a,h){e=dr(e)?e:Ii(e),a=a&&!h?Le(a):0;var m=e.length;return a<0&&(a=Gt(m+a,0)),Sa(e)?a<=m&&e.indexOf(n,a)>-1:!!m&&fi(e,n,a)>-1}var Py=Ke(function(e,n,a){var h=-1,m=typeof n=="function",P=dr(e)?ee(e.length):[];return In(e,function(j){P[++h]=m?kt(n,j,a):Wi(j,n,a)}),P}),xy=ua(function(e,n,a){cn(e,a,n)});function va(e,n){var a=Re(e)?mt:fh;return a(e,we(n,3))}function Ty(e,n,a,h){return e==null?[]:(Re(n)||(n=n==null?[]:[n]),a=h?r:a,Re(a)||(a=a==null?[]:[a]),_h(e,n,a))}var Ay=ua(function(e,n,a){e[a?0:1].push(n)},function(){return[[],[]]});function Cy(e,n,a){var h=Re(e)?mo:qu,m=arguments.length<3;return h(e,we(n,4),a,m,In)}function Ny(e,n,a){var h=Re(e)?Bp:qu,m=arguments.length<3;return h(e,we(n,4),a,m,sh)}function Ry(e,n){var a=Re(e)?bn:ah;return a(e,wa(we(n,3)))}function Uy(e){var n=Re(e)?th:O0;return n(e)}function Dy(e,n,a){(a?sr(e,n,a):n===r)?n=1:n=Le(n);var h=Re(e)?r0:P0;return h(e,n)}function jy(e){var n=Re(e)?n0:T0;return n(e)}function $y(e){if(e==null)return 0;if(dr(e))return Sa(e)?pi(e):e.length;var n=Qt(e);return n==Oe||n==Pe?e.size:Lo(e).length}function Fy(e,n,a){var h=Re(e)?bo:A0;return a&&sr(e,n,a)&&(n=r),h(e,we(n,3))}var Ly=Ke(function(e,n){if(e==null)return[];var a=n.length;return a>1&&sr(e,n[0],n[1])?n=[]:a>2&&sr(n[0],n[1],n[2])&&(n=[n[0]]),_h(e,Jt(n,1),[])}),ma=vg||function(){return Xe.Date.now()};function My(e,n){if(typeof n!="function")throw new xr(w);return e=Le(e),function(){if(--e<1)return n.apply(this,arguments)}}function hl(e,n,a){return n=a?r:n,n=e&&n==null?e.length:n,un(e,c,r,r,r,r,n)}function ll(e,n){var a;if(typeof n!="function")throw new xr(w);return e=Le(e),function(){return--e>0&&(a=n.apply(this,arguments)),e<=1&&(n=r),a}}var cc=Ke(function(e,n,a){var h=J;if(a.length){var m=En(a,Ei(cc));h|=T}return un(e,h,n,a,m)}),fl=Ke(function(e,n,a){var h=J|ce;if(a.length){var m=En(a,Ei(fl));h|=T}return un(n,h,e,a,m)});function dl(e,n,a){n=a?r:n;var h=un(e,C,r,r,r,r,r,n);return h.placeholder=dl.placeholder,h}function pl(e,n,a){n=a?r:n;var h=un(e,O,r,r,r,r,r,n);return h.placeholder=pl.placeholder,h}function gl(e,n,a){var h,m,P,j,M,k,se=0,ae=!1,ue=!1,fe=!0;if(typeof e!="function")throw new xr(w);n=Rr(n)||0,wt(a)&&(ae=!!a.leading,ue="maxWait"in a,P=ue?Gt(Rr(a.maxWait)||0,n):P,fe="trailing"in a?!!a.trailing:fe);function ve(Dt){var Br=h,pn=m;return h=m=r,se=Dt,j=e.apply(pn,Br),j}function Ee(Dt){return se=Dt,M=Qi(ke,n),ae?ve(Dt):j}function He(Dt){var Br=Dt-k,pn=Dt-se,Dl=n-Br;return ue?Zt(Dl,P-pn):Dl}function Se(Dt){var Br=Dt-k,pn=Dt-se;return k===r||Br>=n||Br<0||ue&&pn>=P}function ke(){var Dt=ma();if(Se(Dt))return Ze(Dt);M=Qi(ke,He(Dt))}function Ze(Dt){return M=r,fe&&h?ve(Dt):(h=m=r,j)}function wr(){M!==r&&Oh(M),se=0,h=k=m=M=r}function ar(){return M===r?j:Ze(ma())}function Er(){var Dt=ma(),Br=Se(Dt);if(h=arguments,m=this,k=Dt,Br){if(M===r)return Ee(k);if(ue)return Oh(M),M=Qi(ke,n),ve(k)}return M===r&&(M=Qi(ke,n)),j}return Er.cancel=wr,Er.flush=ar,Er}var qy=Ke(function(e,n){return ih(e,1,n)}),Hy=Ke(function(e,n,a){return ih(e,Rr(n)||0,a)});function zy(e){return un(e,Z)}function ba(e,n){if(typeof e!="function"||n!=null&&typeof n!="function")throw new xr(w);var a=function(){var h=arguments,m=n?n.apply(this,h):h[0],P=a.cache;if(P.has(m))return P.get(m);var j=e.apply(this,h);return a.cache=P.set(m,j)||P,j};return a.cache=new(ba.Cache||on),a}ba.Cache=on;function wa(e){if(typeof e!="function")throw new xr(w);return function(){var n=arguments;switch(n.length){case 0:return!e.call(this);case 1:return!e.call(this,n[0]);case 2:return!e.call(this,n[0],n[1]);case 3:return!e.call(this,n[0],n[1],n[2])}return!e.apply(this,n)}}function By(e){return ll(2,e)}var Ky=C0(function(e,n){n=n.length==1&&Re(n[0])?mt(n[0],vr(we())):mt(Jt(n,1),vr(we()));var a=n.length;return Ke(function(h){for(var m=-1,P=Zt(h.length,a);++m<P;)h[m]=n[m].call(this,h[m]);return kt(e,this,h)})}),uc=Ke(function(e,n){var a=En(n,Ei(uc));return un(e,T,r,n,a)}),_l=Ke(function(e,n){var a=En(n,Ei(_l));return un(e,b,r,n,a)}),Vy=hn(function(e,n){return un(e,_,r,r,r,n)});function Gy(e,n){if(typeof e!="function")throw new xr(w);return n=n===r?n:Le(n),Ke(e,n)}function ky(e,n){if(typeof e!="function")throw new xr(w);return n=n==null?0:Gt(Le(n),0),Ke(function(a){var h=a[n],m=xn(a,0,n);return h&&wn(m,h),kt(e,this,m)})}function Wy(e,n,a){var h=!0,m=!0;if(typeof e!="function")throw new xr(w);return wt(a)&&(h="leading"in a?!!a.leading:h,m="trailing"in a?!!a.trailing:m),gl(e,n,{leading:h,maxWait:n,trailing:m})}function Yy(e){return hl(e,1)}function Jy(e,n){return uc(ko(n),e)}function Xy(){if(!arguments.length)return[];var e=arguments[0];return Re(e)?e:[e]}function Zy(e){return Ar(e,q)}function Qy(e,n){return n=typeof n=="function"?n:r,Ar(e,q,n)}function e1(e){return Ar(e,F|q)}function t1(e,n){return n=typeof n=="function"?n:r,Ar(e,F|q,n)}function r1(e,n){return n==null||nh(e,n,Wt(n))}function zr(e,n){return e===n||e!==e&&n!==n}var n1=da(jo),i1=da(function(e,n){return e>=n}),kn=uh(function(){return arguments}())?uh:function(e){return At(e)&&it.call(e,"callee")&&!Yu.call(e,"callee")},Re=ee.isArray,s1=nr?vr(nr):d0;function dr(e){return e!=null&&Ea(e.length)&&!fn(e)}function Ut(e){return At(e)&&dr(e)}function a1(e){return e===!0||e===!1||At(e)&&ir(e)==Y}var Tn=bg||bc,o1=Mr?vr(Mr):p0;function c1(e){return At(e)&&e.nodeType===1&&!es(e)}function u1(e){if(e==null)return!0;if(dr(e)&&(Re(e)||typeof e=="string"||typeof e.splice=="function"||Tn(e)||Si(e)||kn(e)))return!e.length;var n=Qt(e);if(n==Oe||n==Pe)return!e.size;if(Zi(e))return!Lo(e).length;for(var a in e)if(it.call(e,a))return!1;return!0}function h1(e,n){return Yi(e,n)}function l1(e,n,a){a=typeof a=="function"?a:r;var h=a?a(e,n):r;return h===r?Yi(e,n,r,a):!!h}function hc(e){if(!At(e))return!1;var n=ir(e);return n==$||n==l||typeof e.message=="string"&&typeof e.name=="string"&&!es(e)}function f1(e){return typeof e=="number"&&Xu(e)}function fn(e){if(!wt(e))return!1;var n=ir(e);return n==he||n==pe||n==X||n==_t}function yl(e){return typeof e=="number"&&e==Le(e)}function Ea(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=W}function wt(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}function At(e){return e!=null&&typeof e=="object"}var vl=Or?vr(Or):_0;function d1(e,n){return e===n||Fo(e,n,ec(n))}function p1(e,n,a){return a=typeof a=="function"?a:r,Fo(e,n,ec(n),a)}function g1(e){return ml(e)&&e!=+e}function _1(e){if(Q0(e))throw new Ce(g);return hh(e)}function y1(e){return e===null}function v1(e){return e==null}function ml(e){return typeof e=="number"||At(e)&&ir(e)==ze}function es(e){if(!At(e)||ir(e)!=Fe)return!1;var n=Ys(e);if(n===null)return!0;var a=it.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&Vs.call(a)==pg}var lc=Wr?vr(Wr):y0;function m1(e){return yl(e)&&e>=-W&&e<=W}var bl=Mi?vr(Mi):v0;function Sa(e){return typeof e=="string"||!Re(e)&&At(e)&&ir(e)==Ue}function br(e){return typeof e=="symbol"||At(e)&&ir(e)==De}var Si=Mn?vr(Mn):m0;function b1(e){return e===r}function w1(e){return At(e)&&Qt(e)==Te}function E1(e){return At(e)&&ir(e)==je}var S1=da(Mo),I1=da(function(e,n){return e<=n});function wl(e){if(!e)return[];if(dr(e))return Sa(e)?qr(e):fr(e);if(Hi&&e[Hi])return rg(e[Hi]());var n=Qt(e),a=n==Oe?Po:n==Pe?zs:Ii;return a(e)}function dn(e){if(!e)return e===0?e:0;if(e=Rr(e),e===L||e===-L){var n=e<0?-1:1;return n*A}return e===e?e:0}function Le(e){var n=dn(e),a=n%1;return n===n?a?n-a:n:0}function El(e){return e?Bn(Le(e),0,te):0}function Rr(e){if(typeof e=="number")return e;if(br(e))return z;if(wt(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=wt(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=Hu(e);var a=eo.test(e);return a||ro.test(e)?Ne(e.slice(2),a?2:8):Qa.test(e)?z:+e}function Sl(e){return Jr(e,pr(e))}function O1(e){return e?Bn(Le(e),-W,W):e===0?e:0}function nt(e){return e==null?"":mr(e)}var P1=bi(function(e,n){if(Zi(n)||dr(n)){Jr(n,Wt(n),e);return}for(var a in n)it.call(n,a)&&Gi(e,a,n[a])}),Il=bi(function(e,n){Jr(n,pr(n),e)}),Ia=bi(function(e,n,a,h){Jr(n,pr(n),e,h)}),x1=bi(function(e,n,a,h){Jr(n,Wt(n),e,h)}),T1=hn(Ro);function A1(e,n){var a=mi(e);return n==null?a:rh(a,n)}var C1=Ke(function(e,n){e=ut(e);var a=-1,h=n.length,m=h>2?n[2]:r;for(m&&sr(n[0],n[1],m)&&(h=1);++a<h;)for(var P=n[a],j=pr(P),M=-1,k=j.length;++M<k;){var se=j[M],ae=e[se];(ae===r||zr(ae,_i[se])&&!it.call(e,se))&&(e[se]=P[se])}return e}),N1=Ke(function(e){return e.push(r,Hh),kt(Ol,r,e)});function R1(e,n){return Fu(e,we(n,3),Yr)}function U1(e,n){return Fu(e,we(n,3),Do)}function D1(e,n){return e==null?e:Uo(e,we(n,3),pr)}function j1(e,n){return e==null?e:oh(e,we(n,3),pr)}function $1(e,n){return e&&Yr(e,we(n,3))}function F1(e,n){return e&&Do(e,we(n,3))}function L1(e){return e==null?[]:sa(e,Wt(e))}function M1(e){return e==null?[]:sa(e,pr(e))}function fc(e,n,a){var h=e==null?r:Kn(e,n);return h===r?a:h}function q1(e,n){return e!=null&&Kh(e,n,u0)}function dc(e,n){return e!=null&&Kh(e,n,h0)}var H1=$h(function(e,n,a){n!=null&&typeof n.toString!="function"&&(n=Gs.call(n)),e[n]=a},gc(gr)),z1=$h(function(e,n,a){n!=null&&typeof n.toString!="function"&&(n=Gs.call(n)),it.call(e,n)?e[n].push(a):e[n]=[a]},we),B1=Ke(Wi);function Wt(e){return dr(e)?eh(e):Lo(e)}function pr(e){return dr(e)?eh(e,!0):b0(e)}function K1(e,n){var a={};return n=we(n,3),Yr(e,function(h,m,P){cn(a,n(h,m,P),h)}),a}function V1(e,n){var a={};return n=we(n,3),Yr(e,function(h,m,P){cn(a,m,n(h,m,P))}),a}var G1=bi(function(e,n,a){aa(e,n,a)}),Ol=bi(function(e,n,a,h){aa(e,n,a,h)}),k1=hn(function(e,n){var a={};if(e==null)return a;var h=!1;n=mt(n,function(P){return P=Pn(P,e),h||(h=P.length>1),P}),Jr(e,Zo(e),a),h&&(a=Ar(a,F|K|q,H0));for(var m=n.length;m--;)Ko(a,n[m]);return a});function W1(e,n){return Pl(e,wa(we(n)))}var Y1=hn(function(e,n){return e==null?{}:E0(e,n)});function Pl(e,n){if(e==null)return{};var a=mt(Zo(e),function(h){return[h]});return n=we(n),yh(e,a,function(h,m){return n(h,m[0])})}function J1(e,n,a){n=Pn(n,e);var h=-1,m=n.length;for(m||(m=1,e=r);++h<m;){var P=e==null?r:e[Xr(n[h])];P===r&&(h=m,P=a),e=fn(P)?P.call(e):P}return e}function X1(e,n,a){return e==null?e:Ji(e,n,a)}function Z1(e,n,a,h){return h=typeof h=="function"?h:r,e==null?e:Ji(e,n,a,h)}var xl=Mh(Wt),Tl=Mh(pr);function Q1(e,n,a){var h=Re(e),m=h||Tn(e)||Si(e);if(n=we(n,4),a==null){var P=e&&e.constructor;m?a=h?new P:[]:wt(e)?a=fn(P)?mi(Ys(e)):{}:a={}}return(m?Pr:Yr)(e,function(j,M,k){return n(a,j,M,k)}),a}function ev(e,n){return e==null?!0:Ko(e,n)}function tv(e,n,a){return e==null?e:Eh(e,n,ko(a))}function rv(e,n,a,h){return h=typeof h=="function"?h:r,e==null?e:Eh(e,n,ko(a),h)}function Ii(e){return e==null?[]:Oo(e,Wt(e))}function nv(e){return e==null?[]:Oo(e,pr(e))}function iv(e,n,a){return a===r&&(a=n,n=r),a!==r&&(a=Rr(a),a=a===a?a:0),n!==r&&(n=Rr(n),n=n===n?n:0),Bn(Rr(e),n,a)}function sv(e,n,a){return n=dn(n),a===r?(a=n,n=0):a=dn(a),e=Rr(e),l0(e,n,a)}function av(e,n,a){if(a&&typeof a!="boolean"&&sr(e,n,a)&&(n=a=r),a===r&&(typeof n=="boolean"?(a=n,n=r):typeof e=="boolean"&&(a=e,e=r)),e===r&&n===r?(e=0,n=1):(e=dn(e),n===r?(n=e,e=0):n=dn(n)),e>n){var h=e;e=n,n=h}if(a||e%1||n%1){var m=Zu();return Zt(e+m*(n-e+ot("1e-"+((m+"").length-1))),n)}return Ho(e,n)}var ov=wi(function(e,n,a){return n=n.toLowerCase(),e+(a?Al(n):n)});function Al(e){return pc(nt(e).toLowerCase())}function Cl(e){return e=nt(e),e&&e.replace(nn,Xp).replace(_o,"")}function cv(e,n,a){e=nt(e),n=mr(n);var h=e.length;a=a===r?h:Bn(Le(a),0,h);var m=a;return a-=n.length,a>=0&&e.slice(a,m)==n}function uv(e){return e=nt(e),e&&yt.test(e)?e.replace(Dn,Zp):e}function hv(e){return e=nt(e),e&&Lt.test(e)?e.replace(Pt,"\\$&"):e}var lv=wi(function(e,n,a){return e+(a?"-":"")+n.toLowerCase()}),fv=wi(function(e,n,a){return e+(a?" ":"")+n.toLowerCase()}),dv=Uh("toLowerCase");function pv(e,n,a){e=nt(e),n=Le(n);var h=n?pi(e):0;if(!n||h>=n)return e;var m=(n-h)/2;return fa(Qs(m),a)+e+fa(Zs(m),a)}function gv(e,n,a){e=nt(e),n=Le(n);var h=n?pi(e):0;return n&&h<n?e+fa(n-h,a):e}function _v(e,n,a){e=nt(e),n=Le(n);var h=n?pi(e):0;return n&&h<n?fa(n-h,a)+e:e}function yv(e,n,a){return a||n==null?n=0:n&&(n=+n),Ig(nt(e).replace(xt,""),n||0)}function vv(e,n,a){return(a?sr(e,n,a):n===r)?n=1:n=Le(n),zo(nt(e),n)}function mv(){var e=arguments,n=nt(e[0]);return e.length<3?n:n.replace(e[1],e[2])}var bv=wi(function(e,n,a){return e+(a?"_":"")+n.toLowerCase()});function wv(e,n,a){return a&&typeof a!="number"&&sr(e,n,a)&&(n=a=r),a=a===r?te:a>>>0,a?(e=nt(e),e&&(typeof n=="string"||n!=null&&!lc(n))&&(n=mr(n),!n&&di(e))?xn(qr(e),0,a):e.split(n,a)):[]}var Ev=wi(function(e,n,a){return e+(a?" ":"")+pc(n)});function Sv(e,n,a){return e=nt(e),a=a==null?0:Bn(Le(a),0,e.length),n=mr(n),e.slice(a,a+n.length)==n}function Iv(e,n,a){var h=I.templateSettings;a&&sr(e,n,a)&&(n=r),e=nt(e),n=Ia({},n,h,qh);var m=Ia({},n.imports,h.imports,qh),P=Wt(m),j=Oo(m,P),M,k,se=0,ae=n.interpolate||si,ue="__p += '",fe=xo((n.escape||si).source+"|"+ae.source+"|"+(ae===bt?Za:si).source+"|"+(n.evaluate||si).source+"|$","g"),ve="//# sourceURL="+(it.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++yo+"]")+`
`;e.replace(fe,function(Se,ke,Ze,wr,ar,Er){return Ze||(Ze=wr),ue+=e.slice(se,Er).replace(io,Qp),ke&&(M=!0,ue+=`' +
__e(`+ke+`) +
'`),ar&&(k=!0,ue+=`';
`+ar+`;
__p += '`),Ze&&(ue+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),se=Er+Se.length,Se}),ue+=`';
`;var Ee=it.call(n,"variable")&&n.variable;if(!Ee)ue=`with (obj) {
`+ue+`
}
`;else if(Ja.test(Ee))throw new Ce(v);ue=(k?ue.replace(Gr,""):ue).replace(rr,"$1").replace(rn,"$1;"),ue="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(M?", __e = _.escape":"")+(k?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ue+`return __p
}`;var He=Rl(function(){return rt(P,ve+"return "+ue).apply(r,j)});if(He.source=ue,hc(He))throw He;return He}function Ov(e){return nt(e).toLowerCase()}function Pv(e){return nt(e).toUpperCase()}function xv(e,n,a){if(e=nt(e),e&&(a||n===r))return Hu(e);if(!e||!(n=mr(n)))return e;var h=qr(e),m=qr(n),P=zu(h,m),j=Bu(h,m)+1;return xn(h,P,j).join("")}function Tv(e,n,a){if(e=nt(e),e&&(a||n===r))return e.slice(0,Vu(e)+1);if(!e||!(n=mr(n)))return e;var h=qr(e),m=Bu(h,qr(n))+1;return xn(h,0,m).join("")}function Av(e,n,a){if(e=nt(e),e&&(a||n===r))return e.replace(xt,"");if(!e||!(n=mr(n)))return e;var h=qr(e),m=zu(h,qr(n));return xn(h,m).join("")}function Cv(e,n){var a=u,h=f;if(wt(n)){var m="separator"in n?n.separator:m;a="length"in n?Le(n.length):a,h="omission"in n?mr(n.omission):h}e=nt(e);var P=e.length;if(di(e)){var j=qr(e);P=j.length}if(a>=P)return e;var M=a-pi(h);if(M<1)return h;var k=j?xn(j,0,M).join(""):e.slice(0,M);if(m===r)return k+h;if(j&&(M+=k.length-M),lc(m)){if(e.slice(M).search(m)){var se,ae=k;for(m.global||(m=xo(m.source,nt(Ir.exec(m))+"g")),m.lastIndex=0;se=m.exec(ae);)var ue=se.index;k=k.slice(0,ue===r?M:ue)}}else if(e.indexOf(mr(m),M)!=M){var fe=k.lastIndexOf(m);fe>-1&&(k=k.slice(0,fe))}return k+h}function Nv(e){return e=nt(e),e&&St.test(e)?e.replace(vn,ag):e}var Rv=wi(function(e,n,a){return e+(a?" ":"")+n.toUpperCase()}),pc=Uh("toUpperCase");function Nl(e,n,a){return e=nt(e),n=a?r:n,n===r?tg(e)?ug(e):Gp(e):e.match(n)||[]}var Rl=Ke(function(e,n){try{return kt(e,r,n)}catch(a){return hc(a)?a:new Ce(a)}}),Uv=hn(function(e,n){return Pr(n,function(a){a=Xr(a),cn(e,a,cc(e[a],e))}),e});function Dv(e){var n=e==null?0:e.length,a=we();return e=n?mt(e,function(h){if(typeof h[1]!="function")throw new xr(w);return[a(h[0]),h[1]]}):[],Ke(function(h){for(var m=-1;++m<n;){var P=e[m];if(kt(P[0],this,h))return kt(P[1],this,h)}})}function jv(e){return a0(Ar(e,F))}function gc(e){return function(){return e}}function $v(e,n){return e==null||e!==e?n:e}var Fv=jh(),Lv=jh(!0);function gr(e){return e}function _c(e){return lh(typeof e=="function"?e:Ar(e,F))}function Mv(e){return dh(Ar(e,F))}function qv(e,n){return ph(e,Ar(n,F))}var Hv=Ke(function(e,n){return function(a){return Wi(a,e,n)}}),zv=Ke(function(e,n){return function(a){return Wi(e,a,n)}});function yc(e,n,a){var h=Wt(n),m=sa(n,h);a==null&&!(wt(n)&&(m.length||!h.length))&&(a=n,n=e,e=this,m=sa(n,Wt(n)));var P=!(wt(a)&&"chain"in a)||!!a.chain,j=fn(e);return Pr(m,function(M){var k=n[M];e[M]=k,j&&(e.prototype[M]=function(){var se=this.__chain__;if(P||se){var ae=e(this.__wrapped__),ue=ae.__actions__=fr(this.__actions__);return ue.push({func:k,args:arguments,thisArg:e}),ae.__chain__=se,ae}return k.apply(e,wn([this.value()],arguments))})}),e}function Bv(){return Xe._===this&&(Xe._=gg),this}function vc(){}function Kv(e){return e=Le(e),Ke(function(n){return gh(n,e)})}var Vv=Yo(mt),Gv=Yo($u),kv=Yo(bo);function Ul(e){return rc(e)?wo(Xr(e)):S0(e)}function Wv(e){return function(n){return e==null?r:Kn(e,n)}}var Yv=Fh(),Jv=Fh(!0);function mc(){return[]}function bc(){return!1}function Xv(){return{}}function Zv(){return""}function Qv(){return!0}function em(e,n){if(e=Le(e),e<1||e>W)return[];var a=te,h=Zt(e,te);n=we(n),e-=te;for(var m=Io(h,n);++a<e;)n(a);return m}function tm(e){return Re(e)?mt(e,Xr):br(e)?[e]:fr(Qh(nt(e)))}function rm(e){var n=++dg;return nt(e)+n}var nm=la(function(e,n){return e+n},0),im=Jo("ceil"),sm=la(function(e,n){return e/n},1),am=Jo("floor");function om(e){return e&&e.length?ia(e,gr,jo):r}function cm(e,n){return e&&e.length?ia(e,we(n,2),jo):r}function um(e){return Mu(e,gr)}function hm(e,n){return Mu(e,we(n,2))}function lm(e){return e&&e.length?ia(e,gr,Mo):r}function fm(e,n){return e&&e.length?ia(e,we(n,2),Mo):r}var dm=la(function(e,n){return e*n},1),pm=Jo("round"),gm=la(function(e,n){return e-n},0);function _m(e){return e&&e.length?So(e,gr):0}function ym(e,n){return e&&e.length?So(e,we(n,2)):0}return I.after=My,I.ary=hl,I.assign=P1,I.assignIn=Il,I.assignInWith=Ia,I.assignWith=x1,I.at=T1,I.before=ll,I.bind=cc,I.bindAll=Uv,I.bindKey=fl,I.castArray=Xy,I.chain=ol,I.chunk=a_,I.compact=o_,I.concat=c_,I.cond=Dv,I.conforms=jv,I.constant=gc,I.countBy=_y,I.create=A1,I.curry=dl,I.curryRight=pl,I.debounce=gl,I.defaults=C1,I.defaultsDeep=N1,I.defer=qy,I.delay=Hy,I.difference=u_,I.differenceBy=h_,I.differenceWith=l_,I.drop=f_,I.dropRight=d_,I.dropRightWhile=p_,I.dropWhile=g_,I.fill=__,I.filter=vy,I.flatMap=wy,I.flatMapDeep=Ey,I.flatMapDepth=Sy,I.flatten=nl,I.flattenDeep=y_,I.flattenDepth=v_,I.flip=zy,I.flow=Fv,I.flowRight=Lv,I.fromPairs=m_,I.functions=L1,I.functionsIn=M1,I.groupBy=Iy,I.initial=w_,I.intersection=E_,I.intersectionBy=S_,I.intersectionWith=I_,I.invert=H1,I.invertBy=z1,I.invokeMap=Py,I.iteratee=_c,I.keyBy=xy,I.keys=Wt,I.keysIn=pr,I.map=va,I.mapKeys=K1,I.mapValues=V1,I.matches=Mv,I.matchesProperty=qv,I.memoize=ba,I.merge=G1,I.mergeWith=Ol,I.method=Hv,I.methodOf=zv,I.mixin=yc,I.negate=wa,I.nthArg=Kv,I.omit=k1,I.omitBy=W1,I.once=By,I.orderBy=Ty,I.over=Vv,I.overArgs=Ky,I.overEvery=Gv,I.overSome=kv,I.partial=uc,I.partialRight=_l,I.partition=Ay,I.pick=Y1,I.pickBy=Pl,I.property=Ul,I.propertyOf=Wv,I.pull=T_,I.pullAll=sl,I.pullAllBy=A_,I.pullAllWith=C_,I.pullAt=N_,I.range=Yv,I.rangeRight=Jv,I.rearg=Vy,I.reject=Ry,I.remove=R_,I.rest=Gy,I.reverse=ac,I.sampleSize=Dy,I.set=X1,I.setWith=Z1,I.shuffle=jy,I.slice=U_,I.sortBy=Ly,I.sortedUniq=q_,I.sortedUniqBy=H_,I.split=wv,I.spread=ky,I.tail=z_,I.take=B_,I.takeRight=K_,I.takeRightWhile=V_,I.takeWhile=G_,I.tap=oy,I.throttle=Wy,I.thru=ya,I.toArray=wl,I.toPairs=xl,I.toPairsIn=Tl,I.toPath=tm,I.toPlainObject=Sl,I.transform=Q1,I.unary=Yy,I.union=k_,I.unionBy=W_,I.unionWith=Y_,I.uniq=J_,I.uniqBy=X_,I.uniqWith=Z_,I.unset=ev,I.unzip=oc,I.unzipWith=al,I.update=tv,I.updateWith=rv,I.values=Ii,I.valuesIn=nv,I.without=Q_,I.words=Nl,I.wrap=Jy,I.xor=ey,I.xorBy=ty,I.xorWith=ry,I.zip=ny,I.zipObject=iy,I.zipObjectDeep=sy,I.zipWith=ay,I.entries=xl,I.entriesIn=Tl,I.extend=Il,I.extendWith=Ia,yc(I,I),I.add=nm,I.attempt=Rl,I.camelCase=ov,I.capitalize=Al,I.ceil=im,I.clamp=iv,I.clone=Zy,I.cloneDeep=e1,I.cloneDeepWith=t1,I.cloneWith=Qy,I.conformsTo=r1,I.deburr=Cl,I.defaultTo=$v,I.divide=sm,I.endsWith=cv,I.eq=zr,I.escape=uv,I.escapeRegExp=hv,I.every=yy,I.find=my,I.findIndex=tl,I.findKey=R1,I.findLast=by,I.findLastIndex=rl,I.findLastKey=U1,I.floor=am,I.forEach=cl,I.forEachRight=ul,I.forIn=D1,I.forInRight=j1,I.forOwn=$1,I.forOwnRight=F1,I.get=fc,I.gt=n1,I.gte=i1,I.has=q1,I.hasIn=dc,I.head=il,I.identity=gr,I.includes=Oy,I.indexOf=b_,I.inRange=sv,I.invoke=B1,I.isArguments=kn,I.isArray=Re,I.isArrayBuffer=s1,I.isArrayLike=dr,I.isArrayLikeObject=Ut,I.isBoolean=a1,I.isBuffer=Tn,I.isDate=o1,I.isElement=c1,I.isEmpty=u1,I.isEqual=h1,I.isEqualWith=l1,I.isError=hc,I.isFinite=f1,I.isFunction=fn,I.isInteger=yl,I.isLength=Ea,I.isMap=vl,I.isMatch=d1,I.isMatchWith=p1,I.isNaN=g1,I.isNative=_1,I.isNil=v1,I.isNull=y1,I.isNumber=ml,I.isObject=wt,I.isObjectLike=At,I.isPlainObject=es,I.isRegExp=lc,I.isSafeInteger=m1,I.isSet=bl,I.isString=Sa,I.isSymbol=br,I.isTypedArray=Si,I.isUndefined=b1,I.isWeakMap=w1,I.isWeakSet=E1,I.join=O_,I.kebabCase=lv,I.last=Nr,I.lastIndexOf=P_,I.lowerCase=fv,I.lowerFirst=dv,I.lt=S1,I.lte=I1,I.max=om,I.maxBy=cm,I.mean=um,I.meanBy=hm,I.min=lm,I.minBy=fm,I.stubArray=mc,I.stubFalse=bc,I.stubObject=Xv,I.stubString=Zv,I.stubTrue=Qv,I.multiply=dm,I.nth=x_,I.noConflict=Bv,I.noop=vc,I.now=ma,I.pad=pv,I.padEnd=gv,I.padStart=_v,I.parseInt=yv,I.random=av,I.reduce=Cy,I.reduceRight=Ny,I.repeat=vv,I.replace=mv,I.result=J1,I.round=pm,I.runInContext=G,I.sample=Uy,I.size=$y,I.snakeCase=bv,I.some=Fy,I.sortedIndex=D_,I.sortedIndexBy=j_,I.sortedIndexOf=$_,I.sortedLastIndex=F_,I.sortedLastIndexBy=L_,I.sortedLastIndexOf=M_,I.startCase=Ev,I.startsWith=Sv,I.subtract=gm,I.sum=_m,I.sumBy=ym,I.template=Iv,I.times=em,I.toFinite=dn,I.toInteger=Le,I.toLength=El,I.toLower=Ov,I.toNumber=Rr,I.toSafeInteger=O1,I.toString=nt,I.toUpper=Pv,I.trim=xv,I.trimEnd=Tv,I.trimStart=Av,I.truncate=Cv,I.unescape=Nv,I.uniqueId=rm,I.upperCase=Rv,I.upperFirst=pc,I.each=cl,I.eachRight=ul,I.first=il,yc(I,function(){var e={};return Yr(I,function(n,a){it.call(I.prototype,a)||(e[a]=n)}),e}(),{chain:!1}),I.VERSION=s,Pr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){I[e].placeholder=I}),Pr(["drop","take"],function(e,n){Ye.prototype[e]=function(a){a=a===r?1:Gt(Le(a),0);var h=this.__filtered__&&!n?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=Zt(a,h.__takeCount__):h.__views__.push({size:Zt(a,te),type:e+(h.__dir__<0?"Right":"")}),h},Ye.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),Pr(["filter","map","takeWhile"],function(e,n){var a=n+1,h=a==y||a==D;Ye.prototype[e]=function(m){var P=this.clone();return P.__iteratees__.push({iteratee:we(m,3),type:a}),P.__filtered__=P.__filtered__||h,P}}),Pr(["head","last"],function(e,n){var a="take"+(n?"Right":"");Ye.prototype[e]=function(){return this[a](1).value()[0]}}),Pr(["initial","tail"],function(e,n){var a="drop"+(n?"":"Right");Ye.prototype[e]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(gr)},Ye.prototype.find=function(e){return this.filter(e).head()},Ye.prototype.findLast=function(e){return this.reverse().find(e)},Ye.prototype.invokeMap=Ke(function(e,n){return typeof e=="function"?new Ye(this):this.map(function(a){return Wi(a,e,n)})}),Ye.prototype.reject=function(e){return this.filter(wa(we(e)))},Ye.prototype.slice=function(e,n){e=Le(e);var a=this;return a.__filtered__&&(e>0||n<0)?new Ye(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),n!==r&&(n=Le(n),a=n<0?a.dropRight(-n):a.take(n-e)),a)},Ye.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ye.prototype.toArray=function(){return this.take(te)},Yr(Ye.prototype,function(e,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),h=/^(?:head|last)$/.test(n),m=I[h?"take"+(n=="last"?"Right":""):n],P=h||/^find/.test(n);m&&(I.prototype[n]=function(){var j=this.__wrapped__,M=h?[1]:arguments,k=j instanceof Ye,se=M[0],ae=k||Re(j),ue=function(ke){var Ze=m.apply(I,wn([ke],M));return h&&fe?Ze[0]:Ze};ae&&a&&typeof se=="function"&&se.length!=1&&(k=ae=!1);var fe=this.__chain__,ve=!!this.__actions__.length,Ee=P&&!fe,He=k&&!ve;if(!P&&ae){j=He?j:new Ye(this);var Se=e.apply(j,M);return Se.__actions__.push({func:ya,args:[ue],thisArg:r}),new Tr(Se,fe)}return Ee&&He?e.apply(this,M):(Se=this.thru(ue),Ee?h?Se.value()[0]:Se.value():Se)})}),Pr(["pop","push","shift","sort","splice","unshift"],function(e){var n=Bs[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",h=/^(?:pop|shift)$/.test(e);I.prototype[e]=function(){var m=arguments;if(h&&!this.__chain__){var P=this.value();return n.apply(Re(P)?P:[],m)}return this[a](function(j){return n.apply(Re(j)?j:[],m)})}}),Yr(Ye.prototype,function(e,n){var a=I[n];if(a){var h=a.name+"";it.call(vi,h)||(vi[h]=[]),vi[h].push({name:n,func:a})}}),vi[ha(r,ce).name]=[{name:"wrapper",func:r}],Ye.prototype.clone=Ng,Ye.prototype.reverse=Rg,Ye.prototype.value=Ug,I.prototype.at=cy,I.prototype.chain=uy,I.prototype.commit=hy,I.prototype.next=ly,I.prototype.plant=dy,I.prototype.reverse=py,I.prototype.toJSON=I.prototype.valueOf=I.prototype.value=gy,I.prototype.first=I.prototype.head,Hi&&(I.prototype[Hi]=fy),I},gi=hg();Rt?((Rt.exports=gi)._=gi,ct._=gi):Xe._=gi}).call(fs)})(nu,nu.exports);var f3=Object.defineProperty,d3=Object.defineProperties,p3=Object.getOwnPropertyDescriptors,ad=Object.getOwnPropertySymbols,g3=Object.prototype.hasOwnProperty,_3=Object.prototype.propertyIsEnumerable,od=(i,t,r)=>t in i?f3(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,Pa=(i,t)=>{for(var r in t||(t={}))g3.call(t,r)&&od(i,r,t[r]);if(ad)for(var r of ad(t))_3.call(t,r)&&od(i,r,t[r]);return i},y3=(i,t)=>d3(i,p3(t));function $r(i,t,r){let s;const o=iu(i);return t.rpcMap&&(s=t.rpcMap[o]),s||(s=`${l3}?chainId=eip155:${o}&projectId=${r}`),s}function iu(i){return i.includes("eip155")?Number(i.split(":")[1]):Number(i)}function v3(i){return i.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function m3(i,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(i));if(!r.length)return[];const s=[];return r.forEach(o=>{const g=t.namespaces[o].accounts;s.push(...g)}),s}function b3(i,t={}){const r=cd(i),s=cd(t);return nu.exports.merge(r,s)}function cd(i){var t,r,s,o;const g={};if(!Ai(i))return g;for(const[w,v]of Object.entries(i)){const S=vp(w)?[w]:v.chains,U=v.methods||[],R=v.events||[],F=v.rpcMap||{},K=Aa(w);g[K]=y3(Pa(Pa({},g[K]),v),{chains:Uc(S,(t=g[K])==null?void 0:t.chains),methods:Uc(U,(r=g[K])==null?void 0:r.methods),events:Uc(R,(s=g[K])==null?void 0:s.events),rpcMap:Pa(Pa({},F),(o=g[K])==null?void 0:o.rpcMap)})}return g}const qp={},jt=i=>qp[i],qc=(i,t)=>{qp[i]=t};class w3{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=jt("events"),this.client=jt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||$r(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Un.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||$r(t,this.namespace);return typeof s>"u"?void 0:new Rn(new ii(s,jt("disableProviderPing")))}}class E3{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=jt("events"),this.client=jt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){const s=iu(t);if(!this.httpProviders[s]){const o=r||$r(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(Un.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||$r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Rn(new ii(s,jt("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=iu(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r;let s=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const o=parseInt(s,16);if(this.isChainApproved(o))this.setDefaultChain(`${o}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:s}]},chainId:t.chainId}),this.setDefaultChain(`${o}`);else throw new Error(`Failed to switch to chain 'eip155:${o}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class S3{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=jt("events"),this.client=jt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||$r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Un.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||$r(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Rn(new ii(s,jt("disableProviderPing")))}}class I3{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=jt("events"),this.client=jt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||$r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Un.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||$r(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Rn(new ii(s,jt("disableProviderPing")))}}class O3{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=jt("events"),this.client=jt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Un.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);t[r]=this.createHttpProvider(r,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);return typeof s>"u"?void 0:new Rn(new ii(s,jt("disableProviderPing")))}}class P3{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=jt("events"),this.client=jt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||$r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Un.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||$r(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Rn(new ii(s,jt("disableProviderPing")))}}class x3{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=jt("events"),this.client=jt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||$r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Un.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||$r(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Rn(new ii(s,jt("disableProviderPing")))}}var T3=Object.defineProperty,A3=Object.defineProperties,C3=Object.getOwnPropertyDescriptors,ud=Object.getOwnPropertySymbols,N3=Object.prototype.hasOwnProperty,R3=Object.prototype.propertyIsEnumerable,hd=(i,t,r)=>t in i?T3(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,xa=(i,t)=>{for(var r in t||(t={}))N3.call(t,r)&&hd(i,r,t[r]);if(ud)for(var r of ud(t))R3.call(t,r)&&hd(i,r,t[r]);return i},Hc=(i,t)=>A3(i,C3(t));class Du{constructor(t){this.events=new cu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||id})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Du(t);return await r.initialize(),r}async request(t,r){const[s,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:xa({},t),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(o=>r(null,o)).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Kt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(g=>{this.session=g}).catch(g=>{if(g.message!==Mp)throw g;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{const[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(ji(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Uu.init({logger:this.providerOpts.logger||id,relayUrl:this.providerOpts.relayUrl||c3,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Aa(r)))];qc("client",this.client),qc("events",this.events),qc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=m3(r,this.session),o=v3(s),g=b3(this.namespaces,this.optionalNamespaces),w=Hc(xa({},g[r]),{accounts:s,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new E3({namespace:w});break;case"solana":this.rpcProviders[r]=new S3({namespace:w});break;case"cosmos":this.rpcProviders[r]=new I3({namespace:w});break;case"polkadot":this.rpcProviders[r]=new w3({namespace:w});break;case"cip34":this.rpcProviders[r]=new O3({namespace:w});break;case"elrond":this.rpcProviders[r]=new P3({namespace:w});break;case"multiversx":this.rpcProviders[r]=new x3({namespace:w});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?this.events.emit("accountsChanged",s.data):s.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:o}=r,g=(s=this.client)==null?void 0:s.session.get(t);this.session=Hc(xa({},g),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Hc(xa({},Kt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Un.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:o}=t;if(!r||!Object.keys(r).length)throw new Error("Namespaces must be not empty");this.namespaces=r,this.optionalNamespaces=s,this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(r&&!Object.keys(this.namespaces).map(w=>Aa(w)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const o=Aa(Object.keys(this.namespaces)[0]),g=this.rpcProviders[o].getDefaultChain();return[o,g]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;const[o,g]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(g),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${g}`]).defaultChain=g,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",g)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${sd}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${sd}/${t}`)}}const U3=Du,D3="wc",j3="ethereum_provider",$3=`${D3}@2:${j3}:`,F3="https://rpc.walletconnect.com/v1/",su=["eth_sendTransaction","personal_sign"],Z3=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],au=["chainChanged","accountsChanged"],Q3=["message","disconnect","connect"];var L3=Object.defineProperty,M3=Object.defineProperties,q3=Object.getOwnPropertyDescriptors,ld=Object.getOwnPropertySymbols,H3=Object.prototype.hasOwnProperty,z3=Object.prototype.propertyIsEnumerable,fd=(i,t,r)=>t in i?L3(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,zc=(i,t)=>{for(var r in t||(t={}))H3.call(t,r)&&fd(i,r,t[r]);if(ld)for(var r of ld(t))z3.call(t,r)&&fd(i,r,t[r]);return i},dd=(i,t)=>M3(i,q3(t));function ou(i){return Number(i[0].split(":")[1])}function Bc(i){return`0x${i.toString(16)}`}function B3(i){const{chains:t,optionalChains:r,methods:s,optionalMethods:o,events:g,optionalEvents:w,rpcMap:v}=i;if(!Jc(t))throw new Error("Invalid chains");const S=t,U=s||su,R=g||au,F={[ou(S)]:v[ou(S)]},K={chains:S,methods:U,events:R,rpcMap:F},q=g==null?void 0:g.filter(ce=>!au.includes(ce)),H=s==null?void 0:s.filter(ce=>!su.includes(ce));if(!r&&!w&&!o&&!(q!=null&&q.length)&&!(H!=null&&H.length))return{required:K};const Q=(q==null?void 0:q.length)&&(H==null?void 0:H.length)||!r,J={chains:[...new Set(Q?S.concat(r||[]):r)],methods:[...new Set(U.concat(o||[]))],events:[...new Set(R.concat(w||[]))],rpcMap:v};return{required:K,optional:J}}class ju{constructor(){this.events=new Fr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=$3,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new ju;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=B3(this.rpc);try{const o=await new Promise(async(w,v)=>{var S;this.rpc.showQrModal&&((S=this.modal)==null||S.subscribeModal(U=>{!U.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),v(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(dd(zc({namespaces:{[this.namespace]:r}},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(U=>{w(U)}).catch(U=>{v(new Error(U.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const g=qw(o.namespaces,[this.namespace]);this.setAccounts(g),this.events.emit("connect",{chainId:Bc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Bc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",dd(zc({},zw("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Bc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,o]=t.split(":");return{chainId:`${r}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;return{chains:((r=t.chains)==null?void 0:r.map(o=>this.formatChainId(o)))||[`${this.namespace}:1`],optionalChains:t.optionalChains?t.optionalChains.map(o=>this.formatChainId(o)):void 0,methods:(t==null?void 0:t.methods)||su,events:(t==null?void 0:t.events)||au,optionalMethods:(t==null?void 0:t.optionalMethods)||[],optionalEvents:(t==null?void 0:t.optionalEvents)||[],rpcMap:(t==null?void 0:t.rpcMap)||this.buildRpcMap(t.chains.concat(t.optionalChains||[]),t.projectId),showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:(s=t==null?void 0:t.qrModalOptions)!=null?s:void 0,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=ou(this.rpc.chains),this.signer=await U3.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await Em(()=>import("./index-bace7801.js").then(o=>o.a),["assets/index-bace7801.js","assets/index-b371a77d.js","assets/index-1058cf5c.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(zc({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:o}=t;r&&Jc(r)&&(this.rpc.chains=r.map(g=>this.formatChainId(g)),r.forEach(g=>{this.rpc.rpcMap[g]=(o==null?void 0:o[g])||this.getRpcUrl(g)})),s&&Jc(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(g=>this.formatChainId(g)),s.forEach(g=>{this.rpc.rpcMap[g]=(o==null?void 0:o[g])||this.getRpcUrl(g)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${F3}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const e5=ju;export{e5 as EthereumProvider,Q3 as OPTIONAL_EVENTS,Z3 as OPTIONAL_METHODS,au as REQUIRED_EVENTS,su as REQUIRED_METHODS,ju as default};
